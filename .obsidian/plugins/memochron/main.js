/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ns=Object.create;var Zt=Object.defineProperty;var is=Object.getOwnPropertyDescriptor;var ss=Object.getOwnPropertyNames;var as=Object.getPrototypeOf,os=Object.prototype.hasOwnProperty;var pn=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),ls=(i,e)=>{for(var t in e)Zt(i,t,{get:e[t],enumerable:!0})},gn=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ss(e))!os.call(i,n)&&n!==t&&Zt(i,n,{get:()=>e[n],enumerable:!(r=is(e,n))||r.enumerable});return i};var hr=(i,e,t)=>(t=i!=null?ns(as(i)):{},gn(e||!i||!i.__esModule?Zt(t,"default",{value:i,enumerable:!0}):t,i)),us=i=>gn(Zt({},"__esModule",{value:!0}),i);var mr=pn((uo,fr)=>{var u;(function(){typeof fr=="object"?u=fr.exports:typeof HTMLScriptElement!="undefined"&&"noModule"in HTMLScriptElement.prototype?window.ICAL=u={}:typeof u!="object"&&(u={})})();u.foldLength=75;u.newLineChar=`\r
`;u.helpers={updateTimezones:function(i){var e,t,r,n,s,a;if(!i||i.name!=="vcalendar")return i;for(e=i.getAllSubcomponents(),t=[],r={},s=0;s<e.length;s++)e[s].name==="vtimezone"?(a=e[s].getFirstProperty("tzid").getFirstValue(),r[a]=e[s]):t=t.concat(e[s].getAllProperties());for(n={},s=0;s<t.length;s++)(a=t[s].getParameter("tzid"))&&(n[a]=!0);for(s in r)r.hasOwnProperty(s)&&!n[s]&&i.removeSubcomponent(r[s]);for(s in n)n.hasOwnProperty(s)&&!r[s]&&u.TimezoneService.has(s)&&i.addSubcomponent(u.TimezoneService.get(s).component);return i},isStrictlyNaN:function(i){return typeof i=="number"&&isNaN(i)},strictParseInt:function(i){var e=parseInt(i,10);if(u.helpers.isStrictlyNaN(e))throw new Error('Could not extract integer from "'+i+'"');return e},formatClassType:function(e,t){if(typeof e!="undefined")return e instanceof t?e:new t(e)},unescapedIndexOf:function(i,e,t){for(;(t=i.indexOf(e,t))!==-1;)if(t>0&&i[t-1]==="\\")t+=1;else return t;return-1},binsearchInsert:function(i,e,t){if(!i.length)return 0;for(var r=0,n=i.length-1,s,a;r<=n;)if(s=r+Math.floor((n-r)/2),a=t(e,i[s]),a<0)n=s-1;else if(a>0)r=s+1;else break;return a<0?s:a>0?s+1:s},dumpn:function(){u.debug&&(typeof console!="undefined"&&"log"in console?u.helpers.dumpn=function(e){console.log(e)}:u.helpers.dumpn=function(e){dump(e+`
`)},u.helpers.dumpn(arguments[0]))},clone:function(i,e){if(!i||typeof i!="object")return i;if(i instanceof Date)return new Date(i.getTime());if("clone"in i)return i.clone();if(Array.isArray(i)){for(var t=[],r=0;r<i.length;r++)t.push(e?u.helpers.clone(i[r],!0):i[r]);return t}else{var n={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e?n[s]=u.helpers.clone(i[s],!0):n[s]=i[s]);return n}},foldline:function(e){for(var t="",r=e||"",n=0,s=0;r.length;){var a=r.codePointAt(n);a<128?++s:a<2048?s+=2:a<65536?s+=3:s+=4,s<u.foldLength+1?n+=a>65535?2:1:(t+=u.newLineChar+" "+r.substring(0,n),r=r.substring(n),n=s=0)}return t.substr(u.newLineChar.length+1)},pad2:function(e){typeof e!="string"&&(typeof e=="number"&&(e=parseInt(e)),e=String(e));var t=e.length;switch(t){case 0:return"00";case 1:return"0"+e;default:return e}},trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)},inherits:function(i,e,t){function r(){}r.prototype=i.prototype,e.prototype=new r,t&&u.helpers.extend(t,e.prototype)},extend:function(i,e){for(var t in i){var r=Object.getOwnPropertyDescriptor(i,t);r&&!Object.getOwnPropertyDescriptor(e,t)&&Object.defineProperty(e,t,r)}return e}};u.design=function(){"use strict";var i=/\\\\|\\;|\\,|\\[Nn]/g,e=/\\|;|,|\n/g,t=/\\\\|\\,|\\[Nn]/g,r=/\\|,|\n/g;function n(m,w){var k={matches:/.*/,fromICAL:function(_,ve){return T(_,m,ve)},toICAL:function(_,ve){var ee=w;return ve&&(ee=new RegExp(ee.source+"|"+ve)),_.replace(ee,function(Ee){switch(Ee){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case`
`:return"\\n";default:return Ee}})}};return k}var s={defaultType:"text"},a={defaultType:"text",multiValue:","},o={defaultType:"text",structuredValue:";"},l={defaultType:"integer"},c={defaultType:"date-time",allowedTypes:["date-time","date"]},d={defaultType:"date-time"},h={defaultType:"uri"},f={defaultType:"utc-offset"},p={defaultType:"recur"},y={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function g(m){switch(m){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return`
`;default:return m}}function T(m,w,k){return m.indexOf("\\")===-1?m:(k&&(w=new RegExp(w.source+"|\\\\"+k)),m.replace(w,g))}var v={categories:a,url:h,version:s,uid:s},D={boolean:{values:["TRUE","FALSE"],fromICAL:function(m){switch(m){case"TRUE":return!0;case"FALSE":return!1;default:return!1}},toICAL:function(m){return m?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(m){var w=parseFloat(m);return u.helpers.isStrictlyNaN(w)?0:w},toICAL:function(m){return String(m)}},integer:{fromICAL:function(m){var w=parseInt(m);return u.helpers.isStrictlyNaN(w)?0:w},toICAL:function(m){return String(m)}},"utc-offset":{toICAL:function(m){return m.length<7?m.substr(0,3)+m.substr(4,2):m.substr(0,3)+m.substr(4,2)+m.substr(7,2)},fromICAL:function(m){return m.length<6?m.substr(0,3)+":"+m.substr(3,2):m.substr(0,3)+":"+m.substr(3,2)+":"+m.substr(5,2)},decorate:function(m){return u.UtcOffset.fromString(m)},undecorate:function(m){return m.toString()}}},O={cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}},S=u.helpers.extend(D,{text:n(i,e),uri:{},binary:{decorate:function(m){return u.Binary.fromString(m)},undecorate:function(m){return m.toString()}},"cal-address":{},date:{decorate:function(m,w){return K.strict?u.Time.fromDateString(m,w):u.Time.fromString(m,w)},undecorate:function(m){return m.toString()},fromICAL:function(m){return!K.strict&&m.length>=15?S["date-time"].fromICAL(m):m.substr(0,4)+"-"+m.substr(4,2)+"-"+m.substr(6,2)},toICAL:function(m){var w=m.length;return w==10?m.substr(0,4)+m.substr(5,2)+m.substr(8,2):w>=19?S["date-time"].toICAL(m):m}},"date-time":{fromICAL:function(m){if(!K.strict&&m.length==8)return S.date.fromICAL(m);var w=m.substr(0,4)+"-"+m.substr(4,2)+"-"+m.substr(6,2)+"T"+m.substr(9,2)+":"+m.substr(11,2)+":"+m.substr(13,2);return m[15]&&m[15]==="Z"&&(w+="Z"),w},toICAL:function(m){var w=m.length;if(w==10&&!K.strict)return S.date.toICAL(m);if(w>=19){var k=m.substr(0,4)+m.substr(5,2)+m.substr(8,5)+m.substr(14,2)+m.substr(17,2);return m[19]&&m[19]==="Z"&&(k+="Z"),k}else return m},decorate:function(m,w){return K.strict?u.Time.fromDateTimeString(m,w):u.Time.fromString(m,w)},undecorate:function(m){return m.toString()}},duration:{decorate:function(m){return u.Duration.fromString(m)},undecorate:function(m){return m.toString()}},period:{fromICAL:function(m){var w=m.split("/");return w[0]=S["date-time"].fromICAL(w[0]),u.Duration.isValueString(w[1])||(w[1]=S["date-time"].fromICAL(w[1])),w},toICAL:function(m){return!K.strict&&m[0].length==10?m[0]=S.date.toICAL(m[0]):m[0]=S["date-time"].toICAL(m[0]),u.Duration.isValueString(m[1])||(!K.strict&&m[1].length==10?m[1]=S.date.toICAL(m[1]):m[1]=S["date-time"].toICAL(m[1])),m.join("/")},decorate:function(m,w){return u.Period.fromJSON(m,w,!K.strict)},undecorate:function(m){return m.toJSON()}},recur:{fromICAL:function(m){return u.Recur._stringToData(m,!0)},toICAL:function(m){var w="";for(var k in m)if(Object.prototype.hasOwnProperty.call(m,k)){var _=m[k];k=="until"?_.length>10?_=S["date-time"].toICAL(_):_=S.date.toICAL(_):k=="wkst"?typeof _=="number"&&(_=u.Recur.numericDayToIcalDay(_)):Array.isArray(_)&&(_=_.join(",")),w+=k.toUpperCase()+"="+_+";"}return w.substr(0,w.length-1)},decorate:function(w){return u.Recur.fromData(w)},undecorate:function(m){return m.toJSON()}},time:{fromICAL:function(m){if(m.length<6)return m;var w=m.substr(0,2)+":"+m.substr(2,2)+":"+m.substr(4,2);return m[6]==="Z"&&(w+="Z"),w},toICAL:function(m){if(m.length<8)return m;var w=m.substr(0,2)+m.substr(3,2)+m.substr(6,2);return m[8]==="Z"&&(w+="Z"),w}}}),b=u.helpers.extend(v,{action:s,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:s,class:s,comment:s,completed:d,contact:s,created:d,description:s,dtend:c,dtstamp:d,dtstart:c,due:c,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:p,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":d,location:s,method:s,organizer:{defaultType:"cal-address"},"percent-complete":l,priority:l,prodid:s,"related-to":s,repeat:l,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(m){return m.indexOf("/")!==-1?"period":m.indexOf("T")===-1?"date":"date-time"}},"recurrence-id":c,resources:a,"request-status":o,rrule:p,sequence:l,status:s,summary:s,transp:s,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:f,tzoffsetto:f,tzurl:h,tzid:s,tzname:s}),N=u.helpers.extend(D,{text:n(t,r),uri:n(t,r),date:{decorate:function(m){return u.VCardTime.fromDateAndOrTimeString(m,"date")},undecorate:function(m){return m.toString()},fromICAL:function(m){return m.length==8?S.date.fromICAL(m):m[0]=="-"&&m.length==6?m.substr(0,4)+"-"+m.substr(4):m},toICAL:function(m){return m.length==10?S.date.toICAL(m):m[0]=="-"&&m.length==7?m.substr(0,4)+m.substr(5):m}},time:{decorate:function(m){return u.VCardTime.fromDateAndOrTimeString("T"+m,"time")},undecorate:function(m){return m.toString()},fromICAL:function(m){var w=N.time._splitZone(m,!0),k=w[0],_=w[1];return _.length==6?_=_.substr(0,2)+":"+_.substr(2,2)+":"+_.substr(4,2):_.length==4&&_[0]!="-"?_=_.substr(0,2)+":"+_.substr(2,2):_.length==5&&(_=_.substr(0,3)+":"+_.substr(3,2)),k.length==5&&(k[0]=="-"||k[0]=="+")&&(k=k.substr(0,3)+":"+k.substr(3)),_+k},toICAL:function(m){var w=N.time._splitZone(m),k=w[0],_=w[1];return _.length==8?_=_.substr(0,2)+_.substr(3,2)+_.substr(6,2):_.length==5&&_[0]!="-"?_=_.substr(0,2)+_.substr(3,2):_.length==6&&(_=_.substr(0,3)+_.substr(4,2)),k.length==6&&(k[0]=="-"||k[0]=="+")&&(k=k.substr(0,3)+k.substr(4)),_+k},_splitZone:function(m,w){var k=m.length-1,_=m.length-(w?5:6),ve=m[_],ee,Ee;return m[k]=="Z"?(ee=m[k],Ee=m.substr(0,k)):m.length>6&&(ve=="-"||ve=="+")?(ee=m.substr(_),Ee=m.substr(0,_)):(ee="",Ee=m),[ee,Ee]}},"date-time":{decorate:function(m){return u.VCardTime.fromDateAndOrTimeString(m,"date-time")},undecorate:function(m){return m.toString()},fromICAL:function(m){return N["date-and-or-time"].fromICAL(m)},toICAL:function(m){return N["date-and-or-time"].toICAL(m)}},"date-and-or-time":{decorate:function(m){return u.VCardTime.fromDateAndOrTimeString(m,"date-and-or-time")},undecorate:function(m){return m.toString()},fromICAL:function(m){var w=m.split("T");return(w[0]?N.date.fromICAL(w[0]):"")+(w[1]?"T"+N.time.fromICAL(w[1]):"")},toICAL:function(m){var w=m.split("T");return N.date.toICAL(w[0])+(w[1]?"T"+N.time.toICAL(w[1]):"")}},timestamp:S["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/}}),F={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},Z=u.helpers.extend(v,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:y,bday:y,caladruri:h,caluri:h,clientpidmap:o,email:s,fburl:h,fn:s,gender:o,geo:h,impp:h,key:h,kind:s,lang:{defaultType:"language-tag"},logo:h,member:h,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:a,note:s,org:{defaultType:"text",structuredValue:";"},photo:h,related:h,rev:{defaultType:"timestamp"},role:s,sound:h,source:h,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:s,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:s}),j=u.helpers.extend(D,{binary:S.binary,date:N.date,"date-time":N["date-time"],"phone-number":{},uri:S.uri,text:S.text,time:S.time,vcard:S.text,"utc-offset":{toICAL:function(m){return m.substr(0,7)},fromICAL:function(m){return m.substr(0,7)},decorate:function(m){return u.UtcOffset.fromString(m)},undecorate:function(m){return m.toString()}}}),z={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},X=u.helpers.extend(v,{fn:s,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:a,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(m){return m.indexOf("T")===-1?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:s,tel:{defaultType:"phone-number"},email:s,mailer:s,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:s,role:s,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:o,note:a,prodid:s,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(m){return m.indexOf("T")===-1?"date":"date-time"}},"sort-string":s,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:s,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),J={value:S,param:O,property:b},ne={value:N,param:F,property:Z},B={value:j,param:z,property:X},K={strict:!0,defaultSet:J,defaultType:"unknown",components:{vcard:ne,vcard3:B,vevent:J,vtodo:J,vjournal:J,valarm:J,vtimezone:J,daylight:J,standard:J},icalendar:J,vcard:ne,vcard3:B,getDesignSet:function(m){var w=m&&m in K.components;return w?K.components[m]:K.defaultSet}};return K}();u.stringify=function(){"use strict";var i=`\r
`,e="unknown",t=u.design,r=u.helpers;function n(a){typeof a[0]=="string"&&(a=[a]);for(var o=0,l=a.length,c="";o<l;o++)c+=n.component(a[o])+i;return c}n.component=function(a,o){var l=a[0].toUpperCase(),c="BEGIN:"+l+i,d=a[1],h=0,f=d.length,p=a[0];for(p==="vcard"&&a[1].length>0&&!(a[1][0][0]==="version"&&a[1][0][3]==="4.0")&&(p="vcard3"),o=o||t.getDesignSet(p);h<f;h++)c+=n.property(d[h],o)+i;for(var y=a[2]||[],g=0,T=y.length;g<T;g++)c+=n.component(y[g],o)+i;return c+="END:"+l,c},n.property=function(a,o,l){var c=a[0].toUpperCase(),d=a[0],h=a[1],f=c,p;for(p in h){var y=h[p];if(h.hasOwnProperty(p)){var v=p in o.param&&o.param[p].multiValue;v&&Array.isArray(y)?(o.param[p].multiValueSeparateDQuote&&(v='"'+v+'"'),y=y.map(n._rfc6868Unescape),y=n.multiValue(y,v,"unknown",null,o)):y=n._rfc6868Unescape(y),f+=";"+p.toUpperCase(),f+="="+n.propertyValue(y)}}if(a.length===3)return f+":";var g=a[2];o||(o=t.defaultSet);var T,v=!1,D=!1,O=!1;return d in o.property?(T=o.property[d],"multiValue"in T&&(v=T.multiValue),"structuredValue"in T&&Array.isArray(a[3])&&(D=T.structuredValue),"defaultType"in T?g===T.defaultType&&(O=!0):g===e&&(O=!0)):g===e&&(O=!0),O||(f+=";VALUE="+g.toUpperCase()),f+=":",v&&D?f+=n.multiValue(a[3],D,g,v,o,D):v?f+=n.multiValue(a.slice(3),v,g,null,o,!1):D?f+=n.multiValue(a[3],D,g,null,o,D):f+=n.value(a[3],g,o,!1),l?f:u.helpers.foldline(f)},n.propertyValue=function(a){return r.unescapedIndexOf(a,",")===-1&&r.unescapedIndexOf(a,":")===-1&&r.unescapedIndexOf(a,";")===-1?a:'"'+a+'"'},n.multiValue=function(a,o,l,c,d,h){for(var f="",p=a.length,y=0;y<p;y++)c&&Array.isArray(a[y])?f+=n.multiValue(a[y],c,l,null,d,h):f+=n.value(a[y],l,d,h),y!==p-1&&(f+=o);return f},n.value=function(a,o,l,c){return o in l.value&&"toICAL"in l.value[o]?l.value[o].toICAL(a,c):a},n._rfc6868Unescape=function(a){return a.replace(/[\n^"]/g,function(o){return s[o]})};var s={'"':"^'","\n":"^n","^":"^^"};return n}();u.parse=function(){"use strict";var i=/[^ \t]/,e=",",t=":",r=";",n="=",s="unknown",a="text",o=u.design,l=u.helpers;function c(f){this.message=f,this.name="ParserError";try{throw new Error}catch(y){if(y.stack){var p=y.stack.split(`
`);p.shift(),this.stack=p.join(`
`)}}}c.prototype=Error.prototype;function d(f){var p={},y=p.component=[];if(p.stack=[y],d._eachLine(f,function(g,T){d._handleContentLine(T,p)}),p.stack.length>1)throw new c("invalid ical body. component began but did not end");return p=null,y.length==1?y[0]:y}d.property=function(f,p){var y={component:[[],[]],designSet:p||o.defaultSet};return d._handleContentLine(f,y),y.component[1][0]},d.component=function(f){return d(f)},d.ParserError=c,d._handleContentLine=function(f,p){var y=f.indexOf(t),g=f.indexOf(r),T,v,D,O,S={};g!==-1&&y!==-1&&g>y&&(g=-1);var b;if(g!==-1){if(D=f.substring(0,g).toLowerCase(),b=d._parseParameters(f.substring(g),0,p.designSet),b[2]==-1)throw new c("Invalid parameters in '"+f+"'");if(S=b[0],T=b[1].length+b[2]+g,(v=f.substring(T).indexOf(t))!==-1)O=f.substring(T+v+1);else throw new c("Missing parameter value in '"+f+"'")}else if(y!==-1){if(D=f.substring(0,y).toLowerCase(),O=f.substring(y+1),D==="begin"){var N=[O.toLowerCase(),[],[]];p.stack.length===1?p.component.push(N):p.component[2].push(N),p.stack.push(p.component),p.component=N,p.designSet||(p.designSet=o.getDesignSet(p.component[0]));return}else if(D==="end"){p.component=p.stack.pop();return}}else throw new c('invalid line (no token ";" or ":") "'+f+'"');var F,Z=!1,j=!1,z;D in p.designSet.property&&(z=p.designSet.property[D],"multiValue"in z&&(Z=z.multiValue),"structuredValue"in z&&(j=z.structuredValue),O&&"detectType"in z&&(F=z.detectType(O))),F||("value"in S?F=S.value.toLowerCase():z?F=z.defaultType:F=s),delete S.value;var X;Z&&j?(O=d._parseMultiValue(O,j,F,[],Z,p.designSet,j),X=[D,S,F,O]):Z?(X=[D,S,F],d._parseMultiValue(O,Z,F,X,null,p.designSet,!1)):j?(O=d._parseMultiValue(O,j,F,[],null,p.designSet,j),X=[D,S,F,O]):(O=d._parseValue(O,F,p.designSet,!1),X=[D,S,F,O]),p.component[0]==="vcard"&&p.component[1].length===0&&!(D==="version"&&O==="4.0")&&(p.designSet=o.getDesignSet("vcard3")),p.component[1].push(X)},d._parseValue=function(f,p,y,g){return p in y.value&&"fromICAL"in y.value[p]?y.value[p].fromICAL(f,g):f},d._parseParameters=function(f,p,y){for(var g=p,T=0,v=n,D={},O,S,b,N=-1,F,Z,j;T!==!1&&(T=l.unescapedIndexOf(f,v,T+1))!==-1;){if(O=f.substr(g+1,T-g-1),O.length==0)throw new c("Empty parameter name in '"+f+"'");S=O.toLowerCase(),j=!1,Z=!1,S in y.param&&y.param[S].valueType?F=y.param[S].valueType:F=a,S in y.param&&(Z=y.param[S].multiValue,y.param[S].multiValueSeparateDQuote&&(j=d._rfc6868Escape('"'+Z+'"')));var z=f[T+1];if(z==='"'){if(N=T+2,T=l.unescapedIndexOf(f,'"',N),Z&&T!=-1)for(var X=!0;X;)f[T+1]==Z&&f[T+2]=='"'?T=l.unescapedIndexOf(f,'"',T+3):X=!1;if(T===-1)throw new c('invalid line (no matching double quote) "'+f+'"');b=f.substr(N,T-N),g=l.unescapedIndexOf(f,r,T),g===-1&&(T=!1)}else{N=T+1;var J=l.unescapedIndexOf(f,r,N),ne=l.unescapedIndexOf(f,t,N);ne!==-1&&J>ne?(J=ne,T=!1):J===-1?(ne===-1?J=f.length:J=ne,T=!1):(g=J,T=J),b=f.substr(N,J-N)}if(b=d._rfc6868Escape(b),Z){var B=j||Z;b=d._parseMultiValue(b,B,F,[],null,y)}else b=d._parseValue(b,F,y);Z&&S in D?Array.isArray(D[S])?D[S].push(b):D[S]=[D[S],b]:D[S]=b}return[D,b,N]},d._rfc6868Escape=function(f){return f.replace(/\^['n^]/g,function(p){return h[p]})};var h={"^'":'"',"^n":`
`,"^^":"^"};return d._parseMultiValue=function(f,p,y,g,T,v,D){var O=0,S=0,b;if(p.length===0)return f;for(;(O=l.unescapedIndexOf(f,p,S))!==-1;)b=f.substr(S,O-S),T?b=d._parseMultiValue(b,T,y,[],null,v,D):b=d._parseValue(b,y,v,D),g.push(b),S=O+p.length;return b=f.substr(S),T?b=d._parseMultiValue(b,T,y,[],null,v,D):b=d._parseValue(b,y,v,D),g.push(b),g.length==1?g[0]:g},d._eachLine=function(f,p){var y=f.length,g=f.search(i),T=g,v,D,O;do T=f.indexOf(`
`,g)+1,T>1&&f[T-2]==="\r"?O=2:O=1,T===0&&(T=y,O=0),D=f[g],D===" "||D==="	"?v+=f.substr(g+1,T-g-(O+1)):(v&&p(null,v),v=f.substr(g,T-g-O)),g=T;while(T!==y);v=v.trim(),v.length&&p(null,v)},d}();u.Component=function(){"use strict";var i=1,e=2,t=0;function r(n,s){typeof n=="string"&&(n=[n,[],[]]),this.jCal=n,this.parent=s||null}return r.prototype={_hydratedPropertyCount:0,_hydratedComponentCount:0,get name(){return this.jCal[t]},get _designSet(){var n=this.parent&&this.parent._designSet;return n||u.design.getDesignSet(this.name)},_hydrateComponent:function(n){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[n])return this._components[n];var s=new r(this.jCal[e][n],this);return this._hydratedComponentCount++,this._components[n]=s},_hydrateProperty:function(n){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[n])return this._properties[n];var s=new u.Property(this.jCal[i][n],this);return this._hydratedPropertyCount++,this._properties[n]=s},getFirstSubcomponent:function(n){if(n){for(var s=0,a=this.jCal[e],o=a.length;s<o;s++)if(a[s][t]===n){var l=this._hydrateComponent(s);return l}}else if(this.jCal[e].length)return this._hydrateComponent(0);return null},getAllSubcomponents:function(n){var s=this.jCal[e].length,a=0;if(n){for(var o=this.jCal[e],l=[];a<s;a++)n===o[a][t]&&l.push(this._hydrateComponent(a));return l}else{if(!this._components||this._hydratedComponentCount!==s)for(;a<s;a++)this._hydrateComponent(a);return this._components||[]}},hasProperty:function(n){for(var s=this.jCal[i],a=s.length,o=0;o<a;o++)if(s[o][t]===n)return!0;return!1},getFirstProperty:function(n){if(n){for(var s=0,a=this.jCal[i],o=a.length;s<o;s++)if(a[s][t]===n){var l=this._hydrateProperty(s);return l}}else if(this.jCal[i].length)return this._hydrateProperty(0);return null},getFirstPropertyValue:function(n){var s=this.getFirstProperty(n);return s?s.getFirstValue():null},getAllProperties:function(n){var s=this.jCal[i].length,a=0;if(n){for(var o=this.jCal[i],l=[];a<s;a++)n===o[a][t]&&l.push(this._hydrateProperty(a));return l}else{if(!this._properties||this._hydratedPropertyCount!==s)for(;a<s;a++)this._hydrateProperty(a);return this._properties||[]}},_removeObjectByIndex:function(n,s,a){if(s=s||[],s[a]){var o=s[a];"parent"in o&&(o.parent=null)}s.splice(a,1),this.jCal[n].splice(a,1)},_removeObject:function(n,s,a){var o=0,l=this.jCal[n],c=l.length,d=this[s];if(typeof a=="string"){for(;o<c;o++)if(l[o][t]===a)return this._removeObjectByIndex(n,d,o),!0}else if(d){for(;o<c;o++)if(d[o]&&d[o]===a)return this._removeObjectByIndex(n,d,o),!0}return!1},_removeAllObjects:function(n,s,a){for(var o=this[s],l=this.jCal[n],c=l.length-1;c>=0;c--)(!a||l[c][t]===a)&&this._removeObjectByIndex(n,o,c)},addSubcomponent:function(n){this._components||(this._components=[],this._hydratedComponentCount=0),n.parent&&n.parent.removeSubcomponent(n);var s=this.jCal[e].push(n.jCal);return this._components[s-1]=n,this._hydratedComponentCount++,n.parent=this,n},removeSubcomponent:function(n){var s=this._removeObject(e,"_components",n);return s&&this._hydratedComponentCount--,s},removeAllSubcomponents:function(n){var s=this._removeAllObjects(e,"_components",n);return this._hydratedComponentCount=0,s},addProperty:function(n){if(!(n instanceof u.Property))throw new TypeError("must instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),n.parent&&n.parent.removeProperty(n);var s=this.jCal[i].push(n.jCal);return this._properties[s-1]=n,this._hydratedPropertyCount++,n.parent=this,n},addPropertyWithValue:function(n,s){var a=new u.Property(n);return a.setValue(s),this.addProperty(a),a},updatePropertyWithValue:function(n,s){var a=this.getFirstProperty(n);return a?a.setValue(s):a=this.addPropertyWithValue(n,s),a},removeProperty:function(n){var s=this._removeObject(i,"_properties",n);return s&&this._hydratedPropertyCount--,s},removeAllProperties:function(n){var s=this._removeAllObjects(i,"_properties",n);return this._hydratedPropertyCount=0,s},toJSON:function(){return this.jCal},toString:function(){return u.stringify.component(this.jCal,this._designSet)}},r.fromString=function(n){return new r(u.parse.component(n))},r}();u.Property=function(){"use strict";var i=0,e=1,t=2,r=3,n=u.design;function s(a,o){this._parent=o||null,typeof a=="string"?(this.jCal=[a,{},n.defaultType],this.jCal[t]=this.getDefaultType()):this.jCal=a,this._updateType()}return s.prototype={get type(){return this.jCal[t]},get name(){return this.jCal[i]},get parent(){return this._parent},set parent(a){var o=!this._parent||a&&a._designSet!=this._parent._designSet;return this._parent=a,this.type==n.defaultType&&o&&(this.jCal[t]=this.getDefaultType(),this._updateType()),a},get _designSet(){return this.parent?this.parent._designSet:n.defaultSet},_updateType:function(){var a=this._designSet;if(this.type in a.value){var o=a.value[this.type];"decorate"in a.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in a.property&&(this.isMultiValue="multiValue"in a.property[this.name],this.isStructuredValue="structuredValue"in a.property[this.name])}},_hydrateValue:function(a){return this._values&&this._values[a]?this._values[a]:this.jCal.length<=r+a?null:this.isDecorated?(this._values||(this._values=[]),this._values[a]=this._decorate(this.jCal[r+a])):this.jCal[r+a]},_decorate:function(a){return this._designSet.value[this.type].decorate(a,this)},_undecorate:function(a){return this._designSet.value[this.type].undecorate(a,this)},_setDecoratedValue:function(a,o){this._values||(this._values=[]),typeof a=="object"&&"icaltype"in a?(this.jCal[r+o]=this._undecorate(a),this._values[o]=a):(this.jCal[r+o]=a,this._values[o]=this._decorate(a))},getParameter:function(a){if(a in this.jCal[e])return this.jCal[e][a]},getFirstParameter:function(a){var o=this.getParameter(a);return Array.isArray(o)?o[0]:o},setParameter:function(a,o){var l=a.toLowerCase();typeof o=="string"&&l in this._designSet.param&&"multiValue"in this._designSet.param[l]&&(o=[o]),this.jCal[e][a]=o},removeParameter:function(a){delete this.jCal[e][a]},getDefaultType:function(){var a=this.jCal[i],o=this._designSet;if(a in o.property){var l=o.property[a];if("defaultType"in l)return l.defaultType}return n.defaultType},resetType:function(a){this.removeAllValues(),this.jCal[t]=a,this._updateType()},getFirstValue:function(){return this._hydrateValue(0)},getValues:function(){var a=this.jCal.length-r;if(a<1)return[];for(var o=0,l=[];o<a;o++)l[o]=this._hydrateValue(o);return l},removeAllValues:function(){this._values&&(this._values.length=0),this.jCal.length=3},setValues:function(a){if(!this.isMultiValue)throw new Error(this.name+`: does not not support mulitValue.
override isMultiValue`);var o=a.length,l=0;if(this.removeAllValues(),o>0&&typeof a[0]=="object"&&"icaltype"in a[0]&&this.resetType(a[0].icaltype),this.isDecorated)for(;l<o;l++)this._setDecoratedValue(a[l],l);else for(;l<o;l++)this.jCal[r+l]=a[l]},setValue:function(a){this.removeAllValues(),typeof a=="object"&&"icaltype"in a&&this.resetType(a.icaltype),this.isDecorated?this._setDecoratedValue(a,0):this.jCal[r]=a},toJSON:function(){return this.jCal},toICALString:function(){return u.stringify.property(this.jCal,this._designSet,!0)}},s.fromString=function(a,o){return new s(u.parse.property(a,o))},s}();u.UtcOffset=function(){function i(e){this.fromData(e)}return i.prototype={hours:0,minutes:0,factor:1,icaltype:"utc-offset",clone:function(){return u.UtcOffset.fromSeconds(this.toSeconds())},fromData:function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this._normalize()},fromSeconds:function(e){var t=Math.abs(e);return this.factor=e<0?-1:1,this.hours=u.helpers.trunc(t/3600),t-=this.hours*3600,this.minutes=u.helpers.trunc(t/60),this},toSeconds:function(){return this.factor*(60*this.minutes+3600*this.hours)},compare:function(t){var r=this.toSeconds(),n=t.toSeconds();return(r>n)-(n>r)},_normalize:function(){for(var e=this.toSeconds(),t=this.factor;e<-43200;)e+=97200;for(;e>50400;)e-=97200;this.fromSeconds(e),e==0&&(this.factor=t)},toICALString:function(){return u.design.icalendar.value["utc-offset"].toICAL(this.toString())},toString:function(){return(this.factor==1?"+":"-")+u.helpers.pad2(this.hours)+":"+u.helpers.pad2(this.minutes)}},i.fromString=function(e){var t={};return t.factor=e[0]==="+"?1:-1,t.hours=u.helpers.strictParseInt(e.substr(1,2)),t.minutes=u.helpers.strictParseInt(e.substr(4,2)),new u.UtcOffset(t)},i.fromSeconds=function(e){var t=new i;return t.fromSeconds(e),t},i}();u.Binary=function(){function i(e){this.value=e}return i.prototype={icaltype:"binary",decodeValue:function(){return this._b64_decode(this.value)},setEncodedValue:function(t){this.value=this._b64_encode(t)},_b64_encode:function(t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n,s,a,o,l,c,d,h,f=0,p=0,y="",g=[];if(!t)return t;do n=t.charCodeAt(f++),s=t.charCodeAt(f++),a=t.charCodeAt(f++),h=n<<16|s<<8|a,o=h>>18&63,l=h>>12&63,c=h>>6&63,d=h&63,g[p++]=r.charAt(o)+r.charAt(l)+r.charAt(c)+r.charAt(d);while(f<t.length);y=g.join("");var T=t.length%3;return(T?y.slice(0,T-3):y)+"===".slice(T||3)},_b64_decode:function(t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n,s,a,o,l,c,d,h,f=0,p=0,y="",g=[];if(!t)return t;t+="";do o=r.indexOf(t.charAt(f++)),l=r.indexOf(t.charAt(f++)),c=r.indexOf(t.charAt(f++)),d=r.indexOf(t.charAt(f++)),h=o<<18|l<<12|c<<6|d,n=h>>16&255,s=h>>8&255,a=h&255,c==64?g[p++]=String.fromCharCode(n):d==64?g[p++]=String.fromCharCode(n,s):g[p++]=String.fromCharCode(n,s,a);while(f<t.length);return y=g.join(""),y},toString:function(){return this.value}},i.fromString=function(e){return new i(e)},i}();(function(){u.Period=function(e){if(this.wrappedJSObject=this,e&&"start"in e){if(e.start&&!(e.start instanceof u.Time))throw new TypeError(".start must be an instance of ICAL.Time");this.start=e.start}if(e&&e.end&&e.duration)throw new Error("cannot accept both end and duration");if(e&&"end"in e){if(e.end&&!(e.end instanceof u.Time))throw new TypeError(".end must be an instance of ICAL.Time");this.end=e.end}if(e&&"duration"in e){if(e.duration&&!(e.duration instanceof u.Duration))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=e.duration}},u.Period.prototype={start:null,end:null,duration:null,icalclass:"icalperiod",icaltype:"period",clone:function(){return u.Period.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})},getDuration:function(){return this.duration?this.duration:this.end.subtractDate(this.start)},getEnd:function(){if(this.end)return this.end;var i=this.start.clone();return i.addDuration(this.duration),i},toString:function(){return this.start+"/"+(this.end||this.duration)},toJSON:function(){return[this.start.toString(),(this.end||this.duration).toString()]},toICALString:function(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}},u.Period.fromString=function(e,t){var r=e.split("/");if(r.length!==2)throw new Error('Invalid string value: "'+e+'" must contain a "/" char.');var n={start:u.Time.fromDateTimeString(r[0],t)},s=r[1];return u.Duration.isValueString(s)?n.duration=u.Duration.fromString(s):n.end=u.Time.fromDateTimeString(s,t),new u.Period(n)},u.Period.fromData=function(e){return new u.Period(e)},u.Period.fromJSON=function(i,e,t){function r(n,s){return t?u.Time.fromString(n,s):u.Time.fromDateTimeString(n,s)}return u.Duration.isValueString(i[1])?u.Period.fromData({start:r(i[0],e),duration:u.Duration.fromString(i[1])}):u.Period.fromData({start:r(i[0],e),end:r(i[1],e)})}})();(function(){var i=/([PDWHMTS]{1,1})/;u.Duration=function(r){this.wrappedJSObject=this,this.fromData(r)},u.Duration.prototype={weeks:0,days:0,hours:0,minutes:0,seconds:0,isNegative:!1,icalclass:"icalduration",icaltype:"duration",clone:function(){return u.Duration.fromData(this)},toSeconds:function(){var r=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-r:r},fromSeconds:function(r){var n=Math.abs(r);return this.isNegative=r<0,this.days=u.helpers.trunc(n/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,n-=(this.days+7*this.weeks)*86400,this.hours=u.helpers.trunc(n/3600),n-=this.hours*3600,this.minutes=u.helpers.trunc(n/60),n-=this.minutes*60,this.seconds=n,this},fromData:function(r){var n=["weeks","days","hours","minutes","seconds","isNegative"];for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];r&&a in r?this[a]=r[a]:this[a]=0}},reset:function(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0},compare:function(r){var n=this.toSeconds(),s=r.toSeconds();return(n>s)-(n<s)},normalize:function(){this.fromSeconds(this.toSeconds())},toString:function(){if(this.toSeconds()==0)return"PT0S";var r="";return this.isNegative&&(r+="-"),r+="P",this.weeks&&(r+=this.weeks+"W"),this.days&&(r+=this.days+"D"),(this.hours||this.minutes||this.seconds)&&(r+="T",this.hours&&(r+=this.hours+"H"),this.minutes&&(r+=this.minutes+"M"),this.seconds&&(r+=this.seconds+"S")),r},toICALString:function(){return this.toString()}},u.Duration.fromSeconds=function(r){return new u.Duration().fromSeconds(r)};function e(t,r,n){var s;switch(t){case"P":r&&r==="-"?n.isNegative=!0:n.isNegative=!1;break;case"D":s="days";break;case"W":s="weeks";break;case"H":s="hours";break;case"M":s="minutes";break;case"S":s="seconds";break;default:return 0}if(s){if(!r&&r!==0)throw new Error('invalid duration value: Missing number before "'+t+'"');var a=parseInt(r,10);if(u.helpers.isStrictlyNaN(a))throw new Error('invalid duration value: Invalid number "'+r+'" before "'+t+'"');n[s]=a}return 1}u.Duration.isValueString=function(t){return t[0]==="P"||t[1]==="P"},u.Duration.fromString=function(r){for(var n=0,s=Object.create(null),a=0;(n=r.search(i))!==-1;){var o=r[n],l=r.substr(0,n);r=r.substr(n+1),a+=e(o,l,s)}if(a<2)throw new Error('invalid duration value: Not enough duration components in "'+r+'"');return new u.Duration(s)},u.Duration.fromData=function(r){return new u.Duration(r)}})();(function(){var i=["tzid","location","tznames","latitude","longitude"];u.Timezone=function(t){this.wrappedJSObject=this,this.fromData(t)},u.Timezone.prototype={tzid:"",location:"",tznames:"",latitude:0,longitude:0,component:null,expandedUntilYear:0,icalclass:"icaltimezone",fromData:function(t){if(this.expandedUntilYear=0,this.changes=[],t instanceof u.Component)this.component=t;else{if(t&&"component"in t)if(typeof t.component=="string"){var r=u.parse(t.component);this.component=new u.Component(r)}else t.component instanceof u.Component?this.component=t.component:this.component=null;for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];t&&s in t&&(this[s]=t[s])}}return this.component instanceof u.Component&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this},utcOffset:function(t){if(this==u.Timezone.utcTimezone||this==u.Timezone.localTimezone||(this._ensureCoverage(t.year),!this.changes.length))return 0;for(var r={year:t.year,month:t.month,day:t.day,hour:t.hour,minute:t.minute,second:t.second},n=this._findNearbyChange(r),s=-1,a=1;;){var o=u.helpers.clone(this.changes[n],!0);o.utcOffset<o.prevUtcOffset?u.Timezone.adjust_change(o,0,0,0,o.utcOffset):u.Timezone.adjust_change(o,0,0,0,o.prevUtcOffset);var l=u.Timezone._compare_change_fn(r,o);if(l>=0?s=n:a=-1,a==-1&&s!=-1)break;if(n+=a,n<0)return 0;if(n>=this.changes.length)break}var c=this.changes[s],d=c.utcOffset-c.prevUtcOffset;if(d<0&&s>0){var h=u.helpers.clone(c,!0);if(u.Timezone.adjust_change(h,0,0,0,h.prevUtcOffset),u.Timezone._compare_change_fn(r,h)<0){var f=this.changes[s-1],p=!1;c.is_daylight!=p&&f.is_daylight==p&&(c=f)}}return c.utcOffset},_findNearbyChange:function(t){var r=u.helpers.binsearchInsert(this.changes,t,u.Timezone._compare_change_fn);return r>=this.changes.length?this.changes.length-1:r},_ensureCoverage:function(e){if(u.Timezone._minimumExpansionYear==-1){var t=u.Time.now();u.Timezone._minimumExpansionYear=t.year}var r=e;if(r<u.Timezone._minimumExpansionYear&&(r=u.Timezone._minimumExpansionYear),r+=u.Timezone.EXTRA_COVERAGE,r>u.Timezone.MAX_YEAR&&(r=u.Timezone.MAX_YEAR),!this.changes.length||this.expandedUntilYear<e){for(var n=this.component.getAllSubcomponents(),s=n.length,a=0;a<s;a++)this._expandComponent(n[a],r,this.changes);this.changes.sort(u.Timezone._compare_change_fn),this.expandedUntilYear=r}},_expandComponent:function(e,t,r){if(!e.hasProperty("dtstart")||!e.hasProperty("tzoffsetto")||!e.hasProperty("tzoffsetfrom"))return null;var n=e.getFirstProperty("dtstart").getFirstValue(),s;function a(g){return g.factor*(g.hours*3600+g.minutes*60)}function o(){var g={};return g.is_daylight=e.name=="daylight",g.utcOffset=a(e.getFirstProperty("tzoffsetto").getFirstValue()),g.prevUtcOffset=a(e.getFirstProperty("tzoffsetfrom").getFirstValue()),g}if(!e.hasProperty("rrule")&&!e.hasProperty("rdate"))s=o(),s.year=n.year,s.month=n.month,s.day=n.day,s.hour=n.hour,s.minute=n.minute,s.second=n.second,u.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset),r.push(s);else{var l=e.getAllProperties("rdate");for(var c in l)if(l.hasOwnProperty(c)){var d=l[c],h=d.getFirstValue();s=o(),s.year=h.year,s.month=h.month,s.day=h.day,h.isDate?(s.hour=n.hour,s.minute=n.minute,s.second=n.second,n.zone!=u.Timezone.utcTimezone&&u.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset)):(s.hour=h.hour,s.minute=h.minute,s.second=h.second,h.zone!=u.Timezone.utcTimezone&&u.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset)),r.push(s)}var f=e.getFirstProperty("rrule");if(f){f=f.getFirstValue(),s=o(),f.until&&f.until.zone==u.Timezone.utcTimezone&&(f.until.adjust(0,0,0,s.prevUtcOffset),f.until.zone=u.Timezone.localTimezone);for(var p=f.iterator(n),y;(y=p.next())&&(s=o(),!(y.year>t||!y));)s.year=y.year,s.month=y.month,s.day=y.day,s.hour=y.hour,s.minute=y.minute,s.second=y.second,s.isDate=y.isDate,u.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset),r.push(s)}}return r},toString:function(){return this.tznames?this.tznames:this.tzid}},u.Timezone._compare_change_fn=function(t,r){return t.year<r.year?-1:t.year>r.year?1:t.month<r.month?-1:t.month>r.month?1:t.day<r.day?-1:t.day>r.day?1:t.hour<r.hour?-1:t.hour>r.hour?1:t.minute<r.minute?-1:t.minute>r.minute?1:t.second<r.second?-1:t.second>r.second?1:0},u.Timezone.convert_time=function(t,r,n){if(t.isDate||r.tzid==n.tzid||r==u.Timezone.localTimezone||n==u.Timezone.localTimezone)return t.zone=n,t;var s=r.utcOffset(t);return t.adjust(0,0,0,-s),s=n.utcOffset(t),t.adjust(0,0,0,s),null},u.Timezone.fromData=function(t){var r=new u.Timezone;return r.fromData(t)},u.Timezone.utcTimezone=u.Timezone.fromData({tzid:"UTC"}),u.Timezone.localTimezone=u.Timezone.fromData({tzid:"floating"}),u.Timezone.adjust_change=function(t,r,n,s,a){return u.Time.prototype.adjust.call(t,r,n,s,a,t)},u.Timezone._minimumExpansionYear=-1,u.Timezone.MAX_YEAR=2035,u.Timezone.EXTRA_COVERAGE=5})();u.TimezoneService=function(){var i,e={get count(){return Object.keys(i).length},reset:function(){i=Object.create(null);var t=u.Timezone.utcTimezone;i.Z=t,i.UTC=t,i.GMT=t},has:function(t){return!!i[t]},get:function(t){return i[t]},register:function(t,r){if(t instanceof u.Component&&t.name==="vtimezone"&&(r=new u.Timezone(t),t=r.tzid),r instanceof u.Timezone)i[t]=r;else throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component")},remove:function(t){return delete i[t]}};return e.reset(),e}();(function(){u.Time=function(e,t){this.wrappedJSObject=this;var r=this._time=Object.create(null);r.year=0,r.month=1,r.day=1,r.hour=0,r.minute=0,r.second=0,r.isDate=!1,this.fromData(e,t)},u.Time._dowCache={},u.Time._wnCache={},u.Time.prototype={icalclass:"icaltime",_cachedUnixTime:null,get icaltype(){return this.isDate?"date":"date-time"},zone:null,_pendingNormalization:!1,clone:function(){return new u.Time(this._time,this.zone)},reset:function(){this.fromData(u.Time.epochTime),this.zone=u.Timezone.utcTimezone},resetTo:function(e,t,r,n,s,a,o){this.fromData({year:e,month:t,day:r,hour:n,minute:s,second:a,zone:o})},fromJSDate:function(e,t){return e?t?(this.zone=u.Timezone.utcTimezone,this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()):(this.zone=u.Timezone.localTimezone,this.year=e.getFullYear(),this.month=e.getMonth()+1,this.day=e.getDate(),this.hour=e.getHours(),this.minute=e.getMinutes(),this.second=e.getSeconds()):this.reset(),this._cachedUnixTime=null,this},fromData:function(e,t){if(e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(r==="icaltype")continue;this[r]=e[r]}}if(t&&(this.zone=t),e&&!("isDate"in e)?this.isDate=!("hour"in e):e&&"isDate"in e&&(this.isDate=e.isDate),e&&"timezone"in e){var n=u.TimezoneService.get(e.timezone);this.zone=n||u.Timezone.localTimezone}return e&&"zone"in e&&(this.zone=e.zone),this.zone||(this.zone=u.Timezone.localTimezone),this._cachedUnixTime=null,this},dayOfWeek:function(e){var t=e||u.Time.SUNDAY,r=(this.year<<12)+(this.month<<8)+(this.day<<3)+t;if(r in u.Time._dowCache)return u.Time._dowCache[r];var n=this.day,s=this.month+(this.month<3?12:0),a=this.year-(this.month<3?1:0),o=n+a+u.helpers.trunc((s+1)*26/10)+u.helpers.trunc(a/4);return o+=u.helpers.trunc(a/100)*6+u.helpers.trunc(a/400),o=(o+7-t)%7+1,u.Time._dowCache[r]=o,o},dayOfYear:function(){var e=u.Time.isLeapYear(this.year)?1:0,t=u.Time.daysInYearPassedMonth;return t[e][this.month-1]+this.day},startOfWeek:function(e){var t=e||u.Time.SUNDAY,r=this.clone();return r.day-=(this.dayOfWeek()+7-t)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r},endOfWeek:function(e){var t=e||u.Time.SUNDAY,r=this.clone();return r.day+=(7-this.dayOfWeek()+t-u.Time.SUNDAY)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r},startOfMonth:function(){var e=this.clone();return e.day=1,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},endOfMonth:function(){var e=this.clone();return e.day=u.Time.daysInMonth(e.month,e.year),e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},startOfYear:function(){var e=this.clone();return e.day=1,e.month=1,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},endOfYear:function(){var e=this.clone();return e.day=31,e.month=12,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},startDoyWeek:function(e){var t=e||u.Time.SUNDAY,r=this.dayOfWeek()-t;return r<0&&(r+=7),this.dayOfYear()-r},getDominicalLetter:function(){return u.Time.getDominicalLetter(this.year)},nthWeekDay:function(e,t){var r=u.Time.daysInMonth(this.month,this.year),n,s=t,a=0,o=this.clone();if(s>=0){o.day=1,s!=0&&s--,a=o.day;var l=o.dayOfWeek(),c=e-l;c<0&&(c+=7),a+=c,a-=e,n=e}else{o.day=r;var d=o.dayOfWeek();s++,n=d-e,n<0&&(n+=7),n=r-n}return n+=s*7,a+n},isNthWeekDay:function(i,e){var t=this.dayOfWeek();if(e===0&&t===i)return!0;var r=this.nthWeekDay(i,e);return r===this.day},weekNumber:function(e){var t=(this.year<<12)+(this.month<<8)+(this.day<<3)+e;if(t in u.Time._wnCache)return u.Time._wnCache[t];var r,n=this.clone();n.isDate=!0;var s=this.year;n.month==12&&n.day>25?(r=u.Time.weekOneStarts(s+1,e),n.compare(r)<0?r=u.Time.weekOneStarts(s,e):s++):(r=u.Time.weekOneStarts(s,e),n.compare(r)<0&&(r=u.Time.weekOneStarts(--s,e)));var a=n.subtractDate(r).toSeconds()/86400,o=u.helpers.trunc(a/7)+1;return u.Time._wnCache[t]=o,o},addDuration:function(e){var t=e.isNegative?-1:1,r=this.second,n=this.minute,s=this.hour,a=this.day;r+=t*e.seconds,n+=t*e.minutes,s+=t*e.hours,a+=t*e.days,a+=t*7*e.weeks,this.second=r,this.minute=n,this.hour=s,this.day=a,this._cachedUnixTime=null},subtractDate:function(e){var t=this.toUnixTime()+this.utcOffset(),r=e.toUnixTime()+e.utcOffset();return u.Duration.fromSeconds(t-r)},subtractDateTz:function(e){var t=this.toUnixTime(),r=e.toUnixTime();return u.Duration.fromSeconds(t-r)},compare:function(e){var t=this.toUnixTime(),r=e.toUnixTime();return t>r?1:r>t?-1:0},compareDateOnlyTz:function(e,t){function r(o){return u.Time._cmp_attr(n,s,o)}var n=this.convertToZone(t),s=e.convertToZone(t),a=0;return(a=r("year"))!=0||(a=r("month"))!=0||(a=r("day"))!=0,a},convertToZone:function(e){var t=this.clone(),r=this.zone.tzid==e.tzid;return!this.isDate&&!r&&u.Timezone.convert_time(t,this.zone,e),t.zone=e,t},utcOffset:function(){return this.zone==u.Timezone.localTimezone||this.zone==u.Timezone.utcTimezone?0:this.zone.utcOffset(this)},toICALString:function(){var i=this.toString();return i.length>10?u.design.icalendar.value["date-time"].toICAL(i):u.design.icalendar.value.date.toICAL(i)},toString:function(){var e=this.year+"-"+u.helpers.pad2(this.month)+"-"+u.helpers.pad2(this.day);return this.isDate||(e+="T"+u.helpers.pad2(this.hour)+":"+u.helpers.pad2(this.minute)+":"+u.helpers.pad2(this.second),this.zone===u.Timezone.utcTimezone&&(e+="Z")),e},toJSDate:function(){return this.zone==u.Timezone.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(this.toUnixTime()*1e3)},_normalize:function(){var e=this._time.isDate;return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this},adjust:function(e,t,r,n,s){var a,o,l=0,c=0,d,h,f,p,y,g=s||this._time;if(g.isDate||(d=g.second+n,g.second=d%60,a=u.helpers.trunc(d/60),g.second<0&&(g.second+=60,a--),h=g.minute+r+a,g.minute=h%60,o=u.helpers.trunc(h/60),g.minute<0&&(g.minute+=60,o--),f=g.hour+t+o,g.hour=f%24,l=u.helpers.trunc(f/24),g.hour<0&&(g.hour+=24,l--)),g.month>12?c=u.helpers.trunc((g.month-1)/12):g.month<1&&(c=u.helpers.trunc(g.month/12)-1),g.year+=c,g.month-=12*c,p=g.day+e+l,p>0)for(;y=u.Time.daysInMonth(g.month,g.year),!(p<=y);)g.month++,g.month>12&&(g.year++,g.month=1),p-=y;else for(;p<=0;)g.month==1?(g.year--,g.month=12):g.month--,p+=u.Time.daysInMonth(g.month,g.year);return g.day=p,this._cachedUnixTime=null,this},fromUnixTime:function(e){this.zone=u.Timezone.utcTimezone;var t=u.Time.epochTime.clone();t.adjust(0,0,0,e),this.year=t.year,this.month=t.month,this.day=t.day,this.hour=t.hour,this.minute=t.minute,this.second=Math.floor(t.second),this._cachedUnixTime=null},toUnixTime:function(){if(this._cachedUnixTime!==null)return this._cachedUnixTime;var e=this.utcOffset(),t=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-e);return this._cachedUnixTime=t/1e3,this._cachedUnixTime},toJSON:function(){for(var i=["year","month","day","hour","minute","second","isDate"],e=Object.create(null),t=0,r=i.length,n;t<r;t++)n=i[t],e[n]=this[n];return this.zone&&(e.timezone=this.zone.tzid),e}},function(){function e(t){Object.defineProperty(u.Time.prototype,t,{get:function(){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[t]},set:function(n){return t==="isDate"&&n&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[t]=n,n}})}"defineProperty"in Object&&(e("year"),e("month"),e("day"),e("hour"),e("minute"),e("second"),e("isDate"))}(),u.Time.daysInMonth=function(e,t){var r=[0,31,28,31,30,31,30,31,31,30,31,30,31],n=30;return e<1||e>12||(n=r[e],e==2&&(n+=u.Time.isLeapYear(t))),n},u.Time.isLeapYear=function(e){return e<=1752?e%4==0:e%4==0&&e%100!=0||e%400==0},u.Time.fromDayOfYear=function(e,t){var r=t,n=e,s=new u.Time;s.auto_normalize=!1;var a=u.Time.isLeapYear(r)?1:0;if(n<1)return r--,a=u.Time.isLeapYear(r)?1:0,n+=u.Time.daysInYearPassedMonth[a][12],u.Time.fromDayOfYear(n,r);if(n>u.Time.daysInYearPassedMonth[a][12])return a=u.Time.isLeapYear(r)?1:0,n-=u.Time.daysInYearPassedMonth[a][12],r++,u.Time.fromDayOfYear(n,r);s.year=r,s.isDate=!0;for(var o=11;o>=0;o--)if(n>u.Time.daysInYearPassedMonth[a][o]){s.month=o+1,s.day=n-u.Time.daysInYearPassedMonth[a][o];break}return s.auto_normalize=!0,s},u.Time.fromStringv2=function(e){return new u.Time({year:parseInt(e.substr(0,4),10),month:parseInt(e.substr(5,2),10),day:parseInt(e.substr(8,2),10),isDate:!0})},u.Time.fromDateString=function(i){return new u.Time({year:u.helpers.strictParseInt(i.substr(0,4)),month:u.helpers.strictParseInt(i.substr(5,2)),day:u.helpers.strictParseInt(i.substr(8,2)),isDate:!0})},u.Time.fromDateTimeString=function(i,e){if(i.length<19)throw new Error('invalid date-time value: "'+i+'"');var t;i[19]&&i[19]==="Z"?t="Z":e&&(t=e.getParameter("tzid"));var r=new u.Time({year:u.helpers.strictParseInt(i.substr(0,4)),month:u.helpers.strictParseInt(i.substr(5,2)),day:u.helpers.strictParseInt(i.substr(8,2)),hour:u.helpers.strictParseInt(i.substr(11,2)),minute:u.helpers.strictParseInt(i.substr(14,2)),second:u.helpers.strictParseInt(i.substr(17,2)),timezone:t});return r},u.Time.fromString=function(e,t){return e.length>10?u.Time.fromDateTimeString(e,t):u.Time.fromDateString(e)},u.Time.fromJSDate=function(e,t){var r=new u.Time;return r.fromJSDate(e,t)},u.Time.fromData=function(e,t){var r=new u.Time;return r.fromData(e,t)},u.Time.now=function(){return u.Time.fromJSDate(new Date,!1)},u.Time.weekOneStarts=function(e,t){var r=u.Time.fromData({year:e,month:1,day:1,isDate:!0}),n=r.dayOfWeek(),s=t||u.Time.DEFAULT_WEEK_START;return n>u.Time.THURSDAY&&(r.day+=7),s>u.Time.THURSDAY&&(r.day-=7),r.day-=n-s,r},u.Time.getDominicalLetter=function(i){var e="GFEDCBA",t=(i+(i/4|0)+(i/400|0)-(i/100|0)-1)%7,r=u.Time.isLeapYear(i);return r?e[(t+6)%7]+e[t]:e[t]},u.Time.epochTime=u.Time.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"}),u.Time._cmp_attr=function(e,t,r){return e[r]>t[r]?1:e[r]<t[r]?-1:0},u.Time.daysInYearPassedMonth=[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]],u.Time.SUNDAY=1,u.Time.MONDAY=2,u.Time.TUESDAY=3,u.Time.WEDNESDAY=4,u.Time.THURSDAY=5,u.Time.FRIDAY=6,u.Time.SATURDAY=7,u.Time.DEFAULT_WEEK_START=u.Time.MONDAY})();(function(){u.VCardTime=function(i,e,t){this.wrappedJSObject=this;var r=this._time=Object.create(null);r.year=null,r.month=null,r.day=null,r.hour=null,r.minute=null,r.second=null,this.icaltype=t||"date-and-or-time",this.fromData(i,e)},u.helpers.inherits(u.Time,u.VCardTime,{icalclass:"vcardtime",icaltype:"date-and-or-time",zone:null,clone:function(){return new u.VCardTime(this._time,this.zone,this.icaltype)},_normalize:function(){return this},utcOffset:function(){return this.zone instanceof u.UtcOffset?this.zone.toSeconds():u.Time.prototype.utcOffset.apply(this,arguments)},toICALString:function(){return u.design.vcard.value[this.icaltype].toICAL(this.toString())},toString:function(){var e=u.helpers.pad2,t=this.year,r=this.month,n=this.day,s=this.hour,a=this.minute,o=this.second,l=t!==null,c=r!==null,d=n!==null,h=s!==null,f=a!==null,p=o!==null,y=(l?e(t)+(c||d?"-":""):c||d?"--":"")+(c?e(r):"")+(d?"-"+e(n):""),g=(h?e(s):"-")+(h&&f?":":"")+(f?e(a):"")+(!h&&!f?"-":"")+(f&&p?":":"")+(p?e(o):""),T;if(this.zone===u.Timezone.utcTimezone)T="Z";else if(this.zone instanceof u.UtcOffset)T=this.zone.toString();else if(this.zone===u.Timezone.localTimezone)T="";else if(this.zone instanceof u.Timezone){var v=u.UtcOffset.fromSeconds(this.zone.utcOffset(this));T=v.toString()}else T="";switch(this.icaltype){case"time":return g+T;case"date-and-or-time":case"date-time":return y+(g=="--"?"":"T"+g+T);case"date":return y}return null}}),u.VCardTime.fromDateAndOrTimeString=function(i,e){function t(g,T,v){return g?u.helpers.strictParseInt(g.substr(T,v)):null}var r=i.split("T"),n=r[0],s=r[1],a=s?u.design.vcard.value.time._splitZone(s):[],o=a[0],l=a[1],c=u.helpers.strictParseInt,d=n?n.length:0,h=l?l.length:0,f=n&&n[0]=="-"&&n[1]=="-",p=l&&l[0]=="-",y={year:f?null:t(n,0,4),month:f&&(d==4||d==7)?t(n,2,2):d==7||d==10?t(n,5,2):null,day:d==5?t(n,3,2):d==7&&f?t(n,5,2):d==10?t(n,8,2):null,hour:p?null:t(l,0,2),minute:p&&h==3?t(l,1,2):h>4?p?t(l,1,2):t(l,3,2):null,second:h==4?t(l,2,2):h==6?t(l,4,2):h==8?t(l,6,2):null};return o=="Z"?o=u.Timezone.utcTimezone:o&&o[3]==":"?o=u.UtcOffset.fromString(o):o=null,new u.VCardTime(y,o,e)}})();(function(){var i={SU:u.Time.SUNDAY,MO:u.Time.MONDAY,TU:u.Time.TUESDAY,WE:u.Time.WEDNESDAY,TH:u.Time.THURSDAY,FR:u.Time.FRIDAY,SA:u.Time.SATURDAY},e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);var r=["BYSECOND","BYMINUTE","BYHOUR","BYDAY","BYMONTHDAY","BYYEARDAY","BYWEEKNO","BYMONTH","BYSETPOS"];u.Recur=function(h){this.wrappedJSObject=this,this.parts={},h&&typeof h=="object"&&this.fromData(h)},u.Recur.prototype={parts:null,interval:1,wkst:u.Time.MONDAY,until:null,count:null,freq:null,icalclass:"icalrecur",icaltype:"recur",iterator:function(d){return new u.RecurIterator({rule:this,dtstart:d})},clone:function(){return new u.Recur(this.toJSON())},isFinite:function(){return!!(this.count||this.until)},isByCount:function(){return!!(this.count&&!this.until)},addComponent:function(h,f){var p=h.toUpperCase();p in this.parts?this.parts[p].push(f):this.parts[p]=[f]},setComponent:function(h,f){this.parts[h.toUpperCase()]=f.slice()},getComponent:function(h){var f=h.toUpperCase();return f in this.parts?this.parts[f].slice():[]},getNextOccurrence:function(h,f){var p=this.iterator(h),y,g;do y=p.next();while(y&&y.compare(f)<=0);return y&&f.zone&&(y.zone=f.zone),y},fromData:function(d){for(var h in d){var f=h.toUpperCase();f in c?Array.isArray(d[h])?this.parts[f]=d[h]:this.parts[f]=[d[h]]:this[h]=d[h]}this.interval&&typeof this.interval!="number"&&l.INTERVAL(this.interval,this),this.wkst&&typeof this.wkst!="number"&&(this.wkst=u.Recur.icalDayToNumericDay(this.wkst)),this.until&&!(this.until instanceof u.Time)&&(this.until=u.Time.fromString(this.until))},toJSON:function(){var d=Object.create(null);d.freq=this.freq,this.count&&(d.count=this.count),this.interval>1&&(d.interval=this.interval);for(var h in this.parts)if(this.parts.hasOwnProperty(h)){var f=this.parts[h];Array.isArray(f)&&f.length==1?d[h.toLowerCase()]=f[0]:d[h.toLowerCase()]=u.helpers.clone(this.parts[h])}return this.until&&(d.until=this.until.toString()),"wkst"in this&&this.wkst!==u.Time.DEFAULT_WEEK_START&&(d.wkst=u.Recur.numericDayToIcalDay(this.wkst)),d},toString:function(){var h="FREQ="+this.freq;this.count&&(h+=";COUNT="+this.count),this.interval>1&&(h+=";INTERVAL="+this.interval);for(var f in this.parts)this.parts.hasOwnProperty(f)&&(h+=";"+f+"="+this.parts[f]);return this.until&&(h+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==u.Time.DEFAULT_WEEK_START&&(h+=";WKST="+u.Recur.numericDayToIcalDay(this.wkst)),h}};function n(d,h,f,p){var y=p;if(p[0]==="+"&&(y=p.substr(1)),y=u.helpers.strictParseInt(y),h!==void 0&&p<h)throw new Error(d+': invalid value "'+p+'" must be > '+h);if(f!==void 0&&p>f)throw new Error(d+': invalid value "'+p+'" must be < '+h);return y}u.Recur.icalDayToNumericDay=function(h,f){var p=f||u.Time.SUNDAY;return(i[h]-p+7)%7+1},u.Recur.numericDayToIcalDay=function(h,f){var p=f||u.Time.SUNDAY,y=h+p-u.Time.SUNDAY;return y>7&&(y-=7),e[y]};var s=/^(SU|MO|TU|WE|TH|FR|SA)$/,a=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,o=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"],l={FREQ:function(d,h,f){if(o.indexOf(d)!==-1)h.freq=d;else throw new Error('invalid frequency "'+d+'" expected: "'+o.join(", ")+'"')},COUNT:function(d,h,f){h.count=u.helpers.strictParseInt(d)},INTERVAL:function(d,h,f){h.interval=u.helpers.strictParseInt(d),h.interval<1&&(h.interval=1)},UNTIL:function(d,h,f){d.length>10?h.until=u.design.icalendar.value["date-time"].fromICAL(d):h.until=u.design.icalendar.value.date.fromICAL(d),f||(h.until=u.Time.fromString(h.until))},WKST:function(d,h,f){if(s.test(d))h.wkst=u.Recur.icalDayToNumericDay(d);else throw new Error('invalid WKST value "'+d+'"')}},c={BYSECOND:n.bind(this,"BYSECOND",0,60),BYMINUTE:n.bind(this,"BYMINUTE",0,59),BYHOUR:n.bind(this,"BYHOUR",0,23),BYDAY:function(d){if(a.test(d))return d;throw new Error('invalid BYDAY value "'+d+'"')},BYMONTHDAY:n.bind(this,"BYMONTHDAY",-31,31),BYYEARDAY:n.bind(this,"BYYEARDAY",-366,366),BYWEEKNO:n.bind(this,"BYWEEKNO",-53,53),BYMONTH:n.bind(this,"BYMONTH",1,12),BYSETPOS:n.bind(this,"BYSETPOS",-366,366)};u.Recur.fromString=function(d){var h=u.Recur._stringToData(d,!1);return new u.Recur(h)},u.Recur.fromData=function(d){return new u.Recur(d)},u.Recur._stringToData=function(d,h){for(var f=Object.create(null),p=d.split(";"),y=p.length,g=0;g<y;g++){var T=p[g].split("="),v=T[0].toUpperCase(),D=T[0].toLowerCase(),O=h?D:v,S=T[1];if(v in c){for(var b=S.split(","),N=0,F=b.length;N<F;N++)b[N]=c[v](b[N]);f[O]=b.length==1?b[0]:b}else v in l?l[v](S,f,h):f[D]=S}return f}})();u.RecurIterator=function(){function i(e){this.fromData(e)}return i.prototype={completed:!1,rule:null,dtstart:null,last:null,occurrence_number:0,by_indices:null,initialized:!1,by_data:null,days:null,days_index:0,fromData:function(e){if(this.rule=u.helpers.formatClassType(e.rule,u.Recur),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=u.helpers.formatClassType(e.dtstart,u.Time),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");e.by_data?this.by_data=e.by_data:this.by_data=u.helpers.clone(this.rule.parts,!0),e.occurrence_number&&(this.occurrence_number=e.occurrence_number),this.days=e.days||[],e.last&&(this.last=u.helpers.formatClassType(e.last,u.Time)),this.by_indices=e.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=e.initialized||!1,this.initialized||this.init()},init:function(){this.initialized=!0,this.last=this.dtstart.clone();var t=this.by_data;if("BYDAY"in t&&this.sort_byday_rules(t.BYDAY),"BYYEARDAY"in t&&("BYMONTH"in t||"BYWEEKNO"in t||"BYMONTHDAY"in t||"BYDAY"in t))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in t&&"BYMONTHDAY"in t)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if(this.rule.freq=="MONTHLY"&&("BYYEARDAY"in t||"BYWEEKNO"in t))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if(this.rule.freq=="WEEKLY"&&("BYYEARDAY"in t||"BYMONTHDAY"in t))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if(this.rule.freq!="YEARLY"&&"BYYEARDAY"in t)throw new Error("BYYEARDAY may only appear in YEARLY rules");if(this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour),this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day),this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),this.rule.freq=="WEEKLY")if("BYDAY"in t){var r=this.ruleDayOfWeek(t.BYDAY[0],this.rule.wkst),n=r[0],s=r[1],a=s-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<s&&a>=0||a<0)&&(this.last.day+=a)}else{var o=u.Recur.numericDayToIcalDay(this.dtstart.dayOfWeek());t.BYDAY=[o]}if(this.rule.freq=="YEARLY"){for(;this.expand_year_days(this.last.year),!(this.days.length>0);)this.increment_year(this.rule.interval);this._nextByYearDay()}if(this.rule.freq=="MONTHLY"&&this.has_by_data("BYDAY")){var l=null,c=this.last.clone(),d=u.Time.daysInMonth(this.last.month,this.last.year);for(var h in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(h)){this.last=c.clone();var r=this.ruleDayOfWeek(this.by_data.BYDAY[h]),n=r[0],s=r[1],f=this.last.nthWeekDay(s,n);if(n>=6||n<=-6)throw new Error("Malformed values in BYDAY part");if(f>d||f<=0){if(l&&l.month==c.month)continue;for(;f>d||f<=0;)this.increment_month(),d=u.Time.daysInMonth(this.last.month,this.last.year),f=this.last.nthWeekDay(s,n)}this.last.day=f,(!l||this.last.compare(l)<0)&&(l=this.last.clone())}if(this.last=l.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>d||this.last.day==0)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")&&this.last.day<0){var d=u.Time.daysInMonth(this.last.month,this.last.year);this.last.day=d+this.last.day+1}},next:function(){var t=this.last?this.last.clone():null;if(this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)return this.completed=!0,null;if(this.occurrence_number==0&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;var r;do switch(r=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":r=this.next_month();break;case"YEARLY":this.next_year();break;default:return null}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!r);if(this.last.compare(t)==0)throw new Error("Same occurrence found twice, protecting you from death by recursion");return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)},next_second:function(){return this.next_generic("BYSECOND","SECONDLY","second","minute")},increment_second:function(t){return this.increment_generic(t,"second",60,"minute")},next_minute:function(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")},increment_minute:function(t){return this.increment_generic(t,"minute",60,"hour")},next_hour:function(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")},increment_hour:function(t){this.increment_generic(t,"hour",24,"monthday")},next_day:function(){var t="BYDAY"in this.by_data,r=this.rule.freq=="DAILY";return this.next_hour()==0||(r?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0},next_week:function(){var t=0;if(this.next_weekday_by_week()==0)return t;if(this.has_by_data("BYWEEKNO")){var r=++this.by_indices.BYWEEKNO;this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,t=1),this.last.month=1,this.last.day=1;var n=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*n,t&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return t},normalizeByMonthDayRules:function(e,t,r){for(var n=u.Time.daysInMonth(t,e),s=[],a=0,o=r.length,l;a<o;a++)if(l=r[a],!(Math.abs(l)>n)){if(l<0)l=n+(l+1);else if(l===0)continue;s.indexOf(l)===-1&&s.push(l)}return s.sort(function(c,d){return c-d})},_byDayAndMonthDay:function(e){var t,r=this.by_data.BYDAY,n,s=0,a,o=r.length,l=0,c,d=this,h=this.last.day;function f(){for(c=u.Time.daysInMonth(d.last.month,d.last.year),t=d.normalizeByMonthDayRules(d.last.year,d.last.month,d.by_data.BYMONTHDAY),a=t.length;t[s]<=h&&!(e&&t[s]==h)&&s<a-1;)s++}function p(){h=0,d.increment_month(),s=0,f()}f(),e&&(h-=1);for(var y=48;!l&&y;){if(y--,n=h+1,n>c){p();continue}var g=t[s++];if(g>=n)h=g;else{p();continue}for(var T=0;T<o;T++){var v=this.ruleDayOfWeek(r[T]),D=v[0],O=v[1];if(this.last.day=h,this.last.isNthWeekDay(O,D)){l=1;break}}if(!l&&s===a){p();continue}}if(y<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return l},next_month:function(){var t=this.rule.freq=="MONTHLY",r=1;if(this.next_hour()==0)return r;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))r=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){var n=u.Time.daysInMonth(this.last.month,this.last.year),s=0,a=0;if(this.has_by_data("BYSETPOS")){for(var o=this.last.day,l=1;l<=n;l++)this.last.day=l,this.is_day_in_byday(this.last)&&(a++,l<=o&&s++);this.last.day=o}r=0;for(var l=this.last.day+1;l<=n;l++)if(this.last.day=l,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++s)||this.check_set_position(s-a-1))){r=1;break}l>n&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?(!this.has_by_data("BYSETPOS")||this.check_set_position(1))&&(r=1):r=0)}else if(this.has_by_data("BYMONTHDAY")){this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month());var n=u.Time.daysInMonth(this.last.month,this.last.year),l=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];l<0&&(l=n+l+1),l>n?(this.last.day=1,r=this.is_day_in_byday(this.last)):this.last.day=l}else{this.increment_month();var n=u.Time.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>n?r=0:this.last.day=this.by_data.BYMONTHDAY[0]}return r},next_weekday_by_week:function(){var t=0;if(this.next_hour()==0)return t;if(!this.has_by_data("BYDAY"))return 1;for(;;){var r=new u.Time;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,t=1);var n=this.by_data.BYDAY[this.by_indices.BYDAY],s=this.ruleDayOfWeek(n),a=s[1];a-=this.rule.wkst,a<0&&(a+=7),r.year=this.last.year,r.month=this.last.month,r.day=this.last.day;var o=r.startDoyWeek(this.rule.wkst);if(!(a+o<1&&!t)){var l=u.Time.fromDayOfYear(o+a,this.last.year);return this.last.year=l.year,this.last.month=l.month,this.last.day=l.day,t}}},next_year:function(){if(this.next_hour()==0)return 0;if(++this.days_index==this.days.length){this.days_index=0;do this.increment_year(this.rule.interval),this.expand_year_days(this.last.year);while(this.days.length==0)}return this._nextByYearDay(),1},_nextByYearDay:function(){var t=this.days[this.days_index],r=this.last.year;t<1&&(t+=1,r+=1);var n=u.Time.fromDayOfYear(t,r);this.last.day=n.day,this.last.month=n.month},ruleDayOfWeek:function(t,r){var n=t.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(n){var s=parseInt(n[1]||0,10);return t=u.Recur.icalDayToNumericDay(n[2],r),[s,t]}else return[0,0]},next_generic:function(t,r,n,s,a){var o=t in this.by_data,l=this.rule.freq==r,c=0;if(a&&this[a]()==0)return c;if(o){this.by_indices[t]++;var d=this.by_indices[t],h=this.by_data[t];this.by_indices[t]==h.length&&(this.by_indices[t]=0,c=1),this.last[n]=h[this.by_indices[t]]}else l&&this["increment_"+n](this.rule.interval);return o&&c&&l&&this["increment_"+s](1),c},increment_monthday:function(t){for(var r=0;r<t;r++){var n=u.Time.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>n&&(this.last.day-=n,this.increment_month())}},increment_month:function(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{this.rule.freq=="MONTHLY"?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;var t=u.helpers.trunc(this.last.month/12);this.last.month%=12,this.last.month++,t!=0&&this.increment_year(t)}},increment_year:function(t){this.last.year+=t},increment_generic:function(t,r,n,s){this.last[r]+=t;var a=u.helpers.trunc(this.last[r]/n);this.last[r]%=n,a!=0&&this["increment_"+s](a)},has_by_data:function(t){return t in this.rule.parts},expand_year_days:function(t){var r=new u.Time;this.days=[];var n={},s=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];o in this.rule.parts&&(n[o]=this.rule.parts[o])}if("BYMONTH"in n&&"BYWEEKNO"in n){var l=1,c={};r.year=t,r.isDate=!0;for(var d=0;d<this.by_data.BYMONTH.length;d++){var h=this.by_data.BYMONTH[d];r.month=h,r.day=1;var f=r.weekNumber(this.rule.wkst);r.day=u.Time.daysInMonth(h,t);var p=r.weekNumber(this.rule.wkst);for(d=f;d<p;d++)c[d]=1}for(var y=0;y<this.by_data.BYWEEKNO.length&&l;y++){var g=this.by_data.BYWEEKNO[y];g<52?l&=c[y]:l=0}l?delete n.BYMONTH:delete n.BYWEEKNO}var T=Object.keys(n).length;if(T==0){var v=this.dtstart.clone();v.year=this.last.year,this.days.push(v.dayOfYear())}else if(T==1&&"BYMONTH"in n){for(var D in this.by_data.BYMONTH)if(this.by_data.BYMONTH.hasOwnProperty(D)){var O=this.dtstart.clone();O.year=t,O.month=this.by_data.BYMONTH[D],O.isDate=!0,this.days.push(O.dayOfYear())}}else if(T==1&&"BYMONTHDAY"in n){for(var S in this.by_data.BYMONTHDAY)if(this.by_data.BYMONTHDAY.hasOwnProperty(S)){var b=this.dtstart.clone(),N=this.by_data.BYMONTHDAY[S];if(N<0){var F=u.Time.daysInMonth(b.month,t);N=N+F+1}b.day=N,b.year=t,b.isDate=!0,this.days.push(b.dayOfYear())}}else if(T==2&&"BYMONTHDAY"in n&&"BYMONTH"in n){for(var D in this.by_data.BYMONTH)if(this.by_data.BYMONTH.hasOwnProperty(D)){var Z=this.by_data.BYMONTH[D],F=u.Time.daysInMonth(Z,t);for(var S in this.by_data.BYMONTHDAY)if(this.by_data.BYMONTHDAY.hasOwnProperty(S)){var N=this.by_data.BYMONTHDAY[S];N<0&&(N=N+F+1),r.day=N,r.month=Z,r.year=t,r.isDate=!0,this.days.push(r.dayOfYear())}}}else if(!(T==1&&"BYWEEKNO"in n)){if(!(T==2&&"BYWEEKNO"in n&&"BYMONTHDAY"in n))if(T==1&&"BYDAY"in n)this.days=this.days.concat(this.expand_by_day(t));else if(T==2&&"BYDAY"in n&&"BYMONTH"in n){for(var D in this.by_data.BYMONTH)if(this.by_data.BYMONTH.hasOwnProperty(D)){var h=this.by_data.BYMONTH[D],F=u.Time.daysInMonth(h,t);r.year=t,r.month=this.by_data.BYMONTH[D],r.day=1,r.isDate=!0;var j=r.dayOfWeek(),z=r.dayOfYear()-1;r.day=F;var X=r.dayOfWeek();if(this.has_by_data("BYSETPOS")){for(var J=0,ne=[],B=1;B<=F;B++)r.day=B,this.is_day_in_byday(r)&&ne.push(B);for(var K=0;K<ne.length;K++)(this.check_set_position(K+1)||this.check_set_position(K-ne.length))&&this.days.push(z+ne[K])}else for(var m in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(m)){var w=this.by_data.BYDAY[m],k=this.ruleDayOfWeek(w),_=k[0],ve=k[1],ee,Ee=(ve+7-j)%7+1,es=F-(X+7-ve)%7;if(_==0)for(var B=Ee;B<=F;B+=7)this.days.push(z+B);else _>0?(ee=Ee+(_-1)*7,ee<=F&&this.days.push(z+ee)):(ee=es+(_+1)*7,ee>0&&this.days.push(z+ee))}}this.days.sort(function(ts,rs){return ts-rs})}else if(T==2&&"BYDAY"in n&&"BYMONTHDAY"in n){var de=this.expand_by_day(t);for(var Ae in de)if(de.hasOwnProperty(Ae)){var B=de[Ae],He=u.Time.fromDayOfYear(B,t);this.by_data.BYMONTHDAY.indexOf(He.day)>=0&&this.days.push(B)}}else if(T==3&&"BYDAY"in n&&"BYMONTHDAY"in n&&"BYMONTH"in n){var de=this.expand_by_day(t);for(var Ae in de)if(de.hasOwnProperty(Ae)){var B=de[Ae],He=u.Time.fromDayOfYear(B,t);this.by_data.BYMONTH.indexOf(He.month)>=0&&this.by_data.BYMONTHDAY.indexOf(He.day)>=0&&this.days.push(B)}}else if(T==2&&"BYDAY"in n&&"BYWEEKNO"in n){var de=this.expand_by_day(t);for(var Ae in de)if(de.hasOwnProperty(Ae)){var B=de[Ae],He=u.Time.fromDayOfYear(B,t),g=He.weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(g)&&this.days.push(B)}}else T==3&&"BYDAY"in n&&"BYWEEKNO"in n&&"BYMONTHDAY"in n||(T==1&&"BYYEARDAY"in n?this.days=this.days.concat(this.by_data.BYYEARDAY):this.days=[])}return 0},expand_by_day:function(t){var r=[],n=this.last.clone();n.year=t,n.month=1,n.day=1,n.isDate=!0;var s=n.dayOfWeek();n.month=12,n.day=31,n.isDate=!0;var a=n.dayOfWeek(),o=n.dayOfYear();for(var l in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(l)){var c=this.by_data.BYDAY[l],d=this.ruleDayOfWeek(c),h=d[0],f=d[1];if(h==0)for(var p=(f+7-s)%7+1,y=p;y<=o;y+=7)r.push(y);else if(h>0){var g;f>=s?g=f-s+1:g=f-s+8,r.push(g+(h-1)*7)}else{var T;h=-h,f<=a?T=o-a+f:T=o-a+f-7,r.push(T-(h-1)*7)}}return r},is_day_in_byday:function(t){for(var r in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(r)){var n=this.by_data.BYDAY[r],s=this.ruleDayOfWeek(n),a=s[0],o=s[1],l=t.dayOfWeek();if(a==0&&o==l||t.nthWeekDay(o,a)==t.day)return 1}return 0},check_set_position:function(t){if(this.has_by_data("BYSETPOS")){var r=this.by_data.BYSETPOS.indexOf(t);return r!==-1}return!1},sort_byday_rules:function(t){for(var r=0;r<t.length;r++)for(var n=0;n<r;n++){var s=this.ruleDayOfWeek(t[n],this.rule.wkst)[1],a=this.ruleDayOfWeek(t[r],this.rule.wkst)[1];if(s>a){var o=t[r];t[r]=t[n],t[n]=o}}},check_contract_restriction:function(t,r){var n=i._indexMap[t],s=i._expandMap[this.rule.freq][n],a=!1;if(t in this.by_data&&s==i.CONTRACT){var o=this.by_data[t];for(var l in o)if(o.hasOwnProperty(l)&&o[l]==r){a=!0;break}}else a=!0;return a},check_contracting_rules:function(){var t=this.last.dayOfWeek(),r=this.last.weekNumber(this.rule.wkst),n=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",u.Recur.numericDayToIcalDay(t))&&this.check_contract_restriction("BYWEEKNO",r)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",n)},setup_defaults:function(t,r,n){var s=i._indexMap[t],a=i._expandMap[this.rule.freq][s];return a!=i.CONTRACT&&(t in this.by_data||(this.by_data[t]=[n]),this.rule.freq!=r)?this.by_data[t][0]:n},toJSON:function(){var e=Object.create(null);return e.initialized=this.initialized,e.rule=this.rule.toJSON(),e.dtstart=this.dtstart.toJSON(),e.by_data=this.by_data,e.days=this.days,e.last=this.last.toJSON(),e.by_indices=this.by_indices,e.occurrence_number=this.occurrence_number,e}},i._indexMap={BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8},i._expandMap={SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]},i.UNKNOWN=0,i.CONTRACT=1,i.EXPAND=2,i.ILLEGAL=3,i}();u.RecurExpansion=function(){function i(n){return u.helpers.formatClassType(n,u.Time)}function e(n,s){return n.compare(s)}function t(n){return n.hasProperty("rdate")||n.hasProperty("rrule")||n.hasProperty("recurrence-id")}function r(n){this.ruleDates=[],this.exDates=[],this.fromData(n)}return r.prototype={complete:!1,ruleIterators:null,ruleDates:null,exDates:null,ruleDateInc:0,exDateInc:0,exDate:null,ruleDate:null,dtstart:null,last:null,fromData:function(n){var s=u.helpers.formatClassType(n.dtstart,u.Time);if(s)this.dtstart=s;else throw new Error(".dtstart (ICAL.Time) must be given");if(n.component)this._init(n.component);else{if(this.last=i(n.last)||s.clone(),!n.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=n.ruleIterators.map(function(a){return u.helpers.formatClassType(a,u.RecurIterator)}),this.ruleDateInc=n.ruleDateInc,this.exDateInc=n.exDateInc,n.ruleDates&&(this.ruleDates=n.ruleDates.map(i),this.ruleDate=this.ruleDates[this.ruleDateInc]),n.exDates&&(this.exDates=n.exDates.map(i),this.exDate=this.exDates[this.exDateInc]),typeof n.complete!="undefined"&&(this.complete=n.complete)}},next:function(){for(var n,s,a,o,l=500,c=0;;){if(c++>l)throw new Error("max tries have occured, rule may be impossible to forfill.");if(a=this.ruleDate,n=this._nextRecurrenceIter(this.last),!a&&!n){this.complete=!0;break}if((!a||n&&a.compare(n.last)>0)&&(a=n.last.clone(),n.next()),this.ruleDate===a&&this._nextRuleDay(),this.last=a,this.exDate&&(o=this.exDate.compare(this.last),o<0&&this._nextExDay(),o===0)){this._nextExDay();continue}return this.last}},toJSON:function(){function n(a){return a.toJSON()}var s=Object.create(null);return s.ruleIterators=this.ruleIterators.map(n),this.ruleDates&&(s.ruleDates=this.ruleDates.map(n)),this.exDates&&(s.exDates=this.exDates.map(n)),s.ruleDateInc=this.ruleDateInc,s.exDateInc=this.exDateInc,s.last=this.last.toJSON(),s.dtstart=this.dtstart.toJSON(),s.complete=this.complete,s},_extractDates:function(n,s){function a(p){f=u.helpers.binsearchInsert(o,p,e),o.splice(f,0,p)}for(var o=[],l=n.getAllProperties(s),c=l.length,d=0,h,f;d<c;d++)l[d].getValues().forEach(a);return o},_init:function(n){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!t(n)){this.ruleDate=this.last.clone(),this.complete=!0;return}if(n.hasProperty("rdate")&&(this.ruleDates=this._extractDates(n,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=u.helpers.binsearchInsert(this.ruleDates,this.last,e),this.ruleDate=this.ruleDates[this.ruleDateInc]),n.hasProperty("rrule"))for(var s=n.getAllProperties("rrule"),a=0,o=s.length,l,c;a<o;a++)l=s[a].getFirstValue(),c=l.iterator(this.dtstart),this.ruleIterators.push(c),c.next();n.hasProperty("exdate")&&(this.exDates=this._extractDates(n,"exdate"),this.exDateInc=u.helpers.binsearchInsert(this.exDates,this.last,e),this.exDate=this.exDates[this.exDateInc])},_nextExDay:function(){this.exDate=this.exDates[++this.exDateInc]},_nextRuleDay:function(){this.ruleDate=this.ruleDates[++this.ruleDateInc]},_nextRecurrenceIter:function(){var n=this.ruleIterators;if(n.length===0)return null;for(var s=n.length,a,o,l=0,c;l<s;l++){if(a=n[l],o=a.last,a.completed){s--,l!==0&&l--,n.splice(l,1);continue}(!c||c.last.compare(o)>0)&&(c=a)}return c}},r}();u.Event=function(){function i(t,r){t instanceof u.Component||(r=t,t=null),t?this.component=t:this.component=new u.Component("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],r&&r.strictExceptions&&(this.strictExceptions=r.strictExceptions),r&&r.exceptions?r.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach(function(n){n.hasProperty("recurrence-id")&&this.relateException(n)},this)}i.prototype={THISANDFUTURE:"THISANDFUTURE",exceptions:null,strictExceptions:!1,relateException:function(t){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(t instanceof u.Component&&(t=new u.Event(t)),this.strictExceptions&&t.uid!==this.uid)throw new Error("attempted to relate unrelated exception");var r=t.recurrenceId.toString();if(this.exceptions[r]=t,t.modifiesFuture()){var n=[t.recurrenceId.toUnixTime(),r],s=u.helpers.binsearchInsert(this.rangeExceptions,n,e);this.rangeExceptions.splice(s,0,n)}},modifiesFuture:function(){if(!this.component.hasProperty("recurrence-id"))return!1;var t=this.component.getFirstProperty("recurrence-id").getParameter("range");return t===this.THISANDFUTURE},findRangeException:function(t){if(!this.rangeExceptions.length)return null;var r=t.toUnixTime(),n=u.helpers.binsearchInsert(this.rangeExceptions,[r],e);if(n-=1,n<0)return null;var s=this.rangeExceptions[n];return r<s[0]?null:s[1]},getOccurrenceDetails:function(t){var r=t.toString(),n=t.convertToZone(u.Timezone.utcTimezone).toString(),s,a={recurrenceId:t};if(r in this.exceptions)s=a.item=this.exceptions[r],a.startDate=s.startDate,a.endDate=s.endDate,a.item=s;else if(n in this.exceptions)s=this.exceptions[n],a.startDate=s.startDate,a.endDate=s.endDate,a.item=s;else{var o=this.findRangeException(t),l;if(o){var c=this.exceptions[o];a.item=c;var d=this._rangeExceptionCache[o];if(!d){var h=c.recurrenceId.clone(),f=c.startDate.clone();h.zone=f.zone,d=f.subtractDate(h),this._rangeExceptionCache[o]=d}var p=t.clone();p.zone=c.startDate.zone,p.addDuration(d),l=p.clone(),l.addDuration(c.duration),a.startDate=p,a.endDate=l}else l=t.clone(),l.addDuration(this.duration),a.endDate=l,a.startDate=t,a.item=this}return a},iterator:function(t){return new u.RecurExpansion({component:this.component,dtstart:t||this.startDate})},isRecurring:function(){var t=this.component;return t.hasProperty("rrule")||t.hasProperty("rdate")},isRecurrenceException:function(){return this.component.hasProperty("recurrence-id")},getRecurrenceTypes:function(){for(var t=this.component.getAllProperties("rrule"),r=0,n=t.length,s=Object.create(null);r<n;r++){var a=t[r].getFirstValue();s[a.freq]=!0}return s},get uid(){return this._firstProp("uid")},set uid(t){this._setProp("uid",t)},get startDate(){return this._firstProp("dtstart")},set startDate(t){this._setTime("dtstart",t)},get endDate(){var t=this._firstProp("dtend");if(!t){var r=this._firstProp("duration");t=this.startDate.clone(),r?t.addDuration(r):t.isDate&&(t.day+=1)}return t},set endDate(t){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",t)},get duration(){var t=this._firstProp("duration");return t||this.endDate.subtractDateTz(this.startDate)},set duration(t){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",t)},get location(){return this._firstProp("location")},set location(t){return this._setProp("location",t)},get attendees(){return this.component.getAllProperties("attendee")},get summary(){return this._firstProp("summary")},set summary(t){this._setProp("summary",t)},get description(){return this._firstProp("description")},set description(t){this._setProp("description",t)},get color(){return this._firstProp("color")},set color(t){this._setProp("color",t)},get organizer(){return this._firstProp("organizer")},set organizer(t){this._setProp("organizer",t)},get sequence(){return this._firstProp("sequence")},set sequence(t){this._setProp("sequence",t)},get recurrenceId(){return this._firstProp("recurrence-id")},set recurrenceId(t){this._setTime("recurrence-id",t)},_setTime:function(t,r){var n=this.component.getFirstProperty(t);n||(n=new u.Property(t),this.component.addProperty(n)),r.zone===u.Timezone.localTimezone||r.zone===u.Timezone.utcTimezone?n.removeParameter("tzid"):n.setParameter("tzid",r.zone.tzid),n.setValue(r)},_setProp:function(t,r){this.component.updatePropertyWithValue(t,r)},_firstProp:function(t){return this.component.getFirstPropertyValue(t)},toString:function(){return this.component.toString()}};function e(t,r){return t[0]>r[0]?1:r[0]>t[0]?-1:0}return i}();u.ComponentParser=function(){function i(e){typeof e=="undefined"&&(e={});var t;for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}return i.prototype={parseEvent:!0,parseTimezone:!0,oncomplete:function(){},onerror:function(e){},ontimezone:function(e){},onevent:function(e){},process:function(e){typeof e=="string"&&(e=u.parse(e)),e instanceof u.Component||(e=new u.Component(e));for(var t=e.getAllSubcomponents(),r=0,n=t.length,s;r<n;r++)switch(s=t[r],s.name){case"vtimezone":if(this.parseTimezone){var a=s.getFirstPropertyValue("tzid");a&&this.ontimezone(new u.Timezone({tzid:a,component:s}))}break;case"vevent":this.parseEvent&&this.onevent(new u.Event(s));break;default:continue}this.oncomplete()}},i}()});var Ki=pn(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});var W=require("obsidian"),an="YYYY-MM-DD",on="gggg-[W]ww",Ui="YYYY-MM",zi="YYYY-[Q]Q",Ri="YYYY";function zt(i){var t,r;let e=window.app.plugins.getPlugin("periodic-notes");return e&&((r=(t=e.settings)==null?void 0:t[i])==null?void 0:r.enabled)}function Rt(){var i,e,t,r;try{let{internalPlugins:n,plugins:s}=window.app;if(zt("daily")){let{format:c,folder:d,template:h}=((e=(i=s.getPlugin("periodic-notes"))==null?void 0:i.settings)==null?void 0:e.daily)||{};return{format:c||an,folder:(d==null?void 0:d.trim())||"",template:(h==null?void 0:h.trim())||""}}let{folder:a,format:o,template:l}=((r=(t=n.getPluginById("daily-notes"))==null?void 0:t.instance)==null?void 0:r.options)||{};return{format:o||an,folder:(a==null?void 0:a.trim())||"",template:(l==null?void 0:l.trim())||""}}catch(n){console.info("No custom daily note settings found!",n)}}function Vt(){var i,e,t,r,n,s,a;try{let o=window.app.plugins,l=(i=o.getPlugin("calendar"))==null?void 0:i.options,c=(t=(e=o.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.weekly;if(zt("weekly"))return{format:c.format||on,folder:((r=c.folder)==null?void 0:r.trim())||"",template:((n=c.template)==null?void 0:n.trim())||""};let d=l||{};return{format:d.weeklyNoteFormat||on,folder:((s=d.weeklyNoteFolder)==null?void 0:s.trim())||"",template:((a=d.weeklyNoteTemplate)==null?void 0:a.trim())||""}}catch(o){console.info("No custom weekly note settings found!",o)}}function Ht(){var e,t,r,n;let i=window.app.plugins;try{let s=zt("monthly")&&((t=(e=i.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.monthly)||{};return{format:s.format||Ui,folder:((r=s.folder)==null?void 0:r.trim())||"",template:((n=s.template)==null?void 0:n.trim())||""}}catch(s){console.info("No custom monthly note settings found!",s)}}function Wt(){var e,t,r,n;let i=window.app.plugins;try{let s=zt("quarterly")&&((t=(e=i.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.quarterly)||{};return{format:s.format||zi,folder:((r=s.folder)==null?void 0:r.trim())||"",template:((n=s.template)==null?void 0:n.trim())||""}}catch(s){console.info("No custom quarterly note settings found!",s)}}function Bt(){var e,t,r,n;let i=window.app.plugins;try{let s=zt("yearly")&&((t=(e=i.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.yearly)||{};return{format:s.format||Ri,folder:((r=s.folder)==null?void 0:r.trim())||"",template:((n=s.template)==null?void 0:n.trim())||""}}catch(s){console.info("No custom yearly note settings found!",s)}}function Vi(...i){let e=[];for(let r=0,n=i.length;r<n;r++)e=e.concat(i[r].split("/"));let t=[];for(let r=0,n=e.length;r<n;r++){let s=e[r];!s||s==="."||t.push(s)}return e[0]===""&&t.unshift(""),t.join("/")}function Ua(i){let e=i.substring(i.lastIndexOf("/")+1);return e.lastIndexOf(".")!=-1&&(e=e.substring(0,e.lastIndexOf("."))),e}async function za(i){let e=i.replace(/\\/g,"/").split("/");if(e.pop(),e.length){let t=Vi(...e);window.app.vault.getAbstractFileByPath(t)||await window.app.vault.createFolder(t)}}async function $t(i,e){e.endsWith(".md")||(e+=".md");let t=W.normalizePath(Vi(i,e));return await za(t),t}async function at(i){let{metadataCache:e,vault:t}=window.app,r=W.normalizePath(i);if(r==="/")return Promise.resolve(["",null]);try{let n=e.getFirstLinkpathDest(r,""),s=await t.cachedRead(n),a=window.app.foldManager.load(n);return[s,a]}catch(n){return console.error(`Failed to read the daily note template '${r}'`,n),new W.Notice("Failed to read the daily note template"),["",null]}}function Te(i,e="day"){let t=i.clone().startOf(e).format();return`${e}-${t}`}function Hi(i){return i.replace(/\[[^\]]*\]/g,"")}function Ra(i,e){if(e==="week"){let t=Hi(i);return/w{1,2}/i.test(t)&&(/M{1,4}/.test(t)||/D{1,4}/.test(t))}return!1}function ot(i,e){return Wi(i.basename,e)}function Va(i,e){return Wi(Ua(i),e)}function Wi(i,e){let r={day:Rt,week:Vt,month:Ht,quarter:Wt,year:Bt}[e]().format.split("/").pop(),n=window.moment(i,r,!0);if(!n.isValid())return null;if(Ra(r,e)&&e==="week"){let s=Hi(r);if(/w{1,2}/i.test(s))return window.moment(i,r.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return n}var ln=class extends Error{};async function Bi(i){let e=window.app,{vault:t}=e,r=window.moment,{template:n,format:s,folder:a}=Rt(),[o,l]=await at(n),c=i.format(s),d=await $t(a,c);try{let h=await t.create(d,o.replace(/{{\s*date\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,r().format("HH:mm")).replace(/{{\s*title\s*}}/gi,c).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,p,y,g,T,v)=>{let D=r(),O=i.clone().set({hour:D.get("hour"),minute:D.get("minute"),second:D.get("second")});return y&&O.add(parseInt(g,10),T),v?O.format(v.substring(1).trim()):O.format(s)}).replace(/{{\s*yesterday\s*}}/gi,i.clone().subtract(1,"day").format(s)).replace(/{{\s*tomorrow\s*}}/gi,i.clone().add(1,"d").format(s)));return e.foldManager.save(h,l),h}catch(h){console.error(`Failed to create file: '${d}'`,h),new W.Notice("Unable to create new file.")}}function Ha(i,e){var t;return(t=e[Te(i,"day")])!=null?t:null}function Wa(){let{vault:i}=window.app,{folder:e}=Rt(),t=i.getAbstractFileByPath(W.normalizePath(e));if(!t)throw new ln("Failed to find daily notes folder");let r={};return W.Vault.recurseChildren(t,n=>{if(n instanceof W.TFile){let s=ot(n,"day");if(s){let a=Te(s,"day");r[a]=n}}}),r}var un=class extends Error{};function Ba(){let{moment:i}=window,e=i.localeData()._week.dow,t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;e;)t.push(t.shift()),e--;return t}function $a(i){return Ba().indexOf(i.toLowerCase())}async function $i(i){let{vault:e}=window.app,{template:t,format:r,folder:n}=Vt(),[s,a]=await at(t),o=i.format(r),l=await $t(n,o);try{let c=await e.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,h,f,p,y,g)=>{let T=window.moment(),v=i.clone().set({hour:T.get("hour"),minute:T.get("minute"),second:T.get("second")});return f&&v.add(parseInt(p,10),y),g?v.format(g.substring(1).trim()):v.format(r)}).replace(/{{\s*title\s*}}/gi,o).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(d,h,f)=>{let p=$a(h);return i.weekday(p).format(f.trim())}));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new W.Notice("Unable to create new file.")}}function Za(i,e){var t;return(t=e[Te(i,"week")])!=null?t:null}function ja(){let i={};if(!ji())return i;let{vault:e}=window.app,{folder:t}=Vt(),r=e.getAbstractFileByPath(W.normalizePath(t));if(!r)throw new un("Failed to find weekly notes folder");return W.Vault.recurseChildren(r,n=>{if(n instanceof W.TFile){let s=ot(n,"week");if(s){let a=Te(s,"week");i[a]=n}}}),i}var cn=class extends Error{};async function Zi(i){let{vault:e}=window.app,{template:t,format:r,folder:n}=Ht(),[s,a]=await at(t),o=i.format(r),l=await $t(n,o);try{let c=await e.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,h,f,p,y,g)=>{let T=window.moment(),v=i.clone().set({hour:T.get("hour"),minute:T.get("minute"),second:T.get("second")});return f&&v.add(parseInt(p,10),y),g?v.format(g.substring(1).trim()):v.format(r)}).replace(/{{\s*date\s*}}/gi,o).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,o));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new W.Notice("Unable to create new file.")}}function qa(i,e){var t;return(t=e[Te(i,"month")])!=null?t:null}function Ja(){let i={};if(!qi())return i;let{vault:e}=window.app,{folder:t}=Ht(),r=e.getAbstractFileByPath(W.normalizePath(t));if(!r)throw new cn("Failed to find monthly notes folder");return W.Vault.recurseChildren(r,n=>{if(n instanceof W.TFile){let s=ot(n,"month");if(s){let a=Te(s,"month");i[a]=n}}}),i}var dn=class extends Error{};async function Ga(i){let{vault:e}=window.app,{template:t,format:r,folder:n}=Wt(),[s,a]=await at(t),o=i.format(r),l=await $t(n,o);try{let c=await e.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,h,f,p,y,g)=>{let T=window.moment(),v=i.clone().set({hour:T.get("hour"),minute:T.get("minute"),second:T.get("second")});return f&&v.add(parseInt(p,10),y),g?v.format(g.substring(1).trim()):v.format(r)}).replace(/{{\s*date\s*}}/gi,o).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,o));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new W.Notice("Unable to create new file.")}}function Ka(i,e){var t;return(t=e[Te(i,"quarter")])!=null?t:null}function Qa(){let i={};if(!Ji())return i;let{vault:e}=window.app,{folder:t}=Wt(),r=e.getAbstractFileByPath(W.normalizePath(t));if(!r)throw new dn("Failed to find quarterly notes folder");return W.Vault.recurseChildren(r,n=>{if(n instanceof W.TFile){let s=ot(n,"quarter");if(s){let a=Te(s,"quarter");i[a]=n}}}),i}var hn=class extends Error{};async function Xa(i){let{vault:e}=window.app,{template:t,format:r,folder:n}=Bt(),[s,a]=await at(t),o=i.format(r),l=await $t(n,o);try{let c=await e.create(l,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,h,f,p,y,g)=>{let T=window.moment(),v=i.clone().set({hour:T.get("hour"),minute:T.get("minute"),second:T.get("second")});return f&&v.add(parseInt(p,10),y),g?v.format(g.substring(1).trim()):v.format(r)}).replace(/{{\s*date\s*}}/gi,o).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,o));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${l}'`,c),new W.Notice("Unable to create new file.")}}function eo(i,e){var t;return(t=e[Te(i,"year")])!=null?t:null}function to(){let i={};if(!Gi())return i;let{vault:e}=window.app,{folder:t}=Bt(),r=e.getAbstractFileByPath(W.normalizePath(t));if(!r)throw new hn("Failed to find yearly notes folder");return W.Vault.recurseChildren(r,n=>{if(n instanceof W.TFile){let s=ot(n,"year");if(s){let a=Te(s,"year");i[a]=n}}}),i}function ro(){var r,n;let{app:i}=window,e=i.internalPlugins.plugins["daily-notes"];if(e&&e.enabled)return!0;let t=i.plugins.getPlugin("periodic-notes");return t&&((n=(r=t.settings)==null?void 0:r.daily)==null?void 0:n.enabled)}function ji(){var t,r;let{app:i}=window;if(i.plugins.getPlugin("calendar"))return!0;let e=i.plugins.getPlugin("periodic-notes");return e&&((r=(t=e.settings)==null?void 0:t.weekly)==null?void 0:r.enabled)}function qi(){var t,r;let{app:i}=window,e=i.plugins.getPlugin("periodic-notes");return e&&((r=(t=e.settings)==null?void 0:t.monthly)==null?void 0:r.enabled)}function Ji(){var t,r;let{app:i}=window,e=i.plugins.getPlugin("periodic-notes");return e&&((r=(t=e.settings)==null?void 0:t.quarterly)==null?void 0:r.enabled)}function Gi(){var t,r;let{app:i}=window,e=i.plugins.getPlugin("periodic-notes");return e&&((r=(t=e.settings)==null?void 0:t.yearly)==null?void 0:r.enabled)}function no(i){let e={day:Rt,week:Vt,month:Ht,quarter:Wt,year:Bt}[i];return e()}function io(i,e){return{day:Bi,month:Zi,week:$i}[i](e)}x.DEFAULT_DAILY_NOTE_FORMAT=an;x.DEFAULT_MONTHLY_NOTE_FORMAT=Ui;x.DEFAULT_QUARTERLY_NOTE_FORMAT=zi;x.DEFAULT_WEEKLY_NOTE_FORMAT=on;x.DEFAULT_YEARLY_NOTE_FORMAT=Ri;x.appHasDailyNotesPluginLoaded=ro;x.appHasMonthlyNotesPluginLoaded=qi;x.appHasQuarterlyNotesPluginLoaded=Ji;x.appHasWeeklyNotesPluginLoaded=ji;x.appHasYearlyNotesPluginLoaded=Gi;x.createDailyNote=Bi;x.createMonthlyNote=Zi;x.createPeriodicNote=io;x.createQuarterlyNote=Ga;x.createWeeklyNote=$i;x.createYearlyNote=Xa;x.getAllDailyNotes=Wa;x.getAllMonthlyNotes=Ja;x.getAllQuarterlyNotes=Qa;x.getAllWeeklyNotes=ja;x.getAllYearlyNotes=to;x.getDailyNote=Ha;x.getDailyNoteSettings=Rt;x.getDateFromFile=ot;x.getDateFromPath=Va;x.getDateUID=Te;x.getMonthlyNote=qa;x.getMonthlyNoteSettings=Ht;x.getPeriodicNoteSettings=no;x.getQuarterlyNote=Ka;x.getQuarterlyNoteSettings=Wt;x.getTemplateInfo=at;x.getWeeklyNote=Za;x.getWeeklyNoteSettings=Vt;x.getYearlyNote=eo;x.getYearlyNoteSettings=Bt});var oo={};ls(oo,{default:()=>dr});module.exports=us(oo);var Xi=require("obsidian");var q=require("obsidian"),ze=hr(mr());var yn=require("obsidian");function cs(i){return i?i.startsWith("http://")||i.startsWith("https://")?"http_url":i.startsWith("file://")?"file_url":i.length>=3&&i[1]===":"&&(i[2]==="\\"||i[2]==="/")||i.startsWith("/")?"absolute_path":"vault_relative":"vault_relative"}function ds(i,e){switch(e){case"file_url":let t=decodeURIComponent(i.replace(/^file:\/\/\/?/,""));return!t.startsWith("/")&&!t.match(/^[A-Za-z]:/)&&(t="/"+t),t;case"vault_relative":return(0,yn.normalizePath)(i);case"absolute_path":return i;case"http_url":return i;default:return i}}function Tn(i){let e=cs(i),t=ds(i,e);return{type:e,originalPath:i,normalizedPath:t}}function vn(i){return i.type==="file_url"||i.type==="vault_relative"||i.type==="absolute_path"}function En(i){return i.type==="http_url"}var _e=class extends Error{},jt=class extends _e{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}},qt=class extends _e{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}},Jt=class extends _e{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}},he=class extends _e{},We=class extends _e{constructor(e){super(`Invalid unit ${e}`)}},$=class extends _e{},fe=class extends _e{constructor(){super("Zone is an abstract class")}};var E="numeric",me="short",ie="long",be={year:E,month:E,day:E},lt={year:E,month:me,day:E},pr={year:E,month:me,day:E,weekday:me},ut={year:E,month:ie,day:E},ct={year:E,month:ie,day:E,weekday:ie},dt={hour:E,minute:E},ht={hour:E,minute:E,second:E},ft={hour:E,minute:E,second:E,timeZoneName:me},mt={hour:E,minute:E,second:E,timeZoneName:ie},pt={hour:E,minute:E,hourCycle:"h23"},gt={hour:E,minute:E,second:E,hourCycle:"h23"},yt={hour:E,minute:E,second:E,hourCycle:"h23",timeZoneName:me},Tt={hour:E,minute:E,second:E,hourCycle:"h23",timeZoneName:ie},vt={year:E,month:E,day:E,hour:E,minute:E},Et={year:E,month:E,day:E,hour:E,minute:E,second:E},Dt={year:E,month:me,day:E,hour:E,minute:E},wt={year:E,month:me,day:E,hour:E,minute:E,second:E},gr={year:E,month:me,day:E,weekday:me,hour:E,minute:E},St={year:E,month:ie,day:E,hour:E,minute:E,timeZoneName:me},_t={year:E,month:ie,day:E,hour:E,minute:E,second:E,timeZoneName:me},Ct={year:E,month:ie,day:E,weekday:ie,hour:E,minute:E,timeZoneName:ie},Ot={year:E,month:ie,day:E,weekday:ie,hour:E,minute:E,second:E,timeZoneName:ie};var te=class{get type(){throw new fe}get name(){throw new fe}get ianaName(){return this.name}get isUniversal(){throw new fe}offsetName(e,t){throw new fe}formatOffset(e,t){throw new fe}offset(e){throw new fe}equals(e){throw new fe}get isValid(){throw new fe}};var yr=null,De=class extends te{static get instance(){return yr===null&&(yr=new De),yr}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return Kt(e,t,r)}formatOffset(e,t){return Ne(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}};var vr=new Map;function hs(i){let e=vr.get(i);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:i,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),vr.set(i,e)),e}var fs={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function ms(i,e){let t=i.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,n,s,a,o,l,c,d]=r;return[a,n,s,o,l,c,d]}function ps(i,e){let t=i.formatToParts(e),r=[];for(let n=0;n<t.length;n++){let{type:s,value:a}=t[n],o=fs[s];s==="era"?r[o]=a:A(o)||(r[o]=parseInt(a,10))}return r}var Tr=new Map,G=class extends te{static create(e){let t=Tr.get(e);return t===void 0&&Tr.set(e,t=new G(e)),t}static resetCache(){Tr.clear(),vr.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(t){return!1}}constructor(e){super(),this.zoneName=e,this.valid=G.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return Kt(e,t,r,this.name)}formatOffset(e,t){return Ne(this.offset(e),t)}offset(e){if(!this.valid)return NaN;let t=new Date(e);if(isNaN(t))return NaN;let r=hs(this.name),[n,s,a,o,l,c,d]=r.formatToParts?ps(r,t):ms(r,t);o==="BC"&&(n=-Math.abs(n)+1);let f=Be({year:n,month:s,day:a,hour:l===24?0:l,minute:c,second:d,millisecond:0}),p=+t,y=p%1e3;return p-=y>=0?y:1e3+y,(f-p)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}};var Dn={};function gs(i,e={}){let t=JSON.stringify([i,e]),r=Dn[t];return r||(r=new Intl.ListFormat(i,e),Dn[t]=r),r}var Er=new Map;function Dr(i,e={}){let t=JSON.stringify([i,e]),r=Er.get(t);return r===void 0&&(r=new Intl.DateTimeFormat(i,e),Er.set(t,r)),r}var wr=new Map;function ys(i,e={}){let t=JSON.stringify([i,e]),r=wr.get(t);return r===void 0&&(r=new Intl.NumberFormat(i,e),wr.set(t,r)),r}var Sr=new Map;function Ts(i,e={}){let{base:t,...r}=e,n=JSON.stringify([i,r]),s=Sr.get(n);return s===void 0&&(s=new Intl.RelativeTimeFormat(i,e),Sr.set(n,s)),s}var At=null;function vs(){return At||(At=new Intl.DateTimeFormat().resolvedOptions().locale,At)}var _r=new Map;function wn(i){let e=_r.get(i);return e===void 0&&(e=new Intl.DateTimeFormat(i).resolvedOptions(),_r.set(i,e)),e}var Cr=new Map;function Es(i){let e=Cr.get(i);if(!e){let t=new Intl.Locale(i);e="getWeekInfo"in t?t.getWeekInfo():t.weekInfo,"minimalDays"in e||(e={...Sn,...e}),Cr.set(i,e)}return e}function Ds(i){let e=i.indexOf("-x-");e!==-1&&(i=i.substring(0,e));let t=i.indexOf("-u-");if(t===-1)return[i];{let r,n;try{r=Dr(i).resolvedOptions(),n=i}catch(o){let l=i.substring(0,t);r=Dr(l).resolvedOptions(),n=l}let{numberingSystem:s,calendar:a}=r;return[n,s,a]}}function ws(i,e,t){return(t||e)&&(i.includes("-u-")||(i+="-u"),t&&(i+=`-ca-${t}`),e&&(i+=`-nu-${e}`)),i}function Ss(i){let e=[];for(let t=1;t<=12;t++){let r=C.utc(2009,t,1);e.push(i(r))}return e}function _s(i){let e=[];for(let t=1;t<=7;t++){let r=C.utc(2016,11,13+t);e.push(i(r))}return e}function Qt(i,e,t,r){let n=i.listingMode();return n==="error"?null:n==="en"?t(e):r(e)}function Cs(i){return i.numberingSystem&&i.numberingSystem!=="latn"?!1:i.numberingSystem==="latn"||!i.locale||i.locale.startsWith("en")||wn(i.locale).numberingSystem==="latn"}var Or=class{constructor(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;let{padTo:n,floor:s,...a}=r;if(!t||Object.keys(a).length>0){let o={useGrouping:!1,...r};r.padTo>0&&(o.minimumIntegerDigits=r.padTo),this.inf=ys(e,o)}}format(e){if(this.inf){let t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{let t=this.floor?Math.floor(e):$e(e,3);return R(t,this.padTo)}}},Ar=class{constructor(e,t,r){this.opts=r,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){let a=-1*(e.offset/60),o=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&G.create(o).valid?(n=o,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);let s={...this.opts};s.timeZone=s.timeZone||n,this.dtf=Dr(t,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){let r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:r}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}},br=class{constructor(e,t,r){this.opts={style:"long",...r},!t&&Xt()&&(this.rtf=Ts(e,r))}format(e,t){return this.rtf?this.rtf.format(e,t):_n(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}},Sn={firstDay:1,minimalDays:4,weekend:[6,7]},L=class{static fromOpts(e){return L.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,t,r,n,s=!1){let a=e||Y.defaultLocale,o=a||(s?"en-US":vs()),l=t||Y.defaultNumberingSystem,c=r||Y.defaultOutputCalendar,d=bt(n)||Y.defaultWeekSettings;return new L(o,l,c,d,a)}static resetCache(){At=null,Er.clear(),wr.clear(),Sr.clear(),_r.clear(),Cr.clear()}static fromObject({locale:e,numberingSystem:t,outputCalendar:r,weekSettings:n}={}){return L.create(e,t,r,n)}constructor(e,t,r,n,s){let[a,o,l]=Ds(e);this.locale=a,this.numberingSystem=t||o||null,this.outputCalendar=r||l||null,this.weekSettings=n,this.intl=ws(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Cs(this)),this.fastNumbersCached}listingMode(){let e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:L.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,bt(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return Qt(this,e,Nr,()=>{let r=t?{month:e,day:"numeric"}:{month:e},n=t?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=Ss(s=>this.extract(s,r,"month"))),this.monthsCache[n][e]})}weekdays(e,t=!1){return Qt(this,e,Mr,()=>{let r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=t?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=_s(s=>this.extract(s,r,"weekday"))),this.weekdaysCache[n][e]})}meridiems(){return Qt(this,void 0,()=>Ir,()=>{if(!this.meridiemCache){let e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[C.utc(2016,11,13,9),C.utc(2016,11,13,19)].map(t=>this.extract(t,e,"dayperiod"))}return this.meridiemCache})}eras(e){return Qt(this,e,xr,()=>{let t={era:e};return this.eraCache[e]||(this.eraCache[e]=[C.utc(-40,1,1),C.utc(2017,1,1)].map(r=>this.extract(r,t,"era"))),this.eraCache[e]})}extract(e,t,r){let n=this.dtFormatter(e,t),s=n.formatToParts(),a=s.find(o=>o.type.toLowerCase()===r);return a?a.value:null}numberFormatter(e={}){return new Or(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new Ar(e,this.intl,t)}relFormatter(e={}){return new br(this.intl,this.isEnglish(),e)}listFormatter(e={}){return gs(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||wn(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:er()?Es(this.locale):Sn}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}};var kr=null,V=class extends te{static get utcInstance(){return kr===null&&(kr=new V(0)),kr}static instance(e){return e===0?V.utcInstance:new V(e)}static parseSpecifier(e){if(e){let t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new V(ke(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Ne(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Ne(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return Ne(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}};var Ze=class extends te{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function pe(i,e){let t;if(A(i)||i===null)return e;if(i instanceof te)return i;if(Cn(i)){let r=i.toLowerCase();return r==="default"?e:r==="local"||r==="system"?De.instance:r==="utc"||r==="gmt"?V.utcInstance:V.parseSpecifier(r)||G.create(i)}else return ge(i)?V.instance(i):typeof i=="object"&&"offset"in i&&typeof i.offset=="function"?i:new Ze(i)}var Yr={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},On={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Os=Yr.hanidec.replace(/[\[|\]]/g,"").split("");function An(i){let e=parseInt(i,10);if(isNaN(e)){e="";for(let t=0;t<i.length;t++){let r=i.charCodeAt(t);if(i[t].search(Yr.hanidec)!==-1)e+=Os.indexOf(i[t]);else for(let n in On){let[s,a]=On[n];r>=s&&r<=a&&(e+=r-s)}}return parseInt(e,10)}else return e}var Fr=new Map;function bn(){Fr.clear()}function oe({numberingSystem:i},e=""){let t=i||"latn",r=Fr.get(t);r===void 0&&(r=new Map,Fr.set(t,r));let n=r.get(e);return n===void 0&&(n=new RegExp(`${Yr[t]}${e}`),r.set(e,n)),n}var Nn=()=>Date.now(),Mn="system",In=null,xn=null,Ln=null,kn=60,Fn,Yn=null,Y=class{static get now(){return Nn}static set now(e){Nn=e}static set defaultZone(e){Mn=e}static get defaultZone(){return pe(Mn,De.instance)}static get defaultLocale(){return In}static set defaultLocale(e){In=e}static get defaultNumberingSystem(){return xn}static set defaultNumberingSystem(e){xn=e}static get defaultOutputCalendar(){return Ln}static set defaultOutputCalendar(e){Ln=e}static get defaultWeekSettings(){return Yn}static set defaultWeekSettings(e){Yn=bt(e)}static get twoDigitCutoffYear(){return kn}static set twoDigitCutoffYear(e){kn=e%100}static get throwOnInvalid(){return Fn}static set throwOnInvalid(e){Fn=e}static resetCaches(){L.resetCache(),G.resetCache(),C.resetCache(),bn()}};var Q=class{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}};var Pn=[0,31,59,90,120,151,181,212,243,273,304,334],Un=[0,31,60,91,121,152,182,213,244,274,305,335];function le(i,e){return new Q("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${i}, which is invalid`)}function tr(i,e,t){let r=new Date(Date.UTC(i,e-1,t));i<100&&i>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);let n=r.getUTCDay();return n===0?7:n}function zn(i,e,t){return t+(Ye(i)?Un:Pn)[e-1]}function Rn(i,e){let t=Ye(i)?Un:Pn,r=t.findIndex(s=>s<e),n=e-t[r];return{month:r+1,day:n}}function rr(i,e){return(i-e+7)%7+1}function Nt(i,e=4,t=1){let{year:r,month:n,day:s}=i,a=zn(r,n,s),o=rr(tr(r,n,s),t),l=Math.floor((a-o+14-e)/7),c;return l<1?(c=r-1,l=Fe(c,e,t)):l>Fe(r,e,t)?(c=r+1,l=1):c=r,{weekYear:c,weekNumber:l,weekday:o,...It(i)}}function Pr(i,e=4,t=1){let{weekYear:r,weekNumber:n,weekday:s}=i,a=rr(tr(r,1,e),t),o=Me(r),l=n*7+s-a-7+e,c;l<1?(c=r-1,l+=Me(c)):l>o?(c=r+1,l-=Me(r)):c=r;let{month:d,day:h}=Rn(c,l);return{year:c,month:d,day:h,...It(i)}}function nr(i){let{year:e,month:t,day:r}=i,n=zn(e,t,r);return{year:e,ordinal:n,...It(i)}}function Ur(i){let{year:e,ordinal:t}=i,{month:r,day:n}=Rn(e,t);return{year:e,month:r,day:n,...It(i)}}function zr(i,e){if(!A(i.localWeekday)||!A(i.localWeekNumber)||!A(i.localWeekYear)){if(!A(i.weekday)||!A(i.weekNumber)||!A(i.weekYear))throw new he("Cannot mix locale-based week fields with ISO-based week fields");return A(i.localWeekday)||(i.weekday=i.localWeekday),A(i.localWeekNumber)||(i.weekNumber=i.localWeekNumber),A(i.localWeekYear)||(i.weekYear=i.localWeekYear),delete i.localWeekday,delete i.localWeekNumber,delete i.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Vn(i,e=4,t=1){let r=Mt(i.weekYear),n=se(i.weekNumber,1,Fe(i.weekYear,e,t)),s=se(i.weekday,1,7);return r?n?s?!1:le("weekday",i.weekday):le("week",i.weekNumber):le("weekYear",i.weekYear)}function Hn(i){let e=Mt(i.year),t=se(i.ordinal,1,Me(i.year));return e?t?!1:le("ordinal",i.ordinal):le("year",i.year)}function Rr(i){let e=Mt(i.year),t=se(i.month,1,12),r=se(i.day,1,je(i.year,i.month));return e?t?r?!1:le("day",i.day):le("month",i.month):le("year",i.year)}function Vr(i){let{hour:e,minute:t,second:r,millisecond:n}=i,s=se(e,0,23)||e===24&&t===0&&r===0&&n===0,a=se(t,0,59),o=se(r,0,59),l=se(n,0,999);return s?a?o?l?!1:le("millisecond",n):le("second",r):le("minute",t):le("hour",e)}function A(i){return typeof i=="undefined"}function ge(i){return typeof i=="number"}function Mt(i){return typeof i=="number"&&i%1===0}function Cn(i){return typeof i=="string"}function Bn(i){return Object.prototype.toString.call(i)==="[object Date]"}function Xt(){try{return typeof Intl!="undefined"&&!!Intl.RelativeTimeFormat}catch(i){return!1}}function er(){try{return typeof Intl!="undefined"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch(i){return!1}}function $n(i){return Array.isArray(i)?i:[i]}function Hr(i,e,t){if(i.length!==0)return i.reduce((r,n)=>{let s=[e(n),n];return r&&t(r[0],s[0])===r[0]?r:s},null)[1]}function Zn(i,e){return e.reduce((t,r)=>(t[r]=i[r],t),{})}function Ie(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function bt(i){if(i==null)return null;if(typeof i!="object")throw new $("Week settings must be an object");if(!se(i.firstDay,1,7)||!se(i.minimalDays,1,7)||!Array.isArray(i.weekend)||i.weekend.some(e=>!se(e,1,7)))throw new $("Invalid week settings");return{firstDay:i.firstDay,minimalDays:i.minimalDays,weekend:Array.from(i.weekend)}}function se(i,e,t){return Mt(i)&&i>=e&&i<=t}function As(i,e){return i-e*Math.floor(i/e)}function R(i,e=2){let t=i<0,r;return t?r="-"+(""+-i).padStart(e,"0"):r=(""+i).padStart(e,"0"),r}function Ce(i){if(!(A(i)||i===null||i===""))return parseInt(i,10)}function xe(i){if(!(A(i)||i===null||i===""))return parseFloat(i)}function xt(i){if(!(A(i)||i===null||i==="")){let e=parseFloat("0."+i)*1e3;return Math.floor(e)}}function $e(i,e,t=!1){let r=10**e;return(t?Math.trunc:Math.round)(i*r)/r}function Ye(i){return i%4===0&&(i%100!==0||i%400===0)}function Me(i){return Ye(i)?366:365}function je(i,e){let t=As(e-1,12)+1,r=i+(e-t)/12;return t===2?Ye(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function Be(i){let e=Date.UTC(i.year,i.month-1,i.day,i.hour,i.minute,i.second,i.millisecond);return i.year<100&&i.year>=0&&(e=new Date(e),e.setUTCFullYear(i.year,i.month-1,i.day)),+e}function Wn(i,e,t){return-rr(tr(i,1,e),t)+e-1}function Fe(i,e=4,t=1){let r=Wn(i,e,t),n=Wn(i+1,e,t);return(Me(i)-r+n)/7}function Lt(i){return i>99?i:i>Y.twoDigitCutoffYear?1900+i:2e3+i}function Kt(i,e,t,r=null){let n=new Date(i),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);let a={timeZoneName:e,...s},o=new Intl.DateTimeFormat(t,a).formatToParts(n).find(l=>l.type.toLowerCase()==="timezonename");return o?o.value:null}function ke(i,e){let t=parseInt(i,10);Number.isNaN(t)&&(t=0);let r=parseInt(e,10)||0,n=t<0||Object.is(t,-0)?-r:r;return t*60+n}function Wr(i){let e=Number(i);if(typeof i=="boolean"||i===""||Number.isNaN(e))throw new $(`Invalid unit value ${i}`);return e}function qe(i,e){let t={};for(let r in i)if(Ie(i,r)){let n=i[r];if(n==null)continue;t[e(r)]=Wr(n)}return t}function Ne(i,e){let t=Math.trunc(Math.abs(i/60)),r=Math.trunc(Math.abs(i%60)),n=i>=0?"+":"-";switch(e){case"short":return`${n}${R(t,2)}:${R(r,2)}`;case"narrow":return`${n}${t}${r>0?`:${r}`:""}`;case"techie":return`${n}${R(t,2)}${R(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function It(i){return Zn(i,["hour","minute","second","millisecond"])}var bs=["January","February","March","April","May","June","July","August","September","October","November","December"],Br=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ns=["J","F","M","A","M","J","J","A","S","O","N","D"];function Nr(i){switch(i){case"narrow":return[...Ns];case"short":return[...Br];case"long":return[...bs];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var $r=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Zr=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Ms=["M","T","W","T","F","S","S"];function Mr(i){switch(i){case"narrow":return[...Ms];case"short":return[...Zr];case"long":return[...$r];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var Ir=["AM","PM"],Is=["Before Christ","Anno Domini"],xs=["BC","AD"],Ls=["B","A"];function xr(i){switch(i){case"narrow":return[...Ls];case"short":return[...xs];case"long":return[...Is];default:return null}}function jn(i){return Ir[i.hour<12?0:1]}function qn(i,e){return Mr(e)[i.weekday-1]}function Jn(i,e){return Nr(e)[i.month-1]}function Gn(i,e){return xr(e)[i.year<0?0:1]}function _n(i,e,t="always",r=!1){let n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(i)===-1;if(t==="auto"&&s){let h=i==="days";switch(e){case 1:return h?"tomorrow":`next ${n[i][0]}`;case-1:return h?"yesterday":`last ${n[i][0]}`;case 0:return h?"today":`this ${n[i][0]}`;default:}}let a=Object.is(e,-0)||e<0,o=Math.abs(e),l=o===1,c=n[i],d=r?l?c[1]:c[2]||c[1]:l?n[i][0]:i;return a?`${o} ${d} ago`:`in ${o} ${d}`}function Kn(i,e){let t="";for(let r of i)r.literal?t+=r.val:t+=e(r.val);return t}var ks={D:be,DD:lt,DDD:ut,DDDD:ct,t:dt,tt:ht,ttt:ft,tttt:mt,T:pt,TT:gt,TTT:yt,TTTT:Tt,f:vt,ff:Dt,fff:St,ffff:Ct,F:Et,FF:wt,FFF:_t,FFFF:Ot},H=class{static create(e,t={}){return new H(e,t)}static parseFormat(e){let t=null,r="",n=!1,s=[];for(let a=0;a<e.length;a++){let o=e.charAt(a);o==="'"?(r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),t=null,r="",n=!n):n||o===t?r+=o:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=o,t=o)}return r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(e){return ks[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return R(e,t);let r={...this.opts};return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,t){let r=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(p,y)=>this.loc.extract(e,p,y),a=p=>e.isOffsetFixed&&e.offset===0&&p.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,p.format):"",o=()=>r?jn(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(p,y)=>r?Jn(e,p):s(y?{month:p}:{month:p,day:"numeric"},"month"),c=(p,y)=>r?qn(e,p):s(y?{weekday:p}:{weekday:p,month:"long",day:"numeric"},"weekday"),d=p=>{let y=H.macroTokenToFormatOpts(p);return y?this.formatWithSystemDefault(e,y):p},h=p=>r?Gn(e,p):s({era:p},"era"),f=p=>{switch(p){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return a({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return a({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return n?s({day:"numeric"},"day"):this.num(e.day);case"dd":return n?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return n?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return n?s({month:"numeric"},"month"):this.num(e.month);case"MM":return n?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return n?s({year:"numeric"},"year"):this.num(e.year);case"yy":return n?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return d(p)}};return Kn(H.parseFormat(t),f)}formatDurationFromString(e,t){let r=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=l=>c=>{let d=r(c);return d?this.num(l.get(d),c.length):c},s=H.parseFormat(t),a=s.reduce((l,{literal:c,val:d})=>c?l:l.concat(d),[]),o=e.shiftTo(...a.map(r).filter(l=>l));return Kn(s,n(o))}};var Xn=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Ge(...i){let e=i.reduce((t,r)=>t+r.source,"");return RegExp(`^${e}$`)}function Ke(...i){return e=>i.reduce(([t,r,n],s)=>{let[a,o,l]=s(e,n);return[{...t,...a},o||r,l]},[{},null,1]).slice(0,2)}function Qe(i,...e){if(i==null)return[null,null];for(let[t,r]of e){let n=t.exec(i);if(n)return r(n)}return[null,null]}function ei(...i){return(e,t)=>{let r={},n;for(n=0;n<i.length;n++)r[i[n]]=Ce(e[t+n]);return[r,null,t+n]}}var ti=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Fs=`(?:${ti.source}?(?:\\[(${Xn.source})\\])?)?`,jr=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,ri=RegExp(`${jr.source}${Fs}`),qr=RegExp(`(?:T${ri.source})?`),Ys=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Ps=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Us=/(\d{4})-?(\d{3})/,zs=ei("weekYear","weekNumber","weekDay"),Rs=ei("year","ordinal"),Vs=/(\d{4})-(\d\d)-(\d\d)/,ni=RegExp(`${jr.source} ?(?:${ti.source}|(${Xn.source}))?`),Hs=RegExp(`(?: ${ni.source})?`);function Je(i,e,t){let r=i[e];return A(r)?t:Ce(r)}function Ws(i,e){return[{year:Je(i,e),month:Je(i,e+1,1),day:Je(i,e+2,1)},null,e+3]}function Xe(i,e){return[{hours:Je(i,e,0),minutes:Je(i,e+1,0),seconds:Je(i,e+2,0),milliseconds:xt(i[e+3])},null,e+4]}function kt(i,e){let t=!i[e]&&!i[e+1],r=ke(i[e+1],i[e+2]),n=t?null:V.instance(r);return[{},n,e+3]}function Ft(i,e){let t=i[e]?G.create(i[e]):null;return[{},t,e+1]}var Bs=RegExp(`^T?${jr.source}$`),$s=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Zs(i){let[e,t,r,n,s,a,o,l,c]=i,d=e[0]==="-",h=l&&l[0]==="-",f=(p,y=!1)=>p!==void 0&&(y||p&&d)?-p:p;return[{years:f(xe(t)),months:f(xe(r)),weeks:f(xe(n)),days:f(xe(s)),hours:f(xe(a)),minutes:f(xe(o)),seconds:f(xe(l),l==="-0"),milliseconds:f(xt(c),h)}]}var js={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Jr(i,e,t,r,n,s,a){let o={year:e.length===2?Lt(Ce(e)):Ce(e),month:Br.indexOf(t)+1,day:Ce(r),hour:Ce(n),minute:Ce(s)};return a&&(o.second=Ce(a)),i&&(o.weekday=i.length>3?$r.indexOf(i)+1:Zr.indexOf(i)+1),o}var qs=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Js(i){let[,e,t,r,n,s,a,o,l,c,d,h]=i,f=Jr(e,n,r,t,s,a,o),p;return l?p=js[l]:c?p=0:p=ke(d,h),[f,new V(p)]}function Gs(i){return i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var Ks=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Qs=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Xs=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Qn(i){let[,e,t,r,n,s,a,o]=i;return[Jr(e,n,r,t,s,a,o),V.utcInstance]}function ea(i){let[,e,t,r,n,s,a,o]=i;return[Jr(e,o,t,r,n,s,a),V.utcInstance]}var ta=Ge(Ys,qr),ra=Ge(Ps,qr),na=Ge(Us,qr),ia=Ge(ri),ii=Ke(Ws,Xe,kt,Ft),sa=Ke(zs,Xe,kt,Ft),aa=Ke(Rs,Xe,kt,Ft),oa=Ke(Xe,kt,Ft);function si(i){return Qe(i,[ta,ii],[ra,sa],[na,aa],[ia,oa])}function ai(i){return Qe(Gs(i),[qs,Js])}function oi(i){return Qe(i,[Ks,Qn],[Qs,Qn],[Xs,ea])}function li(i){return Qe(i,[$s,Zs])}var la=Ke(Xe);function ui(i){return Qe(i,[Bs,la])}var ua=Ge(Vs,Hs),ca=Ge(ni),da=Ke(Xe,kt,Ft);function ci(i){return Qe(i,[ua,ii],[ca,da])}var di="Invalid Duration",fi={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},ha={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...fi},ue=146097/400,et=146097/4800,fa={years:{quarters:4,months:12,weeks:ue/7,days:ue,hours:ue*24,minutes:ue*24*60,seconds:ue*24*60*60,milliseconds:ue*24*60*60*1e3},quarters:{months:3,weeks:ue/28,days:ue/4,hours:ue*24/4,minutes:ue*24*60/4,seconds:ue*24*60*60/4,milliseconds:ue*24*60*60*1e3/4},months:{weeks:et/7,days:et,hours:et*24,minutes:et*24*60,seconds:et*24*60*60,milliseconds:et*24*60*60*1e3},...fi},Pe=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],ma=Pe.slice(0).reverse();function Le(i,e,t=!1){let r={values:t?e.values:{...i.values,...e.values||{}},loc:i.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||i.conversionAccuracy,matrix:e.matrix||i.matrix};return new I(r)}function mi(i,e){var r;let t=(r=e.milliseconds)!=null?r:0;for(let n of ma.slice(1))e[n]&&(t+=e[n]*i[n].milliseconds);return t}function hi(i,e){let t=mi(i,e)<0?-1:1;Pe.reduceRight((r,n)=>{if(A(e[n]))return r;if(r){let s=e[r]*t,a=i[n][r],o=Math.floor(s/a);e[n]+=o*t,e[r]-=o*a*t}return n},null),Pe.reduce((r,n)=>{if(A(e[n]))return r;if(r){let s=e[r]%1;e[r]-=s,e[n]+=s*i[r][n]}return n},null)}function pa(i){let e={};for(let[t,r]of Object.entries(i))r!==0&&(e[t]=r);return e}var I=class{constructor(e){let t=e.conversionAccuracy==="longterm"||!1,r=t?fa:ha;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||L.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,t){return I.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new $(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new I({values:qe(e,I.normalizeUnit),loc:L.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(ge(e))return I.fromMillis(e);if(I.isDuration(e))return e;if(typeof e=="object")return I.fromObject(e);throw new $(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){let[r]=li(e);return r?I.fromObject(r,t):I.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){let[r]=ui(e);return r?I.fromObject(r,t):I.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new $("need to specify a reason the Duration is invalid");let r=e instanceof Q?e:new Q(e,t);if(Y.throwOnInvalid)throw new Jt(r);return new I({invalid:r})}static normalizeUnit(e){let t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new We(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){let r={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?H.create(this.loc,r).formatDurationFromString(this,e):di}toHuman(e={}){if(!this.isValid)return di;let t=Pe.map(r=>{let n=this.values[r];return A(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:r.slice(0,-1)}).format(n)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=$e(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;let t=this.toMillis();return t<0||t>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},C.fromMillis(t,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?mi(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;let t=I.fromDurationLike(e),r={};for(let n of Pe)(Ie(t.values,n)||Ie(this.values,n))&&(r[n]=t.get(n)+this.get(n));return Le(this,{values:r},!0)}minus(e){if(!this.isValid)return this;let t=I.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;let t={};for(let r of Object.keys(this.values))t[r]=Wr(e(this.values[r],r));return Le(this,{values:t},!0)}get(e){return this[I.normalizeUnit(e)]}set(e){if(!this.isValid)return this;let t={...this.values,...qe(e,I.normalizeUnit)};return Le(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:r,matrix:n}={}){let a={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:n,conversionAccuracy:r};return Le(this,a)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;let e=this.toObject();return hi(this.matrix,e),Le(this,{values:e},!0)}rescale(){if(!this.isValid)return this;let e=pa(this.normalize().shiftToAll().toObject());return Le(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(a=>I.normalizeUnit(a));let t={},r={},n=this.toObject(),s;for(let a of Pe)if(e.indexOf(a)>=0){s=a;let o=0;for(let c in r)o+=this.matrix[c][a]*r[c],r[c]=0;ge(n[a])&&(o+=n[a]);let l=Math.trunc(o);t[a]=l,r[a]=(o*1e3-l*1e3)/1e3}else ge(n[a])&&(r[a]=n[a]);for(let a in r)r[a]!==0&&(t[s]+=a===s?r[a]:r[a]/this.matrix[s][a]);return hi(this.matrix,t),Le(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let e={};for(let t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return Le(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(r,n){return r===void 0||r===0?n===void 0||n===0:r===n}for(let r of Pe)if(!t(this.values[r],e.values[r]))return!1;return!0}};var tt="Invalid Interval";function ga(i,e){return!i||!i.isValid?U.invalid("missing or invalid start"):!e||!e.isValid?U.invalid("missing or invalid end"):e<i?U.invalid("end before start",`The end of an interval must be after its start, but you had start=${i.toISO()} and end=${e.toISO()}`):null}var U=class{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new $("need to specify a reason the Interval is invalid");let r=e instanceof Q?e:new Q(e,t);if(Y.throwOnInvalid)throw new qt(r);return new U({invalid:r})}static fromDateTimes(e,t){let r=rt(e),n=rt(t),s=ga(r,n);return s==null?new U({start:r,end:n}):s}static after(e,t){let r=I.fromDurationLike(t),n=rt(e);return U.fromDateTimes(n,n.plus(r))}static before(e,t){let r=I.fromDurationLike(t),n=rt(e);return U.fromDateTimes(n.minus(r),n)}static fromISO(e,t){let[r,n]=(e||"").split("/",2);if(r&&n){let s,a;try{s=C.fromISO(r,t),a=s.isValid}catch(c){a=!1}let o,l;try{o=C.fromISO(n,t),l=o.isValid}catch(c){l=!1}if(a&&l)return U.fromDateTimes(s,o);if(a){let c=I.fromISO(n,t);if(c.isValid)return U.after(s,c)}else if(l){let c=I.fromISO(r,t);if(c.isValid)return U.before(o,c)}}return U.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",t){if(!this.isValid)return NaN;let r=this.start.startOf(e,t),n;return t!=null&&t.useLocaleWeeks?n=this.end.reconfigure({locale:r.locale}):n=this.end,n=n.startOf(e,t),Math.floor(n.diff(r,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?U.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];let t=e.map(rt).filter(a=>this.contains(a)).sort((a,o)=>a.toMillis()-o.toMillis()),r=[],{s:n}=this,s=0;for(;n<this.e;){let a=t[s]||this.e,o=+a>+this.e?this.e:a;r.push(U.fromDateTimes(n,o)),n=o,s+=1}return r}splitBy(e){let t=I.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:r}=this,n=1,s,a=[];for(;r<this.e;){let o=this.start.plus(t.mapUnits(l=>l*n));s=+o>+this.e?this.e:o,a.push(U.fromDateTimes(r,s)),r=s,n+=1}return a}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;let t=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return t>=r?null:U.fromDateTimes(t,r)}union(e){if(!this.isValid)return this;let t=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return U.fromDateTimes(t,r)}static merge(e){let[t,r]=e.sort((n,s)=>n.s-s.s).reduce(([n,s],a)=>s?s.overlaps(a)||s.abutsStart(a)?[n,s.union(a)]:[n.concat([s]),a]:[n,a],[[],null]);return r&&t.push(r),t}static xor(e){let t=null,r=0,n=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),a=Array.prototype.concat(...s),o=a.sort((l,c)=>l.time-c.time);for(let l of o)r+=l.type==="s"?1:-1,r===1?t=l.time:(t&&+t!=+l.time&&n.push(U.fromDateTimes(t,l.time)),t=null);return U.merge(n)}difference(...e){return U.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:tt}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=be,t={}){return this.isValid?H.create(this.s.loc.clone(t),e).formatInterval(this):tt}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:tt}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:tt}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:tt}toFormat(e,{separator:t=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:tt}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):I.invalid(this.invalidReason)}mapEndpoints(e){return U.fromDateTimes(e(this.s),e(this.e))}};var Oe=class{static hasDST(e=Y.defaultZone){let t=C.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return G.isValidZone(e)}static normalizeZone(e){return pe(e,Y.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||L.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||L.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||L.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||L.create(t,r,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||L.create(t,r,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||L.create(t,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||L.create(t,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return L.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return L.create(t,null,"gregory").eras(e)}static features(){return{relative:Xt(),localeWeek:er()}}};function pi(i,e){let t=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=t(e)-t(i);return Math.floor(I.fromMillis(r).as("days"))}function ya(i,e,t){let r=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{let d=pi(l,c);return(d-d%7)/7}],["days",pi]],n={},s=i,a,o;for(let[l,c]of r)t.indexOf(l)>=0&&(a=l,n[l]=c(i,e),o=s.plus(n),o>e?(n[l]--,i=s.plus(n),i>e&&(o=i,n[l]--,i=s.plus(n))):i=o);return[i,n,o,a]}function gi(i,e,t,r){let[n,s,a,o]=ya(i,e,t),l=e-n,c=t.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);c.length===0&&(a<e&&(a=n.plus({[o]:1})),a!==n&&(s[o]=(s[o]||0)+l/(a-n)));let d=I.fromObject(s,r);return c.length>0?I.fromMillis(l,r).shiftTo(...c).plus(d):d}var Ta="missing Intl.DateTimeFormat.formatToParts support";function P(i,e=t=>t){return{regex:i,deser:([t])=>e(An(t))}}var va=String.fromCharCode(160),vi=`[ ${va}]`,Ei=new RegExp(vi,"g");function Ea(i){return i.replace(/\./g,"\\.?").replace(Ei,vi)}function yi(i){return i.replace(/\./g,"").replace(Ei," ").toLowerCase()}function ye(i,e){return i===null?null:{regex:RegExp(i.map(Ea).join("|")),deser:([t])=>i.findIndex(r=>yi(t)===yi(r))+e}}function Ti(i,e){return{regex:i,deser:([,t,r])=>ke(t,r),groups:e}}function ir(i){return{regex:i,deser:([e])=>e}}function Da(i){return i.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function wa(i,e){let t=oe(e),r=oe(e,"{2}"),n=oe(e,"{3}"),s=oe(e,"{4}"),a=oe(e,"{6}"),o=oe(e,"{1,2}"),l=oe(e,"{1,3}"),c=oe(e,"{1,6}"),d=oe(e,"{1,9}"),h=oe(e,"{2,4}"),f=oe(e,"{4,6}"),p=T=>({regex:RegExp(Da(T.val)),deser:([v])=>v,literal:!0}),g=(T=>{if(i.literal)return p(T);switch(T.val){case"G":return ye(e.eras("short"),0);case"GG":return ye(e.eras("long"),0);case"y":return P(c);case"yy":return P(h,Lt);case"yyyy":return P(s);case"yyyyy":return P(f);case"yyyyyy":return P(a);case"M":return P(o);case"MM":return P(r);case"MMM":return ye(e.months("short",!0),1);case"MMMM":return ye(e.months("long",!0),1);case"L":return P(o);case"LL":return P(r);case"LLL":return ye(e.months("short",!1),1);case"LLLL":return ye(e.months("long",!1),1);case"d":return P(o);case"dd":return P(r);case"o":return P(l);case"ooo":return P(n);case"HH":return P(r);case"H":return P(o);case"hh":return P(r);case"h":return P(o);case"mm":return P(r);case"m":return P(o);case"q":return P(o);case"qq":return P(r);case"s":return P(o);case"ss":return P(r);case"S":return P(l);case"SSS":return P(n);case"u":return ir(d);case"uu":return ir(o);case"uuu":return P(t);case"a":return ye(e.meridiems(),0);case"kkkk":return P(s);case"kk":return P(h,Lt);case"W":return P(o);case"WW":return P(r);case"E":case"c":return P(t);case"EEE":return ye(e.weekdays("short",!1),1);case"EEEE":return ye(e.weekdays("long",!1),1);case"ccc":return ye(e.weekdays("short",!0),1);case"cccc":return ye(e.weekdays("long",!0),1);case"Z":case"ZZ":return Ti(new RegExp(`([+-]${o.source})(?::(${r.source}))?`),2);case"ZZZ":return Ti(new RegExp(`([+-]${o.source})(${r.source})?`),2);case"z":return ir(/[a-z_+-/]{1,256}?/i);case" ":return ir(/[^\S\n\r]/);default:return p(T)}})(i)||{invalidReason:Ta};return g.token=i,g}var Sa={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function _a(i,e,t){let{type:r,value:n}=i;if(r==="literal"){let l=/^\s+$/.test(n);return{literal:!l,val:l?" ":n}}let s=e[r],a=r;r==="hour"&&(e.hour12!=null?a=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?a="hour12":a="hour24":a=t.hour12?"hour12":"hour24");let o=Sa[a];if(typeof o=="object"&&(o=o[s]),o)return{literal:!1,val:o}}function Ca(i){return[`^${i.map(t=>t.regex).reduce((t,r)=>`${t}(${r.source})`,"")}$`,i]}function Oa(i,e,t){let r=i.match(e);if(r){let n={},s=1;for(let a in t)if(Ie(t,a)){let o=t[a],l=o.groups?o.groups+1:1;!o.literal&&o.token&&(n[o.token.val[0]]=o.deser(r.slice(s,s+l))),s+=l}return[r,n]}else return[r,{}]}function Aa(i){let e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},t=null,r;return A(i.z)||(t=G.create(i.z)),A(i.Z)||(t||(t=new V(i.Z)),r=i.Z),A(i.q)||(i.M=(i.q-1)*3+1),A(i.h)||(i.h<12&&i.a===1?i.h+=12:i.h===12&&i.a===0&&(i.h=0)),i.G===0&&i.y&&(i.y=-i.y),A(i.u)||(i.S=xt(i.u)),[Object.keys(i).reduce((s,a)=>{let o=e(a);return o&&(s[o]=i[a]),s},{}),t,r]}var Gr=null;function ba(){return Gr||(Gr=C.fromMillis(1555555555555)),Gr}function Na(i,e){if(i.literal)return i;let t=H.macroTokenToFormatOpts(i.val),r=Xr(t,e);return r==null||r.includes(void 0)?i:r}function Kr(i,e){return Array.prototype.concat(...i.map(t=>Na(t,e)))}var Yt=class{constructor(e,t){if(this.locale=e,this.format=t,this.tokens=Kr(H.parseFormat(t),e),this.units=this.tokens.map(r=>wa(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){let[r,n]=Ca(this.units);this.regex=RegExp(r,"i"),this.handlers=n}}explainFromTokens(e){if(this.isValid){let[t,r]=Oa(e,this.regex,this.handlers),[n,s,a]=r?Aa(r):[null,null,void 0];if(Ie(r,"a")&&Ie(r,"H"))throw new he("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:r,result:n,zone:s,specificOffset:a}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}};function Qr(i,e,t){return new Yt(i,t).explainFromTokens(e)}function Di(i,e,t){let{result:r,zone:n,specificOffset:s,invalidReason:a}=Qr(i,e,t);return[r,n,s,a]}function Xr(i,e){if(!i)return null;let r=H.create(e,i).dtFormatter(ba()),n=r.formatToParts(),s=r.resolvedOptions();return n.map(a=>_a(a,i,s))}var en="Invalid DateTime",wi=864e13;function Pt(i){return new Q("unsupported zone",`the zone "${i.name}" is not supported`)}function tn(i){return i.weekData===null&&(i.weekData=Nt(i.c)),i.weekData}function rn(i){return i.localWeekData===null&&(i.localWeekData=Nt(i.c,i.loc.getMinDaysInFirstWeek(),i.loc.getStartOfWeek())),i.localWeekData}function Ue(i,e){let t={ts:i.ts,zone:i.zone,c:i.c,o:i.o,loc:i.loc,invalid:i.invalid};return new C({...t,...e,old:t})}function Ni(i,e,t){let r=i-e*60*1e3,n=t.offset(r);if(e===n)return[r,e];r-=(n-e)*60*1e3;let s=t.offset(r);return n===s?[r,n]:[i-Math.min(n,s)*60*1e3,Math.max(n,s)]}function sr(i,e){i+=e*60*1e3;let t=new Date(i);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function or(i,e,t){return Ni(Be(i),e,t)}function Si(i,e){let t=i.o,r=i.c.year+Math.trunc(e.years),n=i.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...i.c,year:r,month:n,day:Math.min(i.c.day,je(r,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},a=I.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),o=Be(s),[l,c]=Ni(o,t,i.zone);return a!==0&&(l+=a,c=i.zone.offset(l)),{ts:l,o:c}}function nt(i,e,t,r,n,s){let{setZone:a,zone:o}=t;if(i&&Object.keys(i).length!==0||e){let l=e||o,c=C.fromObject(i,{...t,zone:l,specificOffset:s});return a?c:c.setZone(o)}else return C.invalid(new Q("unparsable",`the input "${n}" can't be parsed as ${r}`))}function ar(i,e,t=!0){return i.isValid?H.create(L.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(i,e):null}function nn(i,e){let t=i.c.year>9999||i.c.year<0,r="";return t&&i.c.year>=0&&(r+="+"),r+=R(i.c.year,t?6:4),e?(r+="-",r+=R(i.c.month),r+="-",r+=R(i.c.day)):(r+=R(i.c.month),r+=R(i.c.day)),r}function _i(i,e,t,r,n,s){let a=R(i.c.hour);return e?(a+=":",a+=R(i.c.minute),(i.c.millisecond!==0||i.c.second!==0||!t)&&(a+=":")):a+=R(i.c.minute),(i.c.millisecond!==0||i.c.second!==0||!t)&&(a+=R(i.c.second),(i.c.millisecond!==0||!r)&&(a+=".",a+=R(i.c.millisecond,3))),n&&(i.isOffsetFixed&&i.offset===0&&!s?a+="Z":i.o<0?(a+="-",a+=R(Math.trunc(-i.o/60)),a+=":",a+=R(Math.trunc(-i.o%60))):(a+="+",a+=R(Math.trunc(i.o/60)),a+=":",a+=R(Math.trunc(i.o%60)))),s&&(a+="["+i.zone.ianaName+"]"),a}var Mi={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Ma={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ia={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ii=["year","month","day","hour","minute","second","millisecond"],xa=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],La=["year","ordinal","hour","minute","second","millisecond"];function ka(i){let e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[i.toLowerCase()];if(!e)throw new We(i);return e}function Ci(i){switch(i.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return ka(i)}}function Fa(i){if(Ut===void 0&&(Ut=Y.now()),i.type!=="iana")return i.offset(Ut);let e=i.name,t=sn.get(e);return t===void 0&&(t=i.offset(Ut),sn.set(e,t)),t}function Oi(i,e){let t=pe(e.zone,Y.defaultZone);if(!t.isValid)return C.invalid(Pt(t));let r=L.fromObject(e),n,s;if(A(i.year))n=Y.now();else{for(let l of Ii)A(i[l])&&(i[l]=Mi[l]);let a=Rr(i)||Vr(i);if(a)return C.invalid(a);let o=Fa(t);[n,s]=or(i,o,t)}return new C({ts:n,zone:t,loc:r,o:s})}function Ai(i,e,t){let r=A(t.round)?!0:t.round,n=(a,o)=>(a=$e(a,r||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(a,o)),s=a=>t.calendary?e.hasSame(i,a)?0:e.startOf(a).diff(i.startOf(a),a).get(a):e.diff(i,a).get(a);if(t.unit)return n(s(t.unit),t.unit);for(let a of t.units){let o=s(a);if(Math.abs(o)>=1)return n(o,a)}return n(i>e?-0:0,t.units[t.units.length-1])}function bi(i){let e={},t;return i.length>0&&typeof i[i.length-1]=="object"?(e=i[i.length-1],t=Array.from(i).slice(0,i.length-1)):t=Array.from(i),[e,t]}var Ut,sn=new Map,C=class{constructor(e){let t=e.zone||Y.defaultZone,r=e.invalid||(Number.isNaN(e.ts)?new Q("invalid input"):null)||(t.isValid?null:Pt(t));this.ts=A(e.ts)?Y.now():e.ts;let n=null,s=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[n,s]=[e.old.c,e.old.o];else{let o=ge(e.o)&&!e.old?e.o:t.offset(this.ts);n=sr(this.ts,o),r=Number.isNaN(n.year)?new Q("invalid input"):null,n=r?null:n,s=r?null:o}this._zone=t,this.loc=e.loc||L.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=n,this.o=s,this.isLuxonDateTime=!0}static now(){return new C({})}static local(){let[e,t]=bi(arguments),[r,n,s,a,o,l,c]=t;return Oi({year:r,month:n,day:s,hour:a,minute:o,second:l,millisecond:c},e)}static utc(){let[e,t]=bi(arguments),[r,n,s,a,o,l,c]=t;return e.zone=V.utcInstance,Oi({year:r,month:n,day:s,hour:a,minute:o,second:l,millisecond:c},e)}static fromJSDate(e,t={}){let r=Bn(e)?e.valueOf():NaN;if(Number.isNaN(r))return C.invalid("invalid input");let n=pe(t.zone,Y.defaultZone);return n.isValid?new C({ts:r,zone:n,loc:L.fromObject(t)}):C.invalid(Pt(n))}static fromMillis(e,t={}){if(ge(e))return e<-wi||e>wi?C.invalid("Timestamp out of range"):new C({ts:e,zone:pe(t.zone,Y.defaultZone),loc:L.fromObject(t)});throw new $(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(ge(e))return new C({ts:e*1e3,zone:pe(t.zone,Y.defaultZone),loc:L.fromObject(t)});throw new $("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};let r=pe(t.zone,Y.defaultZone);if(!r.isValid)return C.invalid(Pt(r));let n=L.fromObject(t),s=qe(e,Ci),{minDaysInFirstWeek:a,startOfWeek:o}=zr(s,n),l=Y.now(),c=A(t.specificOffset)?r.offset(l):t.specificOffset,d=!A(s.ordinal),h=!A(s.year),f=!A(s.month)||!A(s.day),p=h||f,y=s.weekYear||s.weekNumber;if((p||d)&&y)throw new he("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&d)throw new he("Can't mix ordinal dates with month/day");let g=y||s.weekday&&!p,T,v,D=sr(l,c);g?(T=xa,v=Ma,D=Nt(D,a,o)):d?(T=La,v=Ia,D=nr(D)):(T=Ii,v=Mi);let O=!1;for(let z of T){let X=s[z];A(X)?O?s[z]=v[z]:s[z]=D[z]:O=!0}let S=g?Vn(s,a,o):d?Hn(s):Rr(s),b=S||Vr(s);if(b)return C.invalid(b);let N=g?Pr(s,a,o):d?Ur(s):s,[F,Z]=or(N,c,r),j=new C({ts:F,zone:r,o:Z,loc:n});return s.weekday&&p&&e.weekday!==j.weekday?C.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${j.toISO()}`):j.isValid?j:C.invalid(j.invalid)}static fromISO(e,t={}){let[r,n]=si(e);return nt(r,n,t,"ISO 8601",e)}static fromRFC2822(e,t={}){let[r,n]=ai(e);return nt(r,n,t,"RFC 2822",e)}static fromHTTP(e,t={}){let[r,n]=oi(e);return nt(r,n,t,"HTTP",t)}static fromFormat(e,t,r={}){if(A(e)||A(t))throw new $("fromFormat requires an input string and a format");let{locale:n=null,numberingSystem:s=null}=r,a=L.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),[o,l,c,d]=Di(a,e,t);return d?C.invalid(d):nt(o,l,r,`format ${t}`,e,c)}static fromString(e,t,r={}){return C.fromFormat(e,t,r)}static fromSQL(e,t={}){let[r,n]=ci(e);return nt(r,n,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new $("need to specify a reason the DateTime is invalid");let r=e instanceof Q?e:new Q(e,t);if(Y.throwOnInvalid)throw new jt(r);return new C({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){let r=Xr(e,L.fromObject(t));return r?r.map(n=>n?n.val:null).join(""):null}static expandFormat(e,t={}){return Kr(H.parseFormat(e),L.fromObject(t)).map(n=>n.val).join("")}static resetCache(){Ut=void 0,sn.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?tn(this).weekYear:NaN}get weekNumber(){return this.isValid?tn(this).weekNumber:NaN}get weekday(){return this.isValid?tn(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?rn(this).weekday:NaN}get localWeekNumber(){return this.isValid?rn(this).weekNumber:NaN}get localWeekYear(){return this.isValid?rn(this).weekYear:NaN}get ordinal(){return this.isValid?nr(this.c).ordinal:NaN}get monthShort(){return this.isValid?Oe.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Oe.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Oe.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Oe.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let e=864e5,t=6e4,r=Be(this.c),n=this.zone.offset(r-e),s=this.zone.offset(r+e),a=this.zone.offset(r-n*t),o=this.zone.offset(r-s*t);if(a===o)return[this];let l=r-a*t,c=r-o*t,d=sr(l,a),h=sr(c,o);return d.hour===h.hour&&d.minute===h.minute&&d.second===h.second&&d.millisecond===h.millisecond?[Ue(this,{ts:l}),Ue(this,{ts:c})]:[this]}get isInLeapYear(){return Ye(this.year)}get daysInMonth(){return je(this.year,this.month)}get daysInYear(){return this.isValid?Me(this.year):NaN}get weeksInWeekYear(){return this.isValid?Fe(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?Fe(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){let{locale:t,numberingSystem:r,calendar:n}=H.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:r,outputCalendar:n}}toUTC(e=0,t={}){return this.setZone(V.instance(e),t)}toLocal(){return this.setZone(Y.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:r=!1}={}){if(e=pe(e,Y.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(t||r){let s=e.offset(this.ts),a=this.toObject();[n]=or(a,s,e)}return Ue(this,{ts:n,zone:e})}else return C.invalid(Pt(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:r}={}){let n=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:r});return Ue(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;let t=qe(e,Ci),{minDaysInFirstWeek:r,startOfWeek:n}=zr(t,this.loc),s=!A(t.weekYear)||!A(t.weekNumber)||!A(t.weekday),a=!A(t.ordinal),o=!A(t.year),l=!A(t.month)||!A(t.day),c=o||l,d=t.weekYear||t.weekNumber;if((c||a)&&d)throw new he("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&a)throw new he("Can't mix ordinal dates with month/day");let h;s?h=Pr({...Nt(this.c,r,n),...t},r,n):A(t.ordinal)?(h={...this.toObject(),...t},A(t.day)&&(h.day=Math.min(je(h.year,h.month),h.day))):h=Ur({...nr(this.c),...t});let[f,p]=or(h,this.o,this.zone);return Ue(this,{ts:f,o:p})}plus(e){if(!this.isValid)return this;let t=I.fromDurationLike(e);return Ue(this,Si(this,t))}minus(e){if(!this.isValid)return this;let t=I.fromDurationLike(e).negate();return Ue(this,Si(this,t))}startOf(e,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;let r={},n=I.normalizeUnit(e);switch(n){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break;case"milliseconds":break}if(n==="weeks")if(t){let s=this.loc.getStartOfWeek(),{weekday:a}=this;a<s&&(r.weekNumber=this.weekNumber-1),r.weekday=s}else r.weekday=1;if(n==="quarters"){let s=Math.ceil(this.month/3);r.month=(s-1)*3+1}return this.set(r)}endOf(e,t){return this.isValid?this.plus({[e]:1}).startOf(e,t).minus(1):this}toFormat(e,t={}){return this.isValid?H.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):en}toLocaleString(e=be,t={}){return this.isValid?H.create(this.loc.clone(t),e).formatDateTime(this):en}toLocaleParts(e={}){return this.isValid?H.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;let a=e==="extended",o=nn(this,a);return o+="T",o+=_i(this,a,t,r,n,s),o}toISODate({format:e="extended"}={}){return this.isValid?nn(this,e==="extended"):null}toISOWeekDate(){return ar(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:s=!1,format:a="extended"}={}){return this.isValid?(n?"T":"")+_i(this,a==="extended",t,e,r,s):null}toRFC2822(){return ar(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ar(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?nn(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(t||e)&&(r&&(n+=" "),t?n+="z":e&&(n+="ZZ")),ar(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():en}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};let t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",r={}){if(!this.isValid||!e.isValid)return I.invalid("created by diffing an invalid DateTime");let n={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=$n(t).map(I.normalizeUnit),a=e.valueOf()>this.valueOf(),o=a?this:e,l=a?e:this,c=gi(o,l,s,n);return a?c.negate():c}diffNow(e="milliseconds",t={}){return this.diff(C.now(),e,t)}until(e){return this.isValid?U.fromDateTimes(this,e):this}hasSame(e,t,r){if(!this.isValid)return!1;let n=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(t,r)<=n&&n<=s.endOf(t,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;let t=e.base||C.fromObject({},{zone:this.zone}),r=e.padding?this<t?-e.padding:e.padding:0,n=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(n=e.unit,s=void 0),Ai(t,this.plus(r),{...e,numeric:"always",units:n,unit:s})}toRelativeCalendar(e={}){return this.isValid?Ai(e.base||C.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(C.isDateTime))throw new $("min requires all arguments be DateTimes");return Hr(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(C.isDateTime))throw new $("max requires all arguments be DateTimes");return Hr(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,r={}){let{locale:n=null,numberingSystem:s=null}=r,a=L.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});return Qr(a,e,t)}static fromStringExplain(e,t,r={}){return C.fromFormatExplain(e,t,r)}static buildFormatParser(e,t={}){let{locale:r=null,numberingSystem:n=null}=t,s=L.fromOpts({locale:r,numberingSystem:n,defaultToEN:!0});return new Yt(s,e)}static fromFormatParser(e,t,r={}){if(A(e)||A(t))throw new $("fromFormatParser requires an input string and a format parser");let{locale:n=null,numberingSystem:s=null}=r,a=L.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});if(!a.equals(t.locale))throw new $(`fromFormatParser called with a locale of ${a}, but the format parser was created for ${t.locale}`);let{result:o,zone:l,specificOffset:c,invalidReason:d}=t.explainFromTokens(e);return d?C.invalid(d):nt(o,l,r,`format ${t.format}`,e,c)}static get DATE_SHORT(){return be}static get DATE_MED(){return lt}static get DATE_MED_WITH_WEEKDAY(){return pr}static get DATE_FULL(){return ut}static get DATE_HUGE(){return ct}static get TIME_SIMPLE(){return dt}static get TIME_WITH_SECONDS(){return ht}static get TIME_WITH_SHORT_OFFSET(){return ft}static get TIME_WITH_LONG_OFFSET(){return mt}static get TIME_24_SIMPLE(){return pt}static get TIME_24_WITH_SECONDS(){return gt}static get TIME_24_WITH_SHORT_OFFSET(){return yt}static get TIME_24_WITH_LONG_OFFSET(){return Tt}static get DATETIME_SHORT(){return vt}static get DATETIME_SHORT_WITH_SECONDS(){return Et}static get DATETIME_MED(){return Dt}static get DATETIME_MED_WITH_SECONDS(){return wt}static get DATETIME_MED_WITH_WEEKDAY(){return gr}static get DATETIME_FULL(){return St}static get DATETIME_FULL_WITH_SECONDS(){return _t}static get DATETIME_HUGE(){return Ct}static get DATETIME_HUGE_WITH_SECONDS(){return Ot}};function rt(i){if(C.isDateTime(i))return i;if(i&&i.valueOf&&ge(i.valueOf()))return C.fromJSDate(i);if(i&&typeof i=="object")return C.fromObject(i);throw new $(`Unknown datetime argument: ${i}, of type ${typeof i}`)}var Ya={"Pacific Standard Time":"America/Los_Angeles","Mountain Standard Time":"America/Denver","Central Standard Time":"America/Chicago","Eastern Standard Time":"America/New_York","US Eastern Standard Time":"America/Indianapolis","US Mountain Standard Time":"America/Phoenix","Hawaii-Aleutian Standard Time":"Pacific/Honolulu","Alaskan Standard Time":"America/Anchorage","Atlantic Standard Time":"America/Halifax","Canada Central Standard Time":"America/Regina","Central America Standard Time":"America/Guatemala","Mexico Standard Time":"America/Mexico_City","US Central Standard Time":"America/Chicago","SA Eastern Standard Time":"America/Cayenne","SA Pacific Standard Time":"America/Bogota","SA Western Standard Time":"America/La_Paz","E. South America Standard Time":"America/Sao_Paulo","Central Brazilian Standard Time":"America/Cuiaba","Argentina Standard Time":"America/Buenos_Aires","Venezuela Standard Time":"America/Caracas","Pacific SA Standard Time":"America/Santiago","GMT Standard Time":"Europe/London","Greenwich Standard Time":"Atlantic/Reykjavik","W. Europe Standard Time":"Europe/Berlin","Central Europe Standard Time":"Europe/Warsaw","Romance Standard Time":"Europe/Paris","Central European Standard Time":"Europe/Budapest","E. Europe Standard Time":"Europe/Chisinau","GTB Standard Time":"Europe/Athens","FLE Standard Time":"Europe/Helsinki","Russian Standard Time":"Europe/Moscow","Belarus Standard Time":"Europe/Minsk","Turkey Standard Time":"Europe/Istanbul","Kaliningrad Standard Time":"Europe/Kaliningrad","South Africa Standard Time":"Africa/Johannesburg","W. Central Africa Standard Time":"Africa/Lagos","Egypt Standard Time":"Africa/Cairo","Libya Standard Time":"Africa/Tripoli","Morocco Standard Time":"Africa/Casablanca","Middle East Standard Time":"Asia/Beirut","Iran Standard Time":"Asia/Tehran","Arabian Standard Time":"Asia/Dubai","Afghanistan Standard Time":"Asia/Kabul","West Asia Standard Time":"Asia/Tashkent","India Standard Time":"Asia/Kolkata","Sri Lanka Standard Time":"Asia/Colombo","Nepal Standard Time":"Asia/Kathmandu","Central Asia Standard Time":"Asia/Almaty","Bangladesh Standard Time":"Asia/Dhaka","Myanmar Standard Time":"Asia/Rangoon","SE Asia Standard Time":"Asia/Bangkok","N. Central Asia Standard Time":"Asia/Novosibirsk","China Standard Time":"Asia/Shanghai","North Asia Standard Time":"Asia/Krasnoyarsk","Singapore Standard Time":"Asia/Singapore","W. Australia Standard Time":"Australia/Perth","Taipei Standard Time":"Asia/Taipei","Ulaanbaatar Standard Time":"Asia/Ulaanbaatar","North Asia East Standard Time":"Asia/Irkutsk","Tokyo Standard Time":"Asia/Tokyo","Korea Standard Time":"Asia/Seoul","Cen. Australia Standard Time":"Australia/Adelaide","AUS Central Standard Time":"Australia/Darwin","E. Australia Standard Time":"Australia/Brisbane","AUS Eastern Standard Time":"Australia/Sydney","West Pacific Standard Time":"Pacific/Port_Moresby","Tasmania Standard Time":"Australia/Hobart","Vladivostok Standard Time":"Asia/Vladivostok","Central Pacific Standard Time":"Pacific/Guadalcanal","New Zealand Standard Time":"Pacific/Auckland","Fiji Standard Time":"Pacific/Fiji","Tonga Standard Time":"Pacific/Tongatapu",UTC:"UTC","Coordinated Universal Time":"UTC","tzone://Microsoft/Utc":"UTC","Customized Time Zone":"UTC","(UTC+02:00) Athens, Bucharest":"Europe/Athens","(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna":"Europe/Berlin","(UTC+00:00) Dublin, Edinburgh, Lisbon, London":"Europe/London","(UTC-05:00) Eastern Time (US & Canada)":"America/New_York","(UTC-06:00) Central Time (US & Canada)":"America/Chicago","(UTC-07:00) Mountain Time (US & Canada)":"America/Denver","(UTC-08:00) Pacific Time (US & Canada)":"America/Los_Angeles"};function Pa(i){if(!i)return"UTC";let e=i.trim();return!e||e.startsWith("tzone://Microsoft/")&&e.replace("tzone://Microsoft/","").toLowerCase()==="utc"?"UTC":e.match(/^\(UTC[+-]\d{2}:\d{2}\)\s*(.+)$/)?e:e.toLowerCase()==="customized time zone"?"Customized Time Zone":e}function we(i,e,t=!1){let r=i.year,n=i.month,s=i.day,a=i.hour,o=i.minute,l=i.second;if(t)return new Date(r,n-1,s,0,0,0);if(!e)try{return i.toJSDate()}catch(h){return console.warn("Failed to use ical.js toJSDate(), falling back to manual construction:",h),new Date(r,n-1,s,a,o,l)}let c=Pa(e),d=Ya[c]||c;try{let h=C.fromObject({year:r,month:n,day:s,hour:a,minute:o,second:l},{zone:d});return h.isValid?h.toLocal().toJSDate():(console.warn(`Invalid timezone conversion for zone: ${c} (mapped to ${d}), falling back to local time`),new Date(r,n-1,s,a,o,l))}catch(h){return console.error("Failed to convert ICAL time:",h,{icalTime:i,tzid:c,mappedZone:d}),new Date(r,n-1,s,a,o,l)}}var lr=class{constructor(e,t){this.plugin=e;this.refreshMinutes=t;this.events=[];this.lastFetch=0;this.isLoadingCache=!1;this.isFetchingCalendars=!1}async fetchCalendars(e,t=!1){if(this.isFetchingCalendars)return this.events;let r=e.filter(n=>n.enabled);return r.length===0?(this.events=[],console.warn("No enabled calendar sources to fetch."),[]):this.shouldLoadFromCache(t)&&(await this.loadFromCache()).length>0?(this.scheduleBackgroundRefresh(e),this.events):this.needsRefresh(r,t)?this.performFetch(r,t):this.events}getEventsForDate(e){let t=new Date(e);t.setHours(0,0,0,0);let r=new Date(e);return r.setHours(23,59,59,999),this.events.filter(n=>this.eventOccursOnDate(n,t,r)).sort((n,s)=>n.start.getTime()-s.start.getTime())}getAllEvents(){return this.events}shouldLoadFromCache(e){return this.events.length===0&&!e}scheduleBackgroundRefresh(e){setTimeout(()=>this.fetchCalendars(e,!0),100)}needsRefresh(e,t){let n=Date.now()-this.lastFetch>=this.refreshMinutes*60*1e3;return t||this.events.length===0||n||this.hasSourceMismatch(e)}hasSourceMismatch(e){let t=this.events.some(n=>!e.find(s=>s.name===n.source)),r=e.some(n=>!this.events.find(s=>s.source===n.name));return t||r}async performFetch(e,t){try{this.isFetchingCalendars=!0,this.showFetchNotification(t);let r=e.map(s=>this.fetchCalendar(s)),n=await Promise.all(r);return this.events=n.flat(),this.lastFetch=Date.now(),await this.saveToCache(),this.showCompletionNotification(t),this.events}catch(r){return console.error("Error fetching calendars:",r),this.showErrorNotification(t),this.events}finally{this.isFetchingCalendars=!1}}showFetchNotification(e){this.events.length>0&&!e?console.log("MemoChron: Background refresh started"):e&&new q.Notice("MemoChron: Refreshing calendars...")}showCompletionNotification(e){e&&new q.Notice(`MemoChron: Calendar refresh complete (${this.events.length} events)`)}showErrorNotification(e){e&&new q.Notice("MemoChron: Failed to refresh calendars. Check the console for details.")}async loadFromCache(){if(this.isLoadingCache)return[];this.isLoadingCache=!0;try{let e=await this.readCacheFile();if(this.isValidCache(e))return this.restoreFromCache(e),e.events}catch(e){console.log("MemoChron: No cache found or cache invalid",e)}finally{this.isLoadingCache=!1}return[]}async readCacheFile(){let e=await this.plugin.app.vault.adapter.read(`${this.plugin.app.vault.configDir}/plugins/memochron/calendar-cache.json`);return JSON.parse(e)}isValidCache(e){return e&&e.timestamp&&e.events&&Array.isArray(e.events)}restoreFromCache(e){e.events.forEach(t=>{t.start=new Date(t.start),t.end=new Date(t.end)}),this.events=e.events,this.lastFetch=e.timestamp}async saveToCache(){try{await this.ensureCacheDirectory();let e={timestamp:this.lastFetch,sources:this.getEnabledSourcesForCache(),events:this.events};await this.writeCacheFile(e),console.log("MemoChron: Calendar cache saved")}catch(e){console.error("MemoChron: Failed to save calendar cache:",e)}}async ensureCacheDirectory(){let e=`${this.plugin.app.vault.configDir}/plugins/memochron`;try{await this.plugin.app.vault.adapter.mkdir(e)}catch(t){}}getEnabledSourcesForCache(){return this.plugin.settings.calendarUrls.filter(e=>e.enabled).map(e=>({url:e.url,name:e.name}))}async writeCacheFile(e){await this.plugin.app.vault.adapter.write(`${this.plugin.app.vault.configDir}/plugins/memochron/calendar-cache.json`,JSON.stringify(e))}async fetchCalendar(e){try{let t=await this.fetchCalendarData(e);return t.status!==200?(t.status===403?(console.error(`Calendar ${e.name} access denied. The calendar may no longer be public or requires authentication.`),new q.Notice(`MemoChron: Cannot access calendar "${e.name}". Please check if it's still publicly shared.`)):t.status===404?(console.error(`Calendar ${e.name} not found at URL: ${e.url}`),new q.Notice(`MemoChron: Calendar "${e.name}" not found. Please check the URL.`)):console.error(`Failed to fetch calendar ${e.name}: ${t.status} ${t.text||"Unknown error"}`),[]):!t.text||!t.text.includes("BEGIN:VCALENDAR")?(console.error(`Calendar ${e.name} returned invalid data. Expected iCalendar format.`),new q.Notice(`MemoChron: Calendar "${e.name}" returned invalid data.`),[]):this.parseCalendarData(t.text,e)}catch(t){return console.error(`Error fetching calendar ${e.name}:`,t),this.logPlatformInfo(),t.message&&t.message.includes("CORS")?new q.Notice(`MemoChron: Calendar "${e.name}" blocked by CORS policy.`):t.message&&t.message.includes("network")&&new q.Notice(`MemoChron: Network error fetching calendar "${e.name}".`),[]}}async fetchCalendarData(e){let t=Tn(e.url);if(En(t))return this.fetchRemoteCalendar(e.url);if(vn(t))return this.fetchLocalCalendar(t);throw new Error(`Unsupported calendar path type: ${e.url}`)}async fetchRemoteCalendar(e){var t,r;if(e.includes("outlook.office365.com")||e.includes("outlook.live.com")){let n=await(0,q.requestUrl)({url:e,method:"GET",headers:{Accept:"*/*","User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"},throw:!1});return n.text&&n.text.includes("BEGIN:VCALENDAR")?n:((r=(t=n.headers)==null?void 0:t["content-type"])==null?void 0:r.includes("text/html"))||n.text&&(n.text.includes("<!DOCTYPE html")||n.text.includes("<html"))?(console.error(`Outlook calendar returned HTML error page for ${e.substring(0,50)}...`),n=await(0,q.requestUrl)({url:e,method:"GET",throw:!1}),n.text&&n.text.includes("BEGIN:VCALENDAR")||(n=await(0,q.requestUrl)({url:e,method:"GET",headers:{Accept:"text/calendar"},throw:!1}),n.text&&n.text.includes("BEGIN:VCALENDAR"))?n:(new q.Notice("MemoChron: Outlook calendar access failed. The URL works in browser but not in Obsidian. This may be due to Obsidian's network restrictions."),{...n,status:403,text:""})):n}return(0,q.requestUrl)({url:e,method:"GET",headers:{Accept:"text/calendar","User-Agent":"MemoChron-ObsidianPlugin"},throw:!1})}async fetchLocalCalendar(e){try{let t;if(e.type==="vault_relative"){let r=this.plugin.app.vault.getAbstractFileByPath(e.normalizedPath);if(!r||!(r instanceof q.TFile))return{status:404,text:`File not found: ${e.normalizedPath}`};t=await this.plugin.app.vault.read(r)}else try{t=await this.plugin.app.vault.adapter.read(e.normalizedPath)}catch(r){return{status:404,text:`Cannot read file: ${e.normalizedPath}`}}return{status:200,text:t}}catch(t){return console.error("Error reading local calendar file:",t),{status:500,text:`Error reading file: ${t.message}`}}}parseCalendarData(e,t){let r=(0,ze.parse)(e),s=new ze.Component(r).getAllSubcomponents("vevent"),a=[],{periodStart:o,periodEnd:l}=this.getEventPeriod(),c=this.collectRecurrenceExceptions(s);for(let d of s){if(this.shouldSkipEvent(d))continue;let h=this.processEvent(d,t,c,o,l);a.push(...h)}return a}getEventPeriod(){let e=new Date;e.setMonth(e.getMonth()-1),e.setHours(0,0,0,0);let t=new Date;return t.setMonth(t.getMonth()+2),t.setHours(23,59,59,999),{periodStart:e,periodEnd:t}}collectRecurrenceExceptions(e){let t=new Map;for(let r of e){if(!r.hasProperty("recurrence-id")||this.isCancelledEvent(r))continue;let n=new ze.Event(r),s=n.uid,a=r.getFirstProperty("recurrence-id").getFirstValue(),o=`${s}-${a.toJSDate().toISOString().substring(0,10)}`;t.set(o,n)}return t}shouldSkipEvent(e){return e.hasProperty("recurrence-id")||this.isCancelledEvent(e)}isCancelledEvent(e){return e.hasProperty("status")&&e.getFirstPropertyValue("status")==="CANCELLED"}processEvent(e,t,r,n,s){let a=new ze.Event(e),o=this.extractTimezone(e);return e.hasProperty("rrule")?this.processRecurringEvent(a,e,t,o,r,n,s):this.processSingleEvent(a,t,o)}extractTimezone(e){if(!e.hasProperty("dtstart"))return null;let t=e.getFirstProperty("dtstart");return t?t.getParameter("tzid"):null}processRecurringEvent(e,t,r,n,s,a,o){let l=[],c=this.getExcludedDates(t),d=e.iterator(),h,f=this.isAllDayEvent(t);for(;h=d.next();){let p=we(h,n,f),y=h.clone();y.addDuration(e.duration);let g=we(y,n,f),T=f?new Date(g.getTime()-1):g;if(p>o)break;let v=h.toJSDate().toISOString().substring(0,10),D=`${e.uid}-${v}`;if(this.shouldSkipOccurrence(h.toJSDate(),c,s,D)){let O=this.processException(s.get(D),r,n,a,o);O&&l.push(O);continue}p<=o&&T>=a&&l.push({id:`${e.uid}-${h.toUnixTime()}`,title:e.summary,start:p,end:T,isAllDay:f,description:e.description,location:e.location,attendees:this.extractAttendees(t),source:r.name,sourceId:r.url,color:r.color})}return l}processSingleEvent(e,t,r){let n=this.isAllDayEvent(e.component),s=we(e.startDate,r,n),a=we(e.endDate,r,n),o=n?new Date(a.getTime()-1):a;return[{id:e.uid,title:e.summary,start:s,end:o,isAllDay:n,description:e.description,location:e.location,attendees:this.extractAttendees(e.component),source:t.name,sourceId:t.url,color:t.color}]}getExcludedDates(e){let t=[];if(!e.hasProperty("exdate"))return t;let r=e.getAllProperties("exdate");for(let n of r)n.getValues().forEach(a=>{a!=null&&a.toJSDate&&t.push(a.toJSDate())});return t}calculateEndDate(e,t){let r=e.clone();return r.addDuration(t),r.toJSDate()}shouldSkipOccurrence(e,t,r,n){return t.some(a=>this.isSameDate(a,e))||r.has(n)}isSameDate(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}extractAttendees(e){let t=[];if(!e.hasProperty("attendee"))return t;let r=e.getAllProperties("attendee");for(let n of r){let s=n.getFirstValue(),a=n.getParameter("cn");if(a)t.push(a);else if(s){let o=s.replace(/^mailto:/i,"");t.push(o)}}return t}processException(e,t,r,n,s){if(!e)return null;let a=this.isAllDayEvent(e.component),o=this.extractExceptionTimezone(e,r),l=we(e.startDate,o,a),c=we(e.endDate,o,a),d=a?new Date(c.getTime()-1):c;return l<=s&&d>=n?{id:`${e.uid}-${e.startDate.toUnixTime()}`,title:e.summary,start:l,end:d,isAllDay:a,description:e.description,location:e.location,attendees:this.extractAttendees(e.component),source:t.name,sourceId:t.url,color:t.color}:null}extractExceptionTimezone(e,t){if(!e.component.hasProperty("dtstart"))return t;let r=e.component.getFirstProperty("dtstart");return(r==null?void 0:r.getParameter("tzid"))||t}eventOccursOnDate(e,t,r){let n=this.isSameDate(e.start,t),s=this.isSameDate(e.end,t),a=e.start<r&&e.end>t;return n||s||a}logPlatformInfo(){console.debug("Platform info:",{mobile:q.Platform.isMobile,electron:q.Platform.isDesktop,networkAvailable:navigator.onLine})}isAllDayEvent(e){let t=e.getFirstProperty("dtstart");if(!t)return!1;if(t.getParameter("value")==="DATE")return!0;let n=t.jCal;return!!(n&&n[2]==="date")}};var ce=require("obsidian"),Se=class{constructor(e,t){this.app=e;this.settings=t}async createEventNote(e){let t=this.buildFilePath(e);try{await this.ensureParentFolder(t);let r=this.app.vault.getAbstractFileByPath(t);if(r instanceof ce.TFile)return r;let n=this.generateNoteContent(e);return await this.app.vault.create(t,n)}catch(r){throw console.error("Error creating note:",r),r}}getExistingEventNote(e){let t=this.buildFilePath(e),r=this.app.vault.getAbstractFileByPath(t);return r instanceof ce.TFile?r:null}async getAllFolders(){let e=new Set(["/"]);return this.app.vault.getAllLoadedFiles().forEach(t=>{t instanceof ce.TFolder&&this.collectFolderPaths(t,e)}),Array.from(e).sort((t,r)=>t.localeCompare(r))}buildFilePath(e){var t,r,n;try{let s=this.getCalendarNotesSettings(e.source),a=(t=s.noteLocation)!=null?t:this.settings.noteLocation,o=(r=s.noteTitleFormat)!=null?r:this.settings.noteTitleFormat,l=(n=s.folderPathTemplate)!=null?n:this.settings.folderPathTemplate;if(!a)throw new Error("Note location is not configured");let c=(0,ce.normalizePath)(a),d=this.formatTitle(o,e);if(!l.trim())return(0,ce.normalizePath)(`${c}/${d}.md`);let h=this.applyFolderTemplate(l,e);return(0,ce.normalizePath)(`${c}/${h}/${d}.md`)}catch(s){console.error("Error building file path:",s);let a=this.settings.noteLocation||"calendar-notes",o=this.formatTitle(this.settings.noteTitleFormat,e);return(0,ce.normalizePath)(`${a}/${o}.md`)}}async ensureParentFolder(e){let t=e.substring(0,e.lastIndexOf("/"));t&&t!=="/"&&await this.ensureFolderExists(t)}collectFolderPaths(e,t){t.add(e.path),e.children.forEach(r=>{r instanceof ce.TFolder&&this.collectFolderPaths(r,t)})}generateNoteContent(e){var t;try{let r=this.getEventTemplateVariables(e),n=this.generateFrontmatter(e,r),a=(t=this.getCalendarNotesSettings(e.source).noteTemplate)!=null?t:this.settings.noteTemplate,o=this.applyTemplateVariables(a,r);return`${n}
${o}`}catch(r){return console.error("Error generating note content:",r),`# ${e.title}

**Date:** ${e.start.toLocaleDateString()}
**Time:** ${e.start.toLocaleTimeString()}
**Source:** ${e.source}

${e.description||""}`}}generateFrontmatter(e,t){var o;let n=(o=this.getCalendarNotesSettings(e.source).defaultFrontmatter)!=null?o:this.settings.defaultFrontmatter,s=this.cleanFrontmatter(n);s=this.applyTemplateVariables(s,t);let a=this.getTagsForEvent(e);if(a.length>0){let l=this.formatTagsYaml(a);s&&(s+=`
`),s+=l}return`${Se.FRONTMATTER_DELIMITER}
${s}
${Se.FRONTMATTER_DELIMITER}`}cleanFrontmatter(e){let t=e.trim();return t.startsWith(Se.FRONTMATTER_DELIMITER)&&(t=t.substring(3)),t.endsWith(Se.FRONTMATTER_DELIMITER)&&(t=t.substring(0,t.length-3)),t.trim()}formatTagsYaml(e){return`tags:
`+e.map(t=>`  - ${t}`).join(`
`)}getEventTemplateVariables(e){let t=this.formatDate(e.start,e.source),r=e.start.toISOString().split("T")[0],n=this.formatDate(e.start,e.source),s=e.start.toISOString().split("T")[0],a=this.formatDate(e.end,e.source),o=e.end.toISOString().split("T")[0],l=e.attendees||[],c=this.createAttendeeLinks(l,e.source);return{event_title:e.title,date:t,"date-iso":r,start_date:n,"start_date-iso":s,end_date:a,"end_date-iso":o,start_time:this.formatTime(e.start,e.source),end_time:this.formatTime(e.end,e.source),source:e.source,location:e.location||"",locationText:this.formatLocationText(e.location),description:this.cleanDescription(e.description||""),attendees:l.join(", "),attendees_list:l.map(d=>`- ${d}`).join(`
`),attendees_links:c.join(", "),attendees_links_list:c.map(d=>`- ${d}`).join(`
`),attendees_count:l.length.toString()}}applyTemplateVariables(e,t){if(!e||!t)return e||"";try{return Object.entries(t).reduce((r,[n,s])=>r.replace(new RegExp(`{{${n}}}`,"g"),s||""),e)}catch(r){return console.error("Error applying template variables:",r),e}}formatTitle(e,t){if(!e||!t)return"Untitled Event";try{let r=this.getEventTemplateVariables(t);return Object.entries(r).reduce((n,[s,a])=>{let o=`{{${s}}}`;return n.replace(new RegExp(o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),this.sanitizeFileName(a||""))},e)}catch(r){return console.error("Error formatting title:",r),t.title||"Untitled Event"}}formatLocationText(e){return e?`${this.getLocationEmoji(e)} ${e}`:""}getLocationEmoji(e){return this.isUrl(e)?Se.LOCATION_EMOJIS.URL:this.isVirtualMeeting(e)?Se.LOCATION_EMOJIS.VIRTUAL:Se.LOCATION_EMOJIS.PHYSICAL}isUrl(e){return/^(https?:\/\/|www\.)/.test(e)}isVirtualMeeting(e){let t=["zoom","meet.","teams","webex"],r=e.toLowerCase();return t.some(n=>r.includes(n))}formatDate(e,t){var o;let r=t?this.getCalendarNotesSettings(t):null,n=(o=r==null?void 0:r.noteDateFormat)!=null?o:this.settings.noteDateFormat,s={ISO:()=>e.toISOString().split("T")[0],US:()=>e.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),UK:()=>e.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),Long:()=>e.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})},a=s[n];return a?a():s.ISO()}formatTime(e,t){var a;let r=t?this.getCalendarNotesSettings(t):null,s={hour:"2-digit",minute:"2-digit",hour12:((a=r==null?void 0:r.noteTimeFormat)!=null?a:this.settings.noteTimeFormat)==="12h"};return e.toLocaleTimeString([],s)}cleanDescription(e){let t=e.indexOf(Se.TEAMS_SEPARATOR);return t!==-1?e.substring(0,t).trim():e.trim()}getTagsForEvent(e){var a,o,l;let r=(o=(a=this.getCalendarNotesSettings(e.source).defaultTags)!=null?a:this.settings.defaultTags)!=null?o:[],n=this.settings.calendarUrls.find(c=>c.name===e.source),s=(l=n==null?void 0:n.tags)!=null?l:[];return[...new Set([...r,...s])]}async ensureFolderExists(e){var n;let t=e.split("/").filter(Boolean),r="";for(let s of t){r=r?`${r}/${s}`:s;let a=this.app.vault.getAbstractFileByPath(r);if(a&&!(a instanceof ce.TFolder))throw new Error(`Cannot create folder '${r}' because a file with that name already exists`);if(!a)try{await this.app.vault.createFolder(r)}catch(o){if(!((n=o.message)!=null&&n.includes("already exists")))throw o}}}applyFolderTemplate(e,t){let r=this.getFolderTemplateVariables(t);return this.parseFolderTemplate(e,r)}getFolderTemplateVariables(e){var f;let t=e.start,r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=t.getFullYear(),l=t.getMonth(),c=t.getDate(),d=t.getDay(),h=Math.floor(l/3)+1;return{YYYY:o.toString(),YY:o.toString().slice(-2),MM:(l+1).toString().padStart(2,"0"),M:(l+1).toString(),MMM:n[l],MMMM:r[l],DD:c.toString().padStart(2,"0"),D:c.toString(),DDD:a[d],DDDD:s[d],Q:h.toString(),source:this.sanitizeFileName(e.source),event_title:this.sanitizeFileName(e.title),attendees_count:(((f=e.attendees)==null?void 0:f.length)||0).toString()}}parseFolderTemplate(e,t){return Object.entries(t).reduce((r,[n,s])=>{let a=new RegExp(`\\{${n}\\}`,"g");return r.replace(a,s)},e)}sanitizeFileName(e){return e.replace(/[\\/:*?"<>|]/g,"-")}createAttendeeLinks(e,t){var s;let r=t?this.getCalendarNotesSettings(t):null;return((s=r==null?void 0:r.enableAttendeeLinks)!=null?s:this.settings.enableAttendeeLinks)?e.map(a=>`[[${a}]]`):e}getCalendarNotesSettings(e){var r;if(!e||!this.settings.calendarUrls)return{useCustomSettings:!1};let t=this.settings.calendarUrls.find(n=>n.name===e);return t?(r=t.notesSettings)!=null?r:{useCustomSettings:!1}:(console.warn(`Calendar source "${e}" not found in settings`),{useCustomSettings:!1})}},Re=Se;Re.FRONTMATTER_DELIMITER="---",Re.TEAMS_SEPARATOR="________________",Re.LOCATION_EMOJIS={URL:"\u{1F517}",VIRTUAL:"\u{1F4BB}",PHYSICAL:"\u{1F4CD}"};var re=require("obsidian");var it="memochron-calendar";var xi="/",Li="{{start_date}} - {{event_title}}",ki="ISO",Fi="24h",Yi=`---
type: event
date: {{start_date}}
---`,Pi=["event","meeting"];var st=hr(mr());var Ve=class{static parseSingleEvent(e){try{let t=(0,st.parse)(e),n=new st.Component(t).getAllSubcomponents("vevent");if(n.length===0)throw new Error("No events found in the ICS file");if(n.length>1)throw new Error("Multiple events found. Only single event ICS files are supported for drag and drop");let s=n[0],a=new st.Event(s),o=s.getFirstProperty("dtstart"),l=o?o.getParameter("tzid"):null,c=Ve.isAllDayEvent(s),d=we(a.startDate,l,c),h=we(a.endDate,l,c);return{id:a.uid||`imported-${Date.now()}`,title:a.summary||"Untitled Event",start:d,end:h,isAllDay:c,description:a.description,location:a.location,attendees:Ve.extractAttendees(s),source:"Imported",sourceId:"imported"}}catch(t){throw t instanceof Error?t:new Error("Failed to parse ICS file")}}static isAllDayEvent(e){let t=e.getFirstProperty("dtstart");if(!t)return!1;if(t.getParameter("value")==="DATE")return!0;let n=t.jCal;return!!(n&&n[2]==="date")}static extractAttendees(e){let t=[];if(!e.hasProperty("attendee"))return t;let r=e.getAllProperties("attendee");for(let n of r){let s=n.getFirstValue(),a=n.getParameter("cn");if(a)t.push(a);else if(s){let o=s.replace(/^mailto:/i,"");t.push(o)}}return t}};var ae=hr(Ki()),ur=class extends re.ItemView{constructor(t,r){super(t);this.plugin=r;this.selectedDate=null;this.currentMonthDays=new Map;this.isViewEventsRegistered=!1;this.dailyNotes=new Map;this.currentDate=new Date}getViewType(){return it}getDisplayText(){return"MemoChron calendar"}getIcon(){return"calendar-range"}async onOpen(){this.createUI(),this.registerViewEvents(),this.loadDailyNotes(),await this.refreshEvents(),this.plugin.settings.hideCalendar?(this.selectedDate=new Date,await this.showDayAgenda(this.selectedDate)):await this.goToToday()}async refreshEvents(t=!1){await this.plugin.calendarService.fetchCalendars(this.plugin.settings.calendarUrls,t),this.loadDailyNotes(),this.renderMonth(),this.updateCalendarVisibility();let r=this.selectedDate||new Date;this.showDayAgenda(r)}updateColors(){this.updateEventColors(),this.renderMonth();let t=this.selectedDate||new Date;this.showDayAgenda(t)}loadDailyNotes(){if(this.dailyNotes.clear(),!!(0,ae.appHasDailyNotesPluginLoaded)())try{let t=(0,ae.getAllDailyNotes)();Object.entries(t).forEach(([r,n])=>{this.dailyNotes.set(r,n)})}catch(t){console.error("Failed to load daily notes:",t)}}checkDailyNoteForDate(t){if(!(0,ae.appHasDailyNotesPluginLoaded)())return!1;try{let r=window.moment;if(!r)return!1;let n=r(t),s=(0,ae.getAllDailyNotes)();return(0,ae.getDailyNote)(n,s)!==null}catch(r){return console.error("Error checking daily note:",r),!1}}updateEventColors(){let t=this.plugin.calendarService.getAllEvents(),r=new Map(this.plugin.settings.calendarUrls.map(n=>[n.url,n]));t.forEach(n=>{let s=r.get(n.sourceId);s&&(n.color=this.plugin.settings.enableCalendarColors?s.color:void 0)})}createUI(){let t=this.containerEl.children[1];t.empty();let r=this.createControls(t);this.calendar=t.createEl("div",{cls:"memochron-calendar"}),this.agenda=t.createEl("div",{cls:"memochron-agenda"}),this.updateCalendarVisibility(),this.setupDragAndDrop()}createControls(t){let r=t.createEl("div",{cls:"memochron-controls"}),n=r.createEl("div",{cls:"memochron-nav"});n.createEl("span",{cls:"memochron-title"});let s=n.createEl("div",{cls:"memochron-nav-buttons"});return this.createNavButton(s,"<",()=>this.navigate(-1)),this.createNavButton(s,"Today",()=>this.goToToday()),this.createNavButton(s,">",()=>this.navigate(1)),r}createNavButton(t,r,n){let s=t.createEl("span",{text:r,cls:"memochron-nav-link"});s.onclick=n}registerViewEvents(){this.isViewEventsRegistered||(this.registerEvent(this.app.workspace.on("layout-change",()=>{this.leaf.view===this&&this.refreshEvents()})),this.isViewEventsRegistered=!0)}async navigate(t){this.currentDate.setMonth(this.currentDate.getMonth()+t),await this.refreshEvents()}async goToToday(){let t=new Date;this.isSameMonth(this.currentDate,t)||(this.currentDate=t,await this.refreshEvents()),this.selectDate(t)}isSameMonth(t,r){return t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear()}async selectDate(t){this.updateSelectedDateUI(t),this.selectedDate=t,await this.showDayAgenda(t)}updateSelectedDateUI(t){if(this.selectedDate){let n=this.currentMonthDays.get(this.selectedDate.toDateString());n==null||n.removeClass("selected")}let r=this.currentMonthDays.get(t.toDateString());r==null||r.addClass("selected")}renderMonth(){if(this.plugin.settings.hideCalendar)return;this.calendar.empty(),this.currentMonthDays.clear(),this.updateTitle();let t=this.createCalendarGrid();this.renderWeekdayHeaders(t),this.renderMonthDays(t)}updateTitle(){let t=this.containerEl.querySelector(".memochron-title");t&&(t.textContent=this.currentDate.toLocaleString("default",{month:"long",year:"numeric"}))}createCalendarGrid(){return this.calendar.createEl("div",{cls:"memochron-calendar-grid"})}renderWeekdayHeaders(t){this.getReorderedWeekdays().forEach(n=>{t.createEl("div",{cls:"memochron-weekday",text:n})})}getReorderedWeekdays(){let t=["Su","Mo","Tu","We","Th","Fr","Sa"],r=this.plugin.settings.firstDayOfWeek;return[...t.slice(r),...t.slice(0,r)]}renderMonthDays(t){let{year:r,month:n}=this.getYearMonth(),{firstDayOffset:s,daysInMonth:a}=this.getMonthInfo(r,n);this.renderEmptyDays(t,s),this.renderDays(t,r,n,a)}getYearMonth(){return{year:this.currentDate.getFullYear(),month:this.currentDate.getMonth()}}getMonthInfo(t,r){let n=new Date(t,r,1),s=new Date(t,r+1,0),a=n.getDay()-this.plugin.settings.firstDayOfWeek;return a<0&&(a+=7),{firstDayOffset:a,daysInMonth:s.getDate()}}renderEmptyDays(t,r){for(let n=0;n<r;n++)t.createEl("div",{cls:"memochron-day empty"})}renderDays(t,r,n,s){let a=new Date().toDateString();for(let o=1;o<=s;o++){let l=new Date(r,n,o);this.renderDay(t,l,a)}}renderDay(t,r,n){var o;let s=r.toDateString(),a=this.createDayElement(t,r,s===n);this.currentMonthDays.set(s,a),((o=this.selectedDate)==null?void 0:o.toDateString())===s&&a.addClass("selected"),this.addDayEventIndicator(a,r),this.addDayClickHandler(a,r)}createDayElement(t,r,n){let s=t.createEl("div",{cls:"memochron-day"});return n&&s.addClass("today"),s.createEl("div",{cls:"memochron-day-header",text:String(r.getDate())}),s}addDayEventIndicator(t,r){let n=this.plugin.calendarService.getEventsForDate(r),s=this.checkDailyNoteForDate(r);if(n.length>0||s)if(t.addClass("has-events"),this.plugin.settings.enableCalendarColors){let a=new Map;n.forEach(l=>{a.has(l.sourceId)||a.set(l.sourceId,l)});let o=t.createEl("div",{cls:"memochron-event-dots-container"});if(s){let l=o.createEl("div",{cls:"memochron-event-dot daily-note-dot colored",text:"\u2022"}),c=this.plugin.settings.dailyNoteColor||getComputedStyle(document.documentElement).getPropertyValue("--interactive-accent").trim()||"#7c3aed";l.style.color=c}a.forEach(l=>{let c=o.createEl("div",{cls:"memochron-event-dot colored",text:"\u2022"});l.color&&(c.style.color=l.color)})}else{let a=t.createEl("div",{cls:"memochron-event-dots-container"});s&&a.createEl("div",{cls:"memochron-event-dot daily-note-dot",text:"\u2022"}),n.length>0&&a.createEl("div",{cls:"memochron-event-dot",text:"\u2022"})}}addDayClickHandler(t,r){t.addEventListener("touchstart",()=>{},{passive:!1}),t.addEventListener("click",()=>this.selectDate(r))}async showDayAgenda(t){this.agenda.empty(),this.createAgendaHeader(t);let r=this.plugin.calendarService.getEventsForDate(t),n=r.length>0,s=this.plugin.settings.showDailyNoteInAgenda;if(!n&&!s){this.agenda.createEl("p",{text:"No events scheduled"});return}let a=this.agenda.createEl("div",{cls:"memochron-agenda-list"});if(s&&this.renderDailyNoteEntry(a,t),n){let o=new Date;r.forEach(l=>{this.renderEventItem(a,l,o)})}}createAgendaHeader(t){this.agenda.createEl("h3",{text:t.toLocaleDateString("default",{weekday:"long",month:"long",day:"numeric"})})}renderDailyNoteEntry(t,r){let n=t.createEl("div",{cls:"memochron-agenda-event memochron-daily-note"});if(this.plugin.settings.enableCalendarColors){n.addClass("with-color");let s=this.plugin.settings.dailyNoteColor||getComputedStyle(document.documentElement).getPropertyValue("--interactive-accent").trim()||"#7c3aed";n.style.setProperty("--event-color",s)}n.createEl("div",{cls:"memochron-event-title",text:"Daily Note"}),n.createEl("div",{cls:"memochron-event-location",text:"\u{1F4DD} Open daily note"}),n.addEventListener("click",async s=>{s.stopPropagation(),await this.handleDailyNoteClick(r)})}async handleDailyNoteClick(t){try{if(!(0,ae.appHasDailyNotesPluginLoaded)()){new re.Notice("Daily Notes core plugin is not enabled. Please enable it in Settings > Core plugins.");return}let r=window.moment;if(!r){new re.Notice("Moment.js is not available");return}let n=r(t),s=(0,ae.getAllDailyNotes)(),a=(0,ae.getDailyNote)(n,s);a||(a=await(0,ae.createDailyNote)(n)),a&&await this.app.workspace.getLeaf("tab").openFile(a)}catch(r){console.error("Failed to handle daily note:",r),new re.Notice("Failed to open daily note. Make sure Daily Notes plugin is enabled and configured.")}}renderEventItem(t,r,n){let s=t.createEl("div",{cls:"memochron-agenda-event"});r.end<n&&s.addClass("past-event"),this.plugin.settings.enableCalendarColors&&r.color&&(s.addClass("with-color"),s.style.setProperty("--event-color",r.color)),this.renderEventTime(s,r),this.renderEventTitle(s,r),this.renderEventLocation(s,r),this.addEventClickHandler(s,r)}renderEventTime(t,r){if(r.isAllDay)t.createEl("div",{cls:"memochron-event-time all-day",text:"All day"});else{let n={hour:"2-digit",minute:"2-digit",hour12:this.plugin.settings.noteTimeFormat==="12h"};t.createEl("div",{cls:"memochron-event-time",text:`${r.start.toLocaleTimeString([],n)} - ${r.end.toLocaleTimeString([],n)}`})}}renderEventTitle(t,r){t.createEl("div",{cls:"memochron-event-title",text:r.title})}renderEventLocation(t,r){if(!r.location)return;let n=this.getLocationIcon(r.location);t.createEl("div",{cls:"memochron-event-location",text:`${n} ${r.location}`})}getLocationIcon(t){return this.isUrl(t)?"\u{1F517}":this.isVirtualMeeting(t)?"\u{1F4BB}":"\u{1F4CD}"}isUrl(t){return/^(https?:\/\/|www\.)/.test(t)}isVirtualMeeting(t){let r=["zoom","meet.","teams","webex"],n=t.toLowerCase();return r.some(s=>n.includes(s))}addEventClickHandler(t,r){t.addEventListener("touchstart",()=>{},{passive:!1}),t.addEventListener("click",async n=>{n.stopPropagation();try{await this.showEventDetails(r)}catch(s){console.error("Failed to create note:",s),new re.Notice("Failed to create note. Check the console for details.")}})}async showEventDetails(t){if(!this.plugin.settings.noteLocation){new re.Notice("Please set a note location in settings first");return}let r=this.plugin.noteService.getExistingEventNote(t),n=!r;if(r)new re.Notice(`Opened existing note: ${r.basename}`);else{if(r=await this.plugin.noteService.createEventNote(t),!r)throw new Error("Failed to create note");new re.Notice(`Created new note: ${r.basename}`)}let s=this.app.workspace.getLeaf("tab");s?await s.openFile(r):new re.Notice("Could not open the note in a new tab")}toggleCalendarVisibility(){this.updateCalendarVisibility()}updateCalendarVisibility(){let t=this.containerEl.querySelector(".memochron-controls");this.plugin.settings.hideCalendar?(this.calendar.style.display="none",t&&(t.style.display="none"),this.agenda.classList.add("agenda-only")):(this.calendar.style.display="",t&&(t.style.display=""),this.agenda.classList.remove("agenda-only"))}setupDragAndDrop(){this.agenda&&(this.agenda.addEventListener("dragover",t=>{t.preventDefault(),t.stopPropagation(),this.agenda.addClass("drag-over")}),this.agenda.addEventListener("dragleave",t=>{t.preventDefault(),t.stopPropagation(),t.target===this.agenda&&this.agenda.removeClass("drag-over")}),this.agenda.addEventListener("drop",async t=>{var s;t.preventDefault(),t.stopPropagation(),this.agenda.removeClass("drag-over");let r=(s=t.dataTransfer)==null?void 0:s.files;if(!r||r.length===0)return;let n=r[0];if(!n.name.endsWith(".ics")){new re.Notice("Please drop an ICS calendar file");return}try{let a=await this.readFile(n),o=Ve.parseSingleEvent(a);await this.createNoteFromImportedEvent(o),new re.Notice(`Note created for: ${o.title}`)}catch(a){console.error("Failed to import ICS file:",a),new re.Notice(`Failed to import: ${a.message}`)}}))}readFile(t){return new Promise((r,n)=>{let s=new FileReader;s.onload=a=>{var o;r((o=a.target)==null?void 0:o.result)},s.onerror=()=>{n(new Error("Failed to read file"))},s.readAsText(t)})}async createNoteFromImportedEvent(t){await this.showEventDetails(t)}};var M=require("obsidian"),cr=class extends M.PluginSettingTab{constructor(t,r){super(t,r);this.plugin=r}display(){let{containerEl:t}=this;t.empty(),this.renderCalendarSection(),this.renderGeneralSection(),this.renderDailyNotesSection(),this.renderNotesSection()}renderCalendarSection(){this.createHeading("Calendar sources","Add and manage your iCalendar URLs"),new M.Setting(this.containerEl).addButton(r=>r.setButtonText("Add calendar").onClick(()=>this.addNewCalendar()));let t=this.containerEl.createEl("div",{cls:"memochron-calendar-list"});this.plugin.settings.calendarUrls.forEach((r,n)=>{this.renderCalendarSource(t,r,n)})}renderGeneralSection(){this.renderFirstDayOfWeek(),this.renderHideCalendar(),this.renderEnableCalendarColors(),this.renderRefreshInterval()}renderNotesSection(){new M.Setting(this.containerEl).setName("Notes").setHeading(),this.renderNoteLocation(),this.renderFolderPathTemplate(),this.renderNoteTitleFormat(),this.renderNoteDateFormat(),this.renderNoteTimeFormat(),this.renderDefaultFrontmatter(),this.renderNoteTemplate(),this.renderAttendeeSettings(),this.renderDefaultTags()}renderDailyNotesSection(){new M.Setting(this.containerEl).setName("Daily notes").setHeading(),this.renderShowDailyNoteInAgenda()}createHeading(t,r){new M.Setting(this.containerEl).setName(t).setDesc(r)}async addNewCalendar(){let t={url:"",name:"New calendar",enabled:!0,tags:[]};this.plugin.settings.enableCalendarColors&&(t.color=this.getNextAvailableColor()),this.plugin.settings.calendarUrls.push(t),await this.plugin.saveSettings(),this.display()}getNextAvailableColor(){return`hsl(${this.plugin.settings.calendarUrls.length*137.5%360}, 70%, 50%)`}renderCalendarSource(t,r,n){let s=new M.Setting(t).addText(a=>this.setupUrlInput(a,r,n)).addButton(a=>this.setupFilePickerButton(a,n)).addText(a=>this.setupNameInput(a,r,n)).addText(a=>this.setupTagsInput(a,r,n));if(this.plugin.settings.enableCalendarColors){let a=s.controlEl.createDiv({cls:"memochron-inline-color-picker"});this.renderInlineColorPicker(a,r,n)}s.addToggle(a=>this.setupEnabledToggle(a,r,n)).addButton(a=>this.setupRemoveButton(a,n)),this.renderCalendarNotesSettings(t,r,n)}setupUrlInput(t,r,n){return t.setPlaceholder("Calendar URL or file path").setValue(r.url).onChange(async s=>{this.plugin.settings.calendarUrls[n].url=s,await this.plugin.saveSettings()})}setupFilePickerButton(t,r){return t.setIcon("folder-open").setTooltip("Choose ICS file from vault").onClick(async()=>{let n=this.app.vault.getFiles().filter(a=>a.extension==="ics");if(n.length===0){new M.Notice("No ICS files found in vault");return}new fn(this.app,n,async a=>{this.plugin.settings.calendarUrls[r].url=a.path,await this.plugin.saveSettings(),this.display()}).open()})}setupNameInput(t,r,n){return t.setPlaceholder("Calendar name").setValue(r.name).onChange(async s=>{this.plugin.settings.calendarUrls[n].name=s,await this.plugin.saveSettings()})}setupTagsInput(t,r,n){var s;return t.setPlaceholder("Tags (comma-separated)").setValue(((s=r.tags)==null?void 0:s.join(", "))||"").onChange(async a=>{this.plugin.settings.calendarUrls[n].tags=this.parseTags(a),await this.plugin.saveSettings()})}setupEnabledToggle(t,r,n){return t.setValue(r.enabled).onChange(async s=>{this.plugin.settings.calendarUrls[n].enabled=s,await this.plugin.saveSettings(),await this.plugin.refreshCalendarView()})}setupRemoveButton(t,r){return t.setButtonText("Remove").onClick(async()=>{this.plugin.settings.calendarUrls.splice(r,1),await this.plugin.saveSettings(),await this.plugin.refreshCalendarView(),this.display()})}renderCalendarNotesSettings(t,r,n){var l;let s=t.createDiv({cls:"memochron-calendar-notes-settings"}),a=((l=r.notesSettings)==null?void 0:l.useCustomSettings)||!1,o=new M.Setting(s).setName("Notes settings").setDesc(a?"Custom notes settings enabled":"Use default notes settings").addButton(c=>{c.setButtonText(a?"Edit custom settings":"Configure custom settings").setIcon(a?"settings":"gear").onClick(()=>{new mn(this.app,this.plugin,r,n,()=>this.display()).open()})});if(a){let c=o.descEl.createSpan({cls:"memochron-custom-settings-indicator",text:" \u2699\uFE0F"})}}renderInlineColorPicker(t,r,n){let s=this.getObsidianBaseColors(),a=r.color||this.getNextAvailableColor();s.forEach(d=>{let h=t.createDiv({cls:"memochron-inline-color-swatch"}),f=d.cssVar&&getComputedStyle(document.documentElement).getPropertyValue(d.cssVar).trim()||d.fallback;h.style.backgroundColor=f,f===a&&h.classList.add("selected"),h.addEventListener("click",async()=>{this.plugin.settings.calendarUrls[n].color=f,await this.plugin.saveSettings(),this.plugin.updateCalendarColors(),t.empty(),this.renderInlineColorPicker(t,r,n)})});let o=t.createDiv({cls:"memochron-inline-color-custom-label"}),l=!s.some(d=>(d.cssVar&&getComputedStyle(document.documentElement).getPropertyValue(d.cssVar).trim()||d.fallback)===a);l?o.innerHTML=`<svg width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="${a}" stroke="#888" stroke-width="2"/></svg>`:o.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="#888" stroke-width="2"/><text x="12" y="17" text-anchor="middle" font-size="16" fill="#888">+</text></svg>',o.style.position="relative",o.style.display="inline-block",o.style.width="24px",o.style.height="24px";let c=document.createElement("input");c.type="color",c.value=this.colorToHex(a),c.className="memochron-inline-color-input",c.style.position="absolute",c.style.top="0",c.style.left="0",c.style.width="24px",c.style.height="24px",c.style.opacity="0",c.style.cursor="pointer",c.style.border="none",c.style.padding="0",c.style.margin="0",o.appendChild(c),c.addEventListener("change",async d=>{let h=d.target.value;this.plugin.settings.calendarUrls[n].color=h,await this.plugin.saveSettings(),this.plugin.updateCalendarColors(),t.empty(),this.renderInlineColorPicker(t,r,n)}),l&&o.classList.add("selected")}renderDailyNoteColorPicker(t){let r=this.getObsidianBaseColors(),n=this.plugin.settings.dailyNoteColor||getComputedStyle(document.documentElement).getPropertyValue("--interactive-accent").trim()||"#7c3aed";r.forEach(l=>{let c=t.createDiv({cls:"memochron-inline-color-swatch"}),d=l.cssVar&&getComputedStyle(document.documentElement).getPropertyValue(l.cssVar).trim()||l.fallback;c.style.backgroundColor=d,d===n&&c.classList.add("selected"),c.addEventListener("click",async()=>{this.plugin.settings.dailyNoteColor=d,await this.plugin.saveSettings(),this.plugin.updateCalendarColors(),t.empty(),this.renderDailyNoteColorPicker(t)})});let s=t.createDiv({cls:"memochron-inline-color-custom-label"}),a=!r.some(l=>(l.cssVar&&getComputedStyle(document.documentElement).getPropertyValue(l.cssVar).trim()||l.fallback)===n);a?s.innerHTML=`<svg width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="${n}" stroke="#888" stroke-width="2"/></svg>`:s.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="#888" stroke-width="2"/><text x="12" y="17" text-anchor="middle" font-size="16" fill="#888">+</text></svg>',s.style.position="relative",s.style.display="inline-block",s.style.width="24px",s.style.height="24px";let o=document.createElement("input");o.type="color",o.value=this.colorToHex(n),o.className="memochron-inline-color-input",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="24px",o.style.height="24px",o.style.opacity="0",o.style.cursor="pointer",o.style.border="none",o.style.padding="0",o.style.margin="0",s.appendChild(o),o.addEventListener("change",async l=>{let c=l.target.value;this.plugin.settings.dailyNoteColor=c,await this.plugin.saveSettings(),this.plugin.updateCalendarColors(),t.empty(),this.renderDailyNoteColorPicker(t)}),a&&s.classList.add("selected")}colorToHex(t){if(t.startsWith("#"))return t;let r=t.match(/hsl\((\d+),\s*(\d+)%?,\s*(\d+)%?\)/);if(r){let n=parseInt(r[1])/360,s=parseInt(r[2])/100,a=parseInt(r[3])/100,o,l,c;if(s===0)o=l=c=a;else{let d=(p,y,g)=>(g<0&&(g+=1),g>1&&(g-=1),g<.16666666666666666?p+(y-p)*6*g:g<.5?y:g<.6666666666666666?p+(y-p)*(.6666666666666666-g)*6:p),h=a<.5?a*(1+s):a+s-a*s,f=2*a-h;o=d(f,h,n+1/3),l=d(f,h,n),c=d(f,h,n-1/3)}return"#"+[o,l,c].map(d=>Math.round(d*255).toString(16).padStart(2,"0")).join("")}return"#888888"}getObsidianBaseColors(){return[{cssVar:"--interactive-accent",fallback:"#7c3aed"},{cssVar:null,fallback:"#e74c3c"},{cssVar:null,fallback:"#e67e22"},{cssVar:null,fallback:"#f1c40f"},{cssVar:null,fallback:"#2ecc71"},{cssVar:null,fallback:"#3498db"},{cssVar:null,fallback:"#9b59b6"},{cssVar:null,fallback:"#e91e63"},{cssVar:"--text-muted",fallback:"#999999"}]}renderFirstDayOfWeek(){let t=[{value:"0",label:"Sunday"},{value:"1",label:"Monday"},{value:"2",label:"Tuesday"},{value:"3",label:"Wednesday"},{value:"4",label:"Thursday"},{value:"5",label:"Friday"},{value:"6",label:"Saturday"}];new M.Setting(this.containerEl).setName("First day of the week").setDesc("Choose which day the week starts on").addDropdown(r=>{t.forEach(({value:n,label:s})=>{r.addOption(n,s)}),r.setValue(String(this.plugin.settings.firstDayOfWeek)).onChange(async n=>{this.plugin.settings.firstDayOfWeek=parseInt(n),await this.plugin.saveSettings(),await this.plugin.refreshCalendarView()})})}renderHideCalendar(){new M.Setting(this.containerEl).setName("Hide calendar").setDesc("Show only the agenda view without the month calendar grid").addToggle(t=>t.setValue(this.plugin.settings.hideCalendar).onChange(async r=>{this.plugin.settings.hideCalendar=r,await this.plugin.saveSettings(),await this.plugin.refreshCalendarView()}))}renderShowDailyNoteInAgenda(){let t=new M.Setting(this.containerEl).setName("Show daily note in agenda").setDesc("Display the daily note as an entry in the agenda view");if(this.plugin.settings.enableCalendarColors){let r=t.controlEl.createDiv({cls:"memochron-inline-color-picker"});this.renderDailyNoteColorPicker(r)}t.addToggle(r=>r.setValue(this.plugin.settings.showDailyNoteInAgenda).onChange(async n=>{this.plugin.settings.showDailyNoteInAgenda=n,await this.plugin.saveSettings(),await this.plugin.refreshCalendarView()}))}renderEnableCalendarColors(){new M.Setting(this.containerEl).setName("Enable calendar colors").setDesc("Show calendars in different colors for easy identification").addToggle(t=>t.setValue(this.plugin.settings.enableCalendarColors).onChange(async r=>{this.plugin.settings.enableCalendarColors=r,r&&(this.plugin.settings.calendarUrls.forEach((n,s)=>{if(!n.color){let a=s*137.5%360;n.color=`hsl(${a}, 70%, 50%)`}}),this.plugin.settings.dailyNoteColor||(this.plugin.settings.dailyNoteColor=getComputedStyle(document.documentElement).getPropertyValue("--interactive-accent").trim()||"#7c3aed")),await this.plugin.saveSettings(),this.plugin.updateCalendarColors(),this.display()}))}renderRefreshInterval(){new M.Setting(this.containerEl).setName("Refresh interval").setDesc("How often to refresh calendar data (in minutes)").addText(t=>t.setValue(String(this.plugin.settings.refreshInterval)).onChange(async r=>{let n=parseInt(r);!isNaN(n)&&n>0&&(this.plugin.settings.refreshInterval=n,await this.plugin.saveSettings())}))}renderNoteLocation(){let t=new M.Setting(this.containerEl).setName("Note location").setDesc("Where to save new event notes");t.settingEl.addClass("memochron-setting-item-container");let r=new M.TextComponent(t.controlEl);r.setPlaceholder("calendar-notes/").setValue(this.plugin.settings.noteLocation);let n=t.controlEl.createDiv({cls:"memochron-suggestion-container"});n.classList.remove("is-visible"),this.setupPathSuggestions(r,n,async()=>await this.plugin.noteService.getAllFolders(),async s=>{this.plugin.settings.noteLocation=s,await this.plugin.saveSettings()})}renderNoteTitleFormat(){new M.Setting(this.containerEl).setName("Note title format").setDesc("Format for new note titles. Available variables: {{event_title}}, {{date}}, {{start_date}}, {{end_date}}, {{start_time}}, {{end_time}}, {{source}}, {{location}}, {{description}}").addText(t=>t.setPlaceholder("{{event_title}} - {{start_date}}").setValue(this.plugin.settings.noteTitleFormat).onChange(async r=>{this.plugin.settings.noteTitleFormat=r,await this.plugin.saveSettings()}))}renderNoteDateFormat(){let t=[{value:"ISO",label:"ISO (YYYY-MM-DD)"},{value:"US",label:"US (MM/DD/YYYY)"},{value:"UK",label:"UK (DD/MM/YYYY)"},{value:"Long",label:"Long (Month DD, YYYY)"}];new M.Setting(this.containerEl).setName("Note date format").setDesc("Choose how dates appear in event notes").addDropdown(r=>{t.forEach(({value:n,label:s})=>{r.addOption(n,s)}),r.setValue(this.plugin.settings.noteDateFormat).onChange(async n=>{this.plugin.settings.noteDateFormat=n,await this.plugin.saveSettings()})})}renderNoteTimeFormat(){let t=[{value:"24h",label:"24-hour (13:30)"},{value:"12h",label:"12-hour (1:30 PM)"}];new M.Setting(this.containerEl).setName("Note time format").setDesc("Choose how times appear in event notes and calendar view").addDropdown(r=>{t.forEach(({value:n,label:s})=>{r.addOption(n,s)}),r.setValue(this.plugin.settings.noteTimeFormat).onChange(async n=>{var s;this.plugin.settings.noteTimeFormat=n,await this.plugin.saveSettings(),(s=this.plugin.calendarView)==null||s.refreshEvents()})})}renderDefaultFrontmatter(){new M.Setting(this.containerEl).setName("Default frontmatter").setDesc("YAML frontmatter to add at the top of each event note").addTextArea(t=>{t.setPlaceholder(`---
type: event
date: {{start_date}}
---`).setValue(this.plugin.settings.defaultFrontmatter).onChange(async r=>{this.plugin.settings.defaultFrontmatter=r,await this.plugin.saveSettings()}),t.inputEl.rows=4,t.inputEl.cols=50})}renderNoteTemplate(){new M.Setting(this.containerEl).setName("Note template").setDesc("Template for the note content. Available variables: {{event_title}}, {{date}}, {{start_date}}, {{end_date}}, {{start_time}}, {{end_time}}, {{source}}, {{location}}, {{description}}, {{attendees}}, {{attendees_list}}, {{attendees_links}}, {{attendees_links_list}}, {{attendees_count}}").addTextArea(t=>{t.setValue(this.plugin.settings.noteTemplate).onChange(async r=>{this.plugin.settings.noteTemplate=r,await this.plugin.saveSettings()}),t.inputEl.rows=10,t.inputEl.cols=50})}renderAttendeeSettings(){new M.Setting(this.containerEl).setName("Create links for attendees").setDesc("Automatically create wiki links [[Name]] for event attendees. Obsidian will find the notes regardless of their folder location.").addToggle(t=>t.setValue(this.plugin.settings.enableAttendeeLinks).onChange(async r=>{this.plugin.settings.enableAttendeeLinks=r,await this.plugin.saveSettings()}))}renderFolderPathTemplate(){let t=new M.Setting(this.containerEl).setName("Folder path template").setDesc("Organize notes in date-based subfolders. Leave empty to save all notes in the same folder.");t.descEl.createEl("br"),t.descEl.createEl("small",{text:"Available variables: {YYYY}, {YY}, {MM}, {M}, {MMM}, {MMMM}, {DD}, {D}, {DDD}, {DDDD}, {Q}, {source}, {event_title}"}),t.descEl.createEl("br"),t.descEl.createEl("small",{text:"Examples: {YYYY}/{MM}, {YYYY}-{MMM}, {source}/{YYYY}/{MMM}"}),t.addText(s=>s.setPlaceholder("{YYYY}/{MMM}").setValue(this.plugin.settings.folderPathTemplate).onChange(async a=>{this.plugin.settings.folderPathTemplate=a,await this.plugin.saveSettings()}));let r=t.controlEl.createDiv({cls:"memochron-template-preview"});this.updateTemplatePreview(r,this.plugin.settings.folderPathTemplate);let n=t.controlEl.querySelector("input");n&&n.addEventListener("input",()=>{this.updateTemplatePreview(r,n.value)})}updateTemplatePreview(t,r){if(t.empty(),!r.trim()){t.createEl("small",{text:"Preview: Notes will be saved directly in the note location folder",cls:"memochron-preview-text"});return}let n=new Date,s={title:"Sample Meeting",start:n,end:n,source:"Work Calendar"};try{let a=this.generatePreviewPath(r,s);t.createEl("small",{text:`Preview: ${a}/`,cls:"memochron-preview-text"})}catch(a){t.createEl("small",{text:"Invalid template format",cls:"memochron-preview-error"})}}generatePreviewPath(t,r){let n=["January","February","March","April","May","June","July","August","September","October","November","December"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=r.start,c=l.getFullYear(),d=l.getMonth(),h=l.getDate(),f=l.getDay(),p=Math.floor(d/3)+1,y={YYYY:c.toString(),YY:c.toString().slice(-2),MM:(d+1).toString().padStart(2,"0"),M:(d+1).toString(),MMM:s[d],MMMM:n[d],DD:h.toString().padStart(2,"0"),D:h.toString(),DDD:o[f],DDDD:a[f],Q:p.toString(),source:r.source.replace(/[\\/:*?"<>|]/g,"-"),event_title:r.title.replace(/[\\/:*?"<>|]/g,"-")};return Object.entries(y).reduce((g,[T,v])=>{let D=new RegExp(`\\{${T}\\}`,"g");return g.replace(D,v)},t)}renderDefaultTags(){new M.Setting(this.containerEl).setName("Default tags").setDesc("Default tags for all event notes (comma-separated)").addText(t=>t.setPlaceholder("event, meeting").setValue(this.plugin.settings.defaultTags.join(", ")).onChange(async r=>{this.plugin.settings.defaultTags=this.parseTags(r),await this.plugin.saveSettings()}))}parseTags(t){return t.split(",").map(r=>r.trim()).filter(r=>r.length>0)}setupPathSuggestions(t,r,n,s){let a=async()=>{let o=await n();this.displaySuggestions(t,r,o,t.getValue(),s)};t.inputEl.addEventListener("focus",a),t.inputEl.addEventListener("input",a),t.inputEl.addEventListener("blur",()=>{setTimeout(()=>{r&&r.parentNode&&r.classList.remove("is-visible")},200)})}displaySuggestions(t,r,n,s,a){r.empty();let o=n.filter(c=>c.toLowerCase().includes(s.toLowerCase()));if(o.length===0){r.classList.remove("is-visible");return}r.classList.add("is-visible");let l=r.createEl("ul",{cls:"memochron-suggestion-list"});o.slice(0,5).forEach(c=>{l.createEl("li",{text:c}).addEventListener("mousedown",async h=>{h.preventDefault(),t.setValue(c),await a(c),r.classList.remove("is-visible")})})}},fn=class extends M.SuggestModal{constructor(t,r,n){super(t);this.files=r;this.onChoose=n}getSuggestions(t){return this.files.filter(r=>r.path.toLowerCase().includes(t.toLowerCase()))}renderSuggestion(t,r){r.createEl("div",{text:t.path}),r.createEl("small",{text:`Modified: ${new Date(t.stat.mtime).toLocaleDateString()}`,cls:"memochron-file-picker-date"})}onChooseSuggestion(t){this.onChoose(t)}},mn=class extends M.Modal{constructor(t,r,n,s,a){super(t);this.eventListeners=[];this.plugin=r,this.source=n,this.index=s,this.onSettingsChange=a}onOpen(){let{contentEl:t}=this;t.empty(),this.refreshCustomSettingsIfNeeded(),t.createEl("h2",{text:`Notes Settings for "${this.source.name}"`}),new M.Setting(t).setName("Use custom notes settings").setDesc("Override default notes settings for this calendar").addToggle(n=>{let s=this.source.notesSettings||{useCustomSettings:!1};n.setValue(s.useCustomSettings).onChange(async a=>{this.source.notesSettings?this.source.notesSettings.useCustomSettings=a:this.source.notesSettings={useCustomSettings:a},a&&this.copyDefaultSettingsToCustom(),await this.plugin.saveSettings(),this.onOpen(),this.onSettingsChange&&this.onSettingsChange()})}),(this.source.notesSettings||{useCustomSettings:!1}).useCustomSettings&&this.renderCustomSettings(t)}renderCustomSettings(t){let r=this.source.notesSettings;if(!r){console.error("Custom settings not found when rendering custom settings");return}let n=new M.Setting(t).setName("Note location").setDesc("Where to save notes for this calendar (leave empty to use default)");n.settingEl.addClass("memochron-setting-item-container");let s=new M.TextComponent(n.controlEl);s.setPlaceholder(this.plugin.settings.noteLocation).setValue(r.noteLocation||"");let a=n.controlEl.createDiv({cls:"memochron-suggestion-container"});a.classList.remove("is-visible"),this.setupPathSuggestions(s,a,async()=>await this.plugin.noteService.getAllFolders(),async l=>{r.noteLocation=l||void 0,await this.plugin.saveSettings()}),new M.Setting(t).setName("Note title format").setDesc("Title format for this calendar (leave empty to use default)").addText(l=>l.setPlaceholder(this.plugin.settings.noteTitleFormat).setValue(r.noteTitleFormat||"").onChange(async c=>{r.noteTitleFormat=c||void 0,await this.plugin.saveSettings()}));let o=[{value:"ISO",label:"ISO (YYYY-MM-DD)"},{value:"US",label:"US (MM/DD/YYYY)"},{value:"UK",label:"UK (DD/MM/YYYY)"},{value:"Long",label:"Long (Month DD, YYYY)"}];new M.Setting(t).setName("Note date format").setDesc("Date format for this calendar").addDropdown(l=>{l.addOption("",`Default (${this.plugin.settings.noteDateFormat})`),o.forEach(({value:c,label:d})=>{l.addOption(c,d)}),l.setValue(r.noteDateFormat||"").onChange(async c=>{r.noteDateFormat=c||void 0,await this.plugin.saveSettings()})}),new M.Setting(t).setName("Note time format").setDesc("Time format for this calendar").addDropdown(l=>{l.addOption("",`Default (${this.plugin.settings.noteTimeFormat})`),l.addOption("12h","12-hour (1:30 PM)"),l.addOption("24h","24-hour (13:30)"),l.setValue(r.noteTimeFormat||"").onChange(async c=>{r.noteTimeFormat=c||void 0,await this.plugin.saveSettings()})}),new M.Setting(t).setName("Default frontmatter").setDesc("YAML frontmatter for this calendar (leave empty to use default)").addTextArea(l=>{l.setPlaceholder(this.plugin.settings.defaultFrontmatter).setValue(r.defaultFrontmatter||"").onChange(async c=>{r.defaultFrontmatter=c||void 0,await this.plugin.saveSettings()}),l.inputEl.rows=4,l.inputEl.cols=50}),new M.Setting(t).setName("Default tags").setDesc("Default tags for this calendar (leave empty to use default)").addText(l=>l.setPlaceholder(this.plugin.settings.defaultTags.join(", ")).setValue((r.defaultTags||[]).join(", ")).onChange(async c=>{r.defaultTags=c?this.parseTags(c):void 0,await this.plugin.saveSettings()})),new M.Setting(t).setName("Note template").setDesc("Template for this calendar (leave empty to use default)").addTextArea(l=>{l.setPlaceholder(this.plugin.settings.noteTemplate).setValue(r.noteTemplate||"").onChange(async c=>{r.noteTemplate=c||void 0,await this.plugin.saveSettings()}),l.inputEl.rows=10,l.inputEl.cols=50}),new M.Setting(t).setName("Folder path template").setDesc("Folder organization for this calendar (leave empty to use default)").addText(l=>l.setPlaceholder(this.plugin.settings.folderPathTemplate||"No template").setValue(r.folderPathTemplate||"").onChange(async c=>{r.folderPathTemplate=c||void 0,await this.plugin.saveSettings()})),new M.Setting(t).setName("Create links for attendees").setDesc("Create wiki links for attendees in this calendar").addToggle(l=>{var d;let c=this.plugin.settings.enableAttendeeLinks;l.setValue((d=r.enableAttendeeLinks)!=null?d:c).onChange(async h=>{r.enableAttendeeLinks=h,await this.plugin.saveSettings()})})}parseTags(t){return t.split(",").map(r=>r.trim()).filter(r=>r.length>0)}copyDefaultSettingsToCustom(){this.source.notesSettings||(this.source.notesSettings={useCustomSettings:!0}),this.source.notesSettings.noteLocation=this.plugin.settings.noteLocation,this.source.notesSettings.noteTitleFormat=this.plugin.settings.noteTitleFormat,this.source.notesSettings.noteDateFormat=this.plugin.settings.noteDateFormat,this.source.notesSettings.noteTimeFormat=this.plugin.settings.noteTimeFormat,this.source.notesSettings.defaultFrontmatter=this.plugin.settings.defaultFrontmatter,this.source.notesSettings.defaultTags=[...this.plugin.settings.defaultTags||[]],this.source.notesSettings.noteTemplate=this.plugin.settings.noteTemplate,this.source.notesSettings.folderPathTemplate=this.plugin.settings.folderPathTemplate,this.source.notesSettings.enableAttendeeLinks=this.plugin.settings.enableAttendeeLinks}refreshCustomSettingsIfNeeded(){var r;if(!((r=this.source.notesSettings)!=null&&r.useCustomSettings))return;(!this.source.notesSettings.noteLocation||!this.source.notesSettings.noteTitleFormat||!this.source.notesSettings.noteDateFormat||!this.source.notesSettings.noteTimeFormat||!this.source.notesSettings.defaultFrontmatter||!this.source.notesSettings.defaultTags||!this.source.notesSettings.noteTemplate||this.source.notesSettings.folderPathTemplate===void 0||this.source.notesSettings.enableAttendeeLinks===void 0)&&(console.log("Refreshing custom settings with current defaults"),this.copyDefaultSettingsToCustom())}setupPathSuggestions(t,r,n,s){let a=async()=>{let o=await n();this.displaySuggestions(t,r,o,t.getValue(),s)};t.inputEl.addEventListener("focus",a),t.inputEl.addEventListener("input",a),t.inputEl.addEventListener("blur",()=>{setTimeout(()=>{r&&r.parentNode&&r.classList.remove("is-visible")},200)})}displaySuggestions(t,r,n,s,a){r.empty();let o=n.filter(c=>c.toLowerCase().includes(s.toLowerCase()));if(o.length===0){r.classList.remove("is-visible");return}r.classList.add("is-visible");let l=r.createEl("ul",{cls:"memochron-suggestion-list"});o.slice(0,5).forEach(c=>{l.createEl("li",{text:c}).addEventListener("mousedown",async h=>{h.preventDefault(),t.setValue(c),await a(c),r.classList.remove("is-visible")})})}onClose(){let{contentEl:t}=this;this.cleanupEventListeners(),t.empty()}addEventListener(t,r,n){t.addEventListener(r,n),this.eventListeners.push({element:t,event:r,handler:n})}cleanupEventListeners(){this.eventListeners.forEach(({element:t,event:r,handler:n})=>{t.removeEventListener(r,n)}),this.eventListeners=[]}};var Qi={calendarUrls:[],noteLocation:xi,noteTitleFormat:Li,refreshInterval:30,noteDateFormat:ki,noteTimeFormat:Fi,defaultFrontmatter:Yi,defaultTags:Pi,noteTemplate:`# {{event_title}}

## \u{1F4DD} Event Details
\u{1F4C5} {{start_date}}
\u23F0 {{start_time}} - {{end_time}}
\u{1F4C6} {{source}}
{{location}}

## \u{1F4CB} Description
{{description}}

## \u{1F4DD} Notes
`,firstDayOfWeek:1,hideCalendar:!1,folderPathTemplate:"",enableCalendarColors:!1,showDailyNoteInAgenda:!1,enableAttendeeLinks:!1};var dr=class extends Xi.Plugin{constructor(){super(...arguments);this.refreshTimer=null}async onload(){await this.loadSettings(),this.initializeServices(),this.registerViews(),this.registerCommands(),this.addSettingTab(new cr(this.app,this)),this.app.workspace.onLayoutReady(()=>{this.activateView()}),this.setupAutoRefresh()}initializeServices(){this.calendarService=new lr(this,this.settings.refreshInterval),this.noteService=new Re(this.app,this.settings)}registerViews(){this.registerView(it,t=>this.calendarView=new ur(t,this))}registerCommands(){this.addCommand({id:"force-refresh-calendars",name:"Force refresh calendars",callback:()=>this.refreshCalendarView(!0)}),this.addCommand({id:"go-to-today",name:"Go to today",callback:()=>this.goToToday()}),this.addCommand({id:"toggle-calendar",name:"Toggle calendar visibility",callback:()=>this.toggleCalendar()})}onunload(){this.clearRefreshTimer()}async loadSettings(){this.settings=Object.assign({},Qi,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.calendarService&&this.setupAutoRefresh(),await this.refreshCalendarView()}async activateView(){this.app.workspace.getLeavesOfType(it).length===0&&await this.createCalendarView(),await this.refreshCalendarView()}async createCalendarView(){let t=this.getOrCreateLeaf();t&&await t.setViewState({type:it,active:!0})}getOrCreateLeaf(){return this.app.workspace.getRightLeaf(!1)||this.app.workspace.getLeaf("split","vertical")}async refreshCalendarView(t=!1){this.calendarView&&await this.calendarView.refreshEvents(t)}updateCalendarColors(){this.calendarView&&this.calendarView.updateColors()}async goToToday(){this.calendarView&&await this.calendarView.goToToday()}async toggleCalendar(){this.settings.hideCalendar=!this.settings.hideCalendar,await this.saveSettings(),this.calendarView&&this.calendarView.toggleCalendarVisibility()}setupAutoRefresh(){this.clearRefreshTimer();let t=this.settings.refreshInterval*60*1e3;this.refreshTimer=window.setInterval(()=>this.refreshCalendarView(),t)}clearRefreshTimer(){this.refreshTimer!==null&&(window.clearInterval(this.refreshTimer),this.refreshTimer=null)}};

/* nosourcemap */